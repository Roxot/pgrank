2017-06-30 08:50:33
Finding best parameters for k = 9
=========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.079916    	average train batch reward = 0.519
validation accuracy = 0.046		average validation NDCG = 0.643

epoch 2
average train loss = 0.112519    	average train batch reward = 0.519
validation accuracy = 0.046		average validation NDCG = 0.644

epoch 3
average train loss = 0.125170    	average train batch reward = 0.519
validation accuracy = 0.046		average validation NDCG = 0.644

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.0), (), ()], which got scores of [0.64368945565687663, -1, -1]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.153059    	average train batch reward = 0.517
validation accuracy = 0.047		average validation NDCG = 0.652

epoch 2
average train loss = 0.068181    	average train batch reward = 0.518
validation accuracy = 0.047		average validation NDCG = 0.653

epoch 3
average train loss = 0.057740    	average train batch reward = 0.517
validation accuracy = 0.048		average validation NDCG = 0.653

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 50, 0.0), ()], which got scores of [0.65289409323596159, 0.64368945565687663, -1]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.007633    	average train batch reward = 0.531
validation accuracy = 0.078		average validation NDCG = 0.654

epoch 2
average train loss = 0.095900    	average train batch reward = 0.531
validation accuracy = 0.079		average validation NDCG = 0.654

epoch 3
average train loss = -0.033100    	average train batch reward = 0.532
validation accuracy = 0.079		average validation NDCG = 0.655

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.2), (9.9999999999999995e-08, 50, 0.05), ()], which got scores of [0.65460580449779893, 0.65289409323596159, -1]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.029415    	average train batch reward = 0.552
validation accuracy = 0.126		average validation NDCG = 0.676

epoch 2
average train loss = -0.039167    	average train batch reward = 0.553
validation accuracy = 0.127		average validation NDCG = 0.676

epoch 3
average train loss = -0.131792    	average train batch reward = 0.552
validation accuracy = 0.127		average validation NDCG = 0.677

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.5), (9.9999999999999995e-08, 50, 0.2), ()], which got scores of [0.67655137021371348, 0.65460580449779893, -1]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.027049    	average train batch reward = 0.544
validation accuracy = 0.088		average validation NDCG = 0.666

epoch 2
average train loss = 0.066836    	average train batch reward = 0.545
validation accuracy = 0.088		average validation NDCG = 0.666

epoch 3
average train loss = -0.048843    	average train batch reward = 0.546
validation accuracy = 0.088		average validation NDCG = 0.666

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.5), (9.9999999999999995e-08, 50, 1.0), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.67655137021371348, 0.66611630280571998, 0.65460580449779893]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.059882    	average train batch reward = 0.574
validation accuracy = 0.100		average validation NDCG = 0.690

epoch 2
average train loss = -0.077931    	average train batch reward = 0.575
validation accuracy = 0.100		average validation NDCG = 0.691

epoch 3
average train loss = -0.070938    	average train batch reward = 0.576
validation accuracy = 0.101		average validation NDCG = 0.691

========
Currently the best setups are [(9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 50, 0.5), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.69092304766068247, 0.67655137021371348, 0.65460580449779893]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.207543    	average train batch reward = 0.550
validation accuracy = 0.101		average validation NDCG = 0.671

epoch 2
average train loss = -0.110280    	average train batch reward = 0.552
validation accuracy = 0.101		average validation NDCG = 0.671

epoch 3
average train loss = -0.107937    	average train batch reward = 0.553
validation accuracy = 0.101		average validation NDCG = 0.671

========
Currently the best setups are [(9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 50, 0.5), (9.9999999999999995e-08, 512, 0.0)], which got scores of [0.69092304766068247, 0.67655137021371348, 0.67149230914066405]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.027375    	average train batch reward = 0.527
validation accuracy = 0.066		average validation NDCG = 0.657

epoch 2
average train loss = 0.014070    	average train batch reward = 0.529
validation accuracy = 0.066		average validation NDCG = 0.657

epoch 3
average train loss = 0.063973    	average train batch reward = 0.529
validation accuracy = 0.066		average validation NDCG = 0.657

========
Currently the best setups are [(9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 50, 0.5), (9.9999999999999995e-08, 512, 0.0)], which got scores of [0.69092304766068247, 0.67655137021371348, 0.67149230914066405]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.133221    	average train batch reward = 0.551
validation accuracy = 0.108		average validation NDCG = 0.675

epoch 2
average train loss = -0.107003    	average train batch reward = 0.553
validation accuracy = 0.108		average validation NDCG = 0.675

epoch 3
average train loss = 0.038089    	average train batch reward = 0.553
validation accuracy = 0.108		average validation NDCG = 0.675

========
Currently the best setups are [(9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 50, 0.5), (9.9999999999999995e-08, 512, 0.2)], which got scores of [0.69092304766068247, 0.67655137021371348, 0.67500675047648939]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.060698    	average train batch reward = 0.532
validation accuracy = 0.070		average validation NDCG = 0.657

epoch 2
average train loss = 0.138206    	average train batch reward = 0.533
validation accuracy = 0.070		average validation NDCG = 0.657

epoch 3
average train loss = 0.007004    	average train batch reward = 0.535
validation accuracy = 0.070		average validation NDCG = 0.657

========
Currently the best setups are [(9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 50, 0.5), (9.9999999999999995e-08, 512, 0.2)], which got scores of [0.69092304766068247, 0.67655137021371348, 0.67500675047648939]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.129083    	average train batch reward = 0.556
validation accuracy = 0.128		average validation NDCG = 0.683

epoch 2
average train loss = -0.036541    	average train batch reward = 0.555
validation accuracy = 0.128		average validation NDCG = 0.683

epoch 3
average train loss = -0.049240    	average train batch reward = 0.556
validation accuracy = 0.128		average validation NDCG = 0.683

========
Currently the best setups are [(9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 512, 1.0), (9.9999999999999995e-08, 50, 0.5)], which got scores of [0.69092304766068247, 0.6827139860143463, 0.67655137021371348]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.009516    	average train batch reward = 0.543
validation accuracy = 0.101		average validation NDCG = 0.667

epoch 2
average train loss = 0.105631    	average train batch reward = 0.541
validation accuracy = 0.101		average validation NDCG = 0.667

epoch 3
average train loss = 0.068719    	average train batch reward = 0.544
validation accuracy = 0.102		average validation NDCG = 0.667

========
Currently the best setups are [(9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 512, 1.0), (9.9999999999999995e-08, 50, 0.5)], which got scores of [0.69092304766068247, 0.6827139860143463, 0.67655137021371348]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.011131    	average train batch reward = 0.591
validation accuracy = 0.140		average validation NDCG = 0.700

epoch 2
average train loss = -0.045313    	average train batch reward = 0.595
validation accuracy = 0.140		average validation NDCG = 0.700

epoch 3
average train loss = 0.027712    	average train batch reward = 0.593
validation accuracy = 0.140		average validation NDCG = 0.700

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 50, 0.5)], which got scores of [0.7003346767324784, 0.69092304766068247, 0.67655137021371348]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.011222    	average train batch reward = 0.525
validation accuracy = 0.081		average validation NDCG = 0.653

epoch 2
average train loss = 0.046059    	average train batch reward = 0.526
validation accuracy = 0.081		average validation NDCG = 0.653

epoch 3
average train loss = -0.031982    	average train batch reward = 0.527
validation accuracy = 0.081		average validation NDCG = 0.653

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 50, 0.5)], which got scores of [0.7003346767324784, 0.69092304766068247, 0.67655137021371348]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.089001    	average train batch reward = 0.554
validation accuracy = 0.115		average validation NDCG = 0.666

epoch 2
average train loss = -0.017918    	average train batch reward = 0.553
validation accuracy = 0.115		average validation NDCG = 0.666

epoch 3
average train loss = -0.114757    	average train batch reward = 0.552
validation accuracy = 0.115		average validation NDCG = 0.666

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 50, 0.5)], which got scores of [0.7003346767324784, 0.69092304766068247, 0.67655137021371348]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.017414    	average train batch reward = 0.549
validation accuracy = 0.104		average validation NDCG = 0.669

epoch 2
average train loss = -0.122611    	average train batch reward = 0.549
validation accuracy = 0.104		average validation NDCG = 0.669

epoch 3
average train loss = -0.025890    	average train batch reward = 0.550
validation accuracy = 0.104		average validation NDCG = 0.669

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 50, 0.5)], which got scores of [0.7003346767324784, 0.69092304766068247, 0.67655137021371348]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.020109    	average train batch reward = 0.561
validation accuracy = 0.112		average validation NDCG = 0.678

epoch 2
average train loss = -0.054468    	average train batch reward = 0.562
validation accuracy = 0.112		average validation NDCG = 0.678

epoch 3
average train loss = 0.036462    	average train batch reward = 0.562
validation accuracy = 0.112		average validation NDCG = 0.678

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 5012, 1.0)], which got scores of [0.7003346767324784, 0.69092304766068247, 0.67780363482116113]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.061433    	average train batch reward = 0.558
validation accuracy = 0.111		average validation NDCG = 0.675

epoch 2
average train loss = 0.029450    	average train batch reward = 0.556
validation accuracy = 0.111		average validation NDCG = 0.675

epoch 3
average train loss = 0.066029    	average train batch reward = 0.558
validation accuracy = 0.111		average validation NDCG = 0.675

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 5012, 1.0)], which got scores of [0.7003346767324784, 0.69092304766068247, 0.67780363482116113]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.031939    	average train batch reward = 0.536
validation accuracy = 0.101		average validation NDCG = 0.660

epoch 2
average train loss = 0.009710    	average train batch reward = 0.538
validation accuracy = 0.108		average validation NDCG = 0.662

epoch 3
average train loss = 0.003676    	average train batch reward = 0.544
validation accuracy = 0.114		average validation NDCG = 0.664

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 5012, 1.0)], which got scores of [0.7003346767324784, 0.69092304766068247, 0.67780363482116113]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.000220    	average train batch reward = 0.518
validation accuracy = 0.096		average validation NDCG = 0.650

epoch 2
average train loss = 0.038876    	average train batch reward = 0.522
validation accuracy = 0.099		average validation NDCG = 0.652

epoch 3
average train loss = -0.052968    	average train batch reward = 0.524
validation accuracy = 0.101		average validation NDCG = 0.654

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 5012, 1.0)], which got scores of [0.7003346767324784, 0.69092304766068247, 0.67780363482116113]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.104474    	average train batch reward = 0.548
validation accuracy = 0.099		average validation NDCG = 0.682

epoch 2
average train loss = -0.001837    	average train batch reward = 0.551
validation accuracy = 0.103		average validation NDCG = 0.684

epoch 3
average train loss = -0.060735    	average train batch reward = 0.555
validation accuracy = 0.111		average validation NDCG = 0.687

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-07, 50, 0.2)], which got scores of [0.7003346767324784, 0.69092304766068247, 0.68715980860393899]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.106990    	average train batch reward = 0.542
validation accuracy = 0.061		average validation NDCG = 0.673

epoch 2
average train loss = 0.125468    	average train batch reward = 0.546
validation accuracy = 0.064		average validation NDCG = 0.676

epoch 3
average train loss = -0.111837    	average train batch reward = 0.548
validation accuracy = 0.070		average validation NDCG = 0.679

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-07, 50, 0.2)], which got scores of [0.7003346767324784, 0.69092304766068247, 0.68715980860393899]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.049387    	average train batch reward = 0.537
validation accuracy = 0.089		average validation NDCG = 0.661

epoch 2
average train loss = -0.003992    	average train batch reward = 0.541
validation accuracy = 0.092		average validation NDCG = 0.663

epoch 3
average train loss = -0.021016    	average train batch reward = 0.540
validation accuracy = 0.095		average validation NDCG = 0.665

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-07, 50, 0.2)], which got scores of [0.7003346767324784, 0.69092304766068247, 0.68715980860393899]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.066908    	average train batch reward = 0.577
validation accuracy = 0.116		average validation NDCG = 0.689

epoch 2
average train loss = -0.005403    	average train batch reward = 0.583
validation accuracy = 0.124		average validation NDCG = 0.692

epoch 3
average train loss = -0.088421    	average train batch reward = 0.588
validation accuracy = 0.133		average validation NDCG = 0.696

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-08, 50, 1.5)], which got scores of [0.7003346767324784, 0.69622999934570839, 0.69092304766068247]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.033648    	average train batch reward = 0.525
validation accuracy = 0.078		average validation NDCG = 0.654

epoch 2
average train loss = 0.034970    	average train batch reward = 0.527
validation accuracy = 0.078		average validation NDCG = 0.655

epoch 3
average train loss = 0.100121    	average train batch reward = 0.527
validation accuracy = 0.079		average validation NDCG = 0.656

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-08, 50, 1.5)], which got scores of [0.7003346767324784, 0.69622999934570839, 0.69092304766068247]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.010078    	average train batch reward = 0.528
validation accuracy = 0.098		average validation NDCG = 0.658

epoch 2
average train loss = 0.140336    	average train batch reward = 0.530
validation accuracy = 0.098		average validation NDCG = 0.658

epoch 3
average train loss = 0.081735    	average train batch reward = 0.532
validation accuracy = 0.099		average validation NDCG = 0.659

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-08, 50, 1.5)], which got scores of [0.7003346767324784, 0.69622999934570839, 0.69092304766068247]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.044677    	average train batch reward = 0.534
validation accuracy = 0.136		average validation NDCG = 0.663

epoch 2
average train loss = 0.089093    	average train batch reward = 0.535
validation accuracy = 0.136		average validation NDCG = 0.664

epoch 3
average train loss = -0.036558    	average train batch reward = 0.535
validation accuracy = 0.137		average validation NDCG = 0.664

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-08, 50, 1.5)], which got scores of [0.7003346767324784, 0.69622999934570839, 0.69092304766068247]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.045365    	average train batch reward = 0.550
validation accuracy = 0.123		average validation NDCG = 0.672

epoch 2
average train loss = -0.023643    	average train batch reward = 0.549
validation accuracy = 0.123		average validation NDCG = 0.672

epoch 3
average train loss = -0.053723    	average train batch reward = 0.552
validation accuracy = 0.124		average validation NDCG = 0.673

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-08, 50, 1.5)], which got scores of [0.7003346767324784, 0.69622999934570839, 0.69092304766068247]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.031505    	average train batch reward = 0.579
validation accuracy = 0.119		average validation NDCG = 0.692

epoch 2
average train loss = -0.038420    	average train batch reward = 0.579
validation accuracy = 0.122		average validation NDCG = 0.692

epoch 3
average train loss = -0.079273    	average train batch reward = 0.581
validation accuracy = 0.123		average validation NDCG = 0.693

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 512, 1.0)], which got scores of [0.7003346767324784, 0.69622999934570839, 0.69280414527975853]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.059863    	average train batch reward = 0.548
validation accuracy = 0.103		average validation NDCG = 0.670

epoch 2
average train loss = -0.036087    	average train batch reward = 0.552
validation accuracy = 0.104		average validation NDCG = 0.671

epoch 3
average train loss = -0.094779    	average train batch reward = 0.553
validation accuracy = 0.106		average validation NDCG = 0.672

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 512, 1.0)], which got scores of [0.7003346767324784, 0.69622999934570839, 0.69280414527975853]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.012728    	average train batch reward = 0.544
validation accuracy = 0.074		average validation NDCG = 0.660

epoch 2
average train loss = 0.088243    	average train batch reward = 0.545
validation accuracy = 0.074		average validation NDCG = 0.661

epoch 3
average train loss = 0.186831    	average train batch reward = 0.544
validation accuracy = 0.074		average validation NDCG = 0.661

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 512, 1.0)], which got scores of [0.7003346767324784, 0.69622999934570839, 0.69280414527975853]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.010720    	average train batch reward = 0.542
validation accuracy = 0.119		average validation NDCG = 0.668

epoch 2
average train loss = -0.011648    	average train batch reward = 0.543
validation accuracy = 0.119		average validation NDCG = 0.668

epoch 3
average train loss = -0.037961    	average train batch reward = 0.543
validation accuracy = 0.119		average validation NDCG = 0.668

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 512, 1.0)], which got scores of [0.7003346767324784, 0.69622999934570839, 0.69280414527975853]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.124523    	average train batch reward = 0.562
validation accuracy = 0.079		average validation NDCG = 0.674

epoch 2
average train loss = -0.017750    	average train batch reward = 0.563
validation accuracy = 0.080		average validation NDCG = 0.674

epoch 3
average train loss = -0.046074    	average train batch reward = 0.562
validation accuracy = 0.080		average validation NDCG = 0.674

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 512, 1.0)], which got scores of [0.7003346767324784, 0.69622999934570839, 0.69280414527975853]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.002240    	average train batch reward = 0.555
validation accuracy = 0.138		average validation NDCG = 0.668

epoch 2
average train loss = -0.069664    	average train batch reward = 0.556
validation accuracy = 0.139		average validation NDCG = 0.668

epoch 3
average train loss = -0.147749    	average train batch reward = 0.554
validation accuracy = 0.139		average validation NDCG = 0.669

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 512, 1.0)], which got scores of [0.7003346767324784, 0.69622999934570839, 0.69280414527975853]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.043026    	average train batch reward = 0.552
validation accuracy = 0.121		average validation NDCG = 0.678

epoch 2
average train loss = 0.016956    	average train batch reward = 0.553
validation accuracy = 0.121		average validation NDCG = 0.678

epoch 3
average train loss = -0.009457    	average train batch reward = 0.553
validation accuracy = 0.122		average validation NDCG = 0.679

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 512, 1.0)], which got scores of [0.7003346767324784, 0.69622999934570839, 0.69280414527975853]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.056011    	average train batch reward = 0.584
validation accuracy = 0.146		average validation NDCG = 0.697

epoch 2
average train loss = -0.181585    	average train batch reward = 0.585
validation accuracy = 0.146		average validation NDCG = 0.697

epoch 3
average train loss = -0.185411    	average train batch reward = 0.585
validation accuracy = 0.146		average validation NDCG = 0.698

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-07, 5012, 1.5), (9.9999999999999995e-07, 50, 1.5)], which got scores of [0.7003346767324784, 0.6975506704719534, 0.69622999934570839]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.020450    	average train batch reward = 0.569
validation accuracy = 0.131		average validation NDCG = 0.689

epoch 2
average train loss = -0.170435    	average train batch reward = 0.593
validation accuracy = 0.151		average validation NDCG = 0.713

epoch 3
average train loss = -0.323313    	average train batch reward = 0.624
validation accuracy = 0.185		average validation NDCG = 0.742

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.0), (9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-07, 50, 1.5)], which got scores of [0.7416239717286921, 0.7003346767324784, 0.69622999934570839]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.142343    	average train batch reward = 0.563
validation accuracy = 0.156		average validation NDCG = 0.707

epoch 2
average train loss = -0.316303    	average train batch reward = 0.605
validation accuracy = 0.225		average validation NDCG = 0.736

epoch 3
average train loss = -0.631329    	average train batch reward = 0.634
validation accuracy = 0.258		average validation NDCG = 0.758

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.05), (1.0000000000000001e-05, 50, 0.0), (9.9999999999999995e-07, 50, 1.5)], which got scores of [0.75800757631407001, 0.7416239717286921, 0.69622999934570839]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.029521    	average train batch reward = 0.556
validation accuracy = 0.122		average validation NDCG = 0.689

epoch 2
average train loss = -0.215193    	average train batch reward = 0.600
validation accuracy = 0.167		average validation NDCG = 0.725

epoch 3
average train loss = -0.675057    	average train batch reward = 0.645
validation accuracy = 0.237		average validation NDCG = 0.763

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.05), (9.9999999999999995e-07, 50, 1.5)], which got scores of [0.76342487819850191, 0.75800757631407001, 0.69622999934570839]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.123093    	average train batch reward = 0.601
validation accuracy = 0.157		average validation NDCG = 0.734

epoch 2
average train loss = -0.518617    	average train batch reward = 0.633
validation accuracy = 0.206		average validation NDCG = 0.766

epoch 3
average train loss = -0.505385    	average train batch reward = 0.665
validation accuracy = 0.256		average validation NDCG = 0.793

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 0.2), (9.9999999999999995e-07, 50, 1.5)], which got scores of [0.79338874145288019, 0.76342487819850191, 0.69622999934570839]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.189120    	average train batch reward = 0.566
validation accuracy = 0.160		average validation NDCG = 0.698

epoch 2
average train loss = -0.475550    	average train batch reward = 0.600
validation accuracy = 0.197		average validation NDCG = 0.726

epoch 3
average train loss = -0.819500    	average train batch reward = 0.629
validation accuracy = 0.224		average validation NDCG = 0.752

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 1.0)], which got scores of [0.79338874145288019, 0.76342487819850191, 0.75233810951273139]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.219421    	average train batch reward = 0.594
validation accuracy = 0.169		average validation NDCG = 0.719

epoch 2
average train loss = -0.547346    	average train batch reward = 0.628
validation accuracy = 0.173		average validation NDCG = 0.744

epoch 3
average train loss = -0.552752    	average train batch reward = 0.657
validation accuracy = 0.196		average validation NDCG = 0.770

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.79338874145288019, 0.76962436214884566, 0.76342487819850191]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.047826    	average train batch reward = 0.559
validation accuracy = 0.124		average validation NDCG = 0.688

epoch 2
average train loss = -0.054943    	average train batch reward = 0.573
validation accuracy = 0.153		average validation NDCG = 0.701

epoch 3
average train loss = -0.154043    	average train batch reward = 0.583
validation accuracy = 0.171		average validation NDCG = 0.709

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.79338874145288019, 0.76962436214884566, 0.76342487819850191]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.108961    	average train batch reward = 0.538
validation accuracy = 0.102		average validation NDCG = 0.666

epoch 2
average train loss = -0.099158    	average train batch reward = 0.549
validation accuracy = 0.116		average validation NDCG = 0.672

epoch 3
average train loss = -0.160070    	average train batch reward = 0.555
validation accuracy = 0.122		average validation NDCG = 0.677

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.79338874145288019, 0.76962436214884566, 0.76342487819850191]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.063137    	average train batch reward = 0.534
validation accuracy = 0.099		average validation NDCG = 0.665

epoch 2
average train loss = 0.024168    	average train batch reward = 0.545
validation accuracy = 0.101		average validation NDCG = 0.675

epoch 3
average train loss = 0.034442    	average train batch reward = 0.556
validation accuracy = 0.104		average validation NDCG = 0.684

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.79338874145288019, 0.76962436214884566, 0.76342487819850191]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.153306    	average train batch reward = 0.543
validation accuracy = 0.131		average validation NDCG = 0.671

epoch 2
average train loss = -0.124988    	average train batch reward = 0.554
validation accuracy = 0.137		average validation NDCG = 0.678

epoch 3
average train loss = -0.215478    	average train batch reward = 0.565
validation accuracy = 0.144		average validation NDCG = 0.685

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.79338874145288019, 0.76962436214884566, 0.76342487819850191]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.119862    	average train batch reward = 0.528
validation accuracy = 0.070		average validation NDCG = 0.668

epoch 2
average train loss = -0.054071    	average train batch reward = 0.539
validation accuracy = 0.083		average validation NDCG = 0.676

epoch 3
average train loss = 0.009373    	average train batch reward = 0.549
validation accuracy = 0.090		average validation NDCG = 0.681

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.79338874145288019, 0.76962436214884566, 0.76342487819850191]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.036283    	average train batch reward = 0.559
validation accuracy = 0.098		average validation NDCG = 0.676

epoch 2
average train loss = -0.147677    	average train batch reward = 0.571
validation accuracy = 0.103		average validation NDCG = 0.685

epoch 3
average train loss = -0.180919    	average train batch reward = 0.581
validation accuracy = 0.114		average validation NDCG = 0.694

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.79338874145288019, 0.76962436214884566, 0.76342487819850191]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.006097    	average train batch reward = 0.552
validation accuracy = 0.076		average validation NDCG = 0.670

epoch 2
average train loss = -0.017718    	average train batch reward = 0.555
validation accuracy = 0.079		average validation NDCG = 0.672

epoch 3
average train loss = -0.145818    	average train batch reward = 0.559
validation accuracy = 0.081		average validation NDCG = 0.674

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.79338874145288019, 0.76962436214884566, 0.76342487819850191]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.116346    	average train batch reward = 0.564
validation accuracy = 0.151		average validation NDCG = 0.679

epoch 2
average train loss = -0.059307    	average train batch reward = 0.567
validation accuracy = 0.161		average validation NDCG = 0.682

epoch 3
average train loss = -0.136292    	average train batch reward = 0.571
validation accuracy = 0.172		average validation NDCG = 0.685

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.79338874145288019, 0.76962436214884566, 0.76342487819850191]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.000464    	average train batch reward = 0.519
validation accuracy = 0.088		average validation NDCG = 0.654

epoch 2
average train loss = -0.022149    	average train batch reward = 0.523
validation accuracy = 0.090		average validation NDCG = 0.655

epoch 3
average train loss = 0.090228    	average train batch reward = 0.526
validation accuracy = 0.092		average validation NDCG = 0.656

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.79338874145288019, 0.76962436214884566, 0.76342487819850191]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.010059    	average train batch reward = 0.574
validation accuracy = 0.107		average validation NDCG = 0.700

epoch 2
average train loss = -0.024568    	average train batch reward = 0.578
validation accuracy = 0.115		average validation NDCG = 0.703

epoch 3
average train loss = -0.022525    	average train batch reward = 0.581
validation accuracy = 0.120		average validation NDCG = 0.706

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.79338874145288019, 0.76962436214884566, 0.76342487819850191]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.066006    	average train batch reward = 0.580
validation accuracy = 0.141		average validation NDCG = 0.693

epoch 2
average train loss = -0.028414    	average train batch reward = 0.582
validation accuracy = 0.148		average validation NDCG = 0.695

epoch 3
average train loss = -0.049358    	average train batch reward = 0.587
validation accuracy = 0.155		average validation NDCG = 0.697

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.79338874145288019, 0.76962436214884566, 0.76342487819850191]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.045405    	average train batch reward = 0.543
validation accuracy = 0.115		average validation NDCG = 0.669

epoch 2
average train loss = -0.042994    	average train batch reward = 0.546
validation accuracy = 0.118		average validation NDCG = 0.671

epoch 3
average train loss = 0.060421    	average train batch reward = 0.550
validation accuracy = 0.120		average validation NDCG = 0.672

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.79338874145288019, 0.76962436214884566, 0.76342487819850191]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1.607012    	average train batch reward = 0.645
validation accuracy = 0.285		average validation NDCG = 0.803

epoch 2
average train loss = -3.973561    	average train batch reward = 0.718
validation accuracy = 0.418		average validation NDCG = 0.842

epoch 3
average train loss = -6.251373    	average train batch reward = 0.739
validation accuracy = 0.476		average validation NDCG = 0.849

========
Currently the best setups are [(0.0001, 50, 0.0), (1.0000000000000001e-05, 50, 0.5), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.84884595951632225, 0.79338874145288019, 0.76342487819850191]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.532569    	average train batch reward = 0.626
validation accuracy = 0.323		average validation NDCG = 0.800

epoch 2
average train loss = -3.401240    	average train batch reward = 0.703
validation accuracy = 0.415		average validation NDCG = 0.821

epoch 3
average train loss = -5.123289    	average train batch reward = 0.712
validation accuracy = 0.402		average validation NDCG = 0.829

========
Currently the best setups are [(0.0001, 50, 0.0), (0.0001, 50, 0.05), (1.0000000000000001e-05, 50, 0.5)], which got scores of [0.84884595951632225, 0.82866647944018224, 0.79338874145288019]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1.421627    	average train batch reward = 0.687
validation accuracy = 0.390		average validation NDCG = 0.834

epoch 2
average train loss = -4.463021    	average train batch reward = 0.721
validation accuracy = 0.383		average validation NDCG = 0.837

epoch 3
average train loss = -5.782968    	average train batch reward = 0.733
validation accuracy = 0.432		average validation NDCG = 0.843

========
Currently the best setups are [(0.0001, 50, 0.0), (0.0001, 50, 0.2), (0.0001, 50, 0.05)], which got scores of [0.84884595951632225, 0.84316827032865649, 0.82866647944018224]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1.904316    	average train batch reward = 0.671
validation accuracy = 0.356		average validation NDCG = 0.817

epoch 2
average train loss = -5.423403    	average train batch reward = 0.727
validation accuracy = 0.369		average validation NDCG = 0.835

epoch 3
average train loss = -7.794316    	average train batch reward = 0.735
validation accuracy = 0.377		average validation NDCG = 0.844

========
Currently the best setups are [(0.0001, 50, 0.0), (0.0001, 50, 0.5), (0.0001, 50, 0.2)], which got scores of [0.84884595951632225, 0.84385615007028991, 0.84316827032865649]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.490698    	average train batch reward = 0.596
validation accuracy = 0.250		average validation NDCG = 0.776

epoch 2
average train loss = -2.125866    	average train batch reward = 0.706
validation accuracy = 0.377		average validation NDCG = 0.855

epoch 3
average train loss = -4.079108    	average train batch reward = 0.760
validation accuracy = 0.434		average validation NDCG = 0.885

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.0), (0.0001, 50, 0.2)], which got scores of [0.88527787565074401, 0.84884595951632225, 0.84316827032865649]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1.247572    	average train batch reward = 0.645
validation accuracy = 0.374		average validation NDCG = 0.815

epoch 2
average train loss = -3.221754    	average train batch reward = 0.720
validation accuracy = 0.408		average validation NDCG = 0.837

epoch 3
average train loss = -5.042435    	average train batch reward = 0.741
validation accuracy = 0.423		average validation NDCG = 0.856

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.146700    	average train batch reward = 0.575
validation accuracy = 0.205		average validation NDCG = 0.718

epoch 2
average train loss = -0.958584    	average train batch reward = 0.647
validation accuracy = 0.285		average validation NDCG = 0.768

epoch 3
average train loss = -2.058665    	average train batch reward = 0.686
validation accuracy = 0.378		average validation NDCG = 0.797

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.266143    	average train batch reward = 0.575
validation accuracy = 0.184		average validation NDCG = 0.726

epoch 2
average train loss = -1.093867    	average train batch reward = 0.647
validation accuracy = 0.302		average validation NDCG = 0.774

epoch 3
average train loss = -1.652307    	average train batch reward = 0.699
validation accuracy = 0.362		average validation NDCG = 0.814

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.088252    	average train batch reward = 0.550
validation accuracy = 0.107		average validation NDCG = 0.700

epoch 2
average train loss = -0.801429    	average train batch reward = 0.614
validation accuracy = 0.221		average validation NDCG = 0.771

epoch 3
average train loss = -1.370070    	average train batch reward = 0.685
validation accuracy = 0.364		average validation NDCG = 0.808

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.343580    	average train batch reward = 0.585
validation accuracy = 0.279		average validation NDCG = 0.731

epoch 2
average train loss = -1.110213    	average train batch reward = 0.650
validation accuracy = 0.318		average validation NDCG = 0.777

epoch 3
average train loss = -1.996760    	average train batch reward = 0.678
validation accuracy = 0.374		average validation NDCG = 0.792

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.440076    	average train batch reward = 0.607
validation accuracy = 0.262		average validation NDCG = 0.756

epoch 2
average train loss = -0.960599    	average train batch reward = 0.682
validation accuracy = 0.343		average validation NDCG = 0.798

epoch 3
average train loss = -1.538570    	average train batch reward = 0.710
validation accuracy = 0.370		average validation NDCG = 0.817

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.155591    	average train batch reward = 0.602
validation accuracy = 0.193		average validation NDCG = 0.755

epoch 2
average train loss = -0.446457    	average train batch reward = 0.675
validation accuracy = 0.266		average validation NDCG = 0.801

epoch 3
average train loss = -1.526040    	average train batch reward = 0.716
validation accuracy = 0.313		average validation NDCG = 0.830

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.063055    	average train batch reward = 0.548
validation accuracy = 0.120		average validation NDCG = 0.668

epoch 2
average train loss = -0.150375    	average train batch reward = 0.568
validation accuracy = 0.140		average validation NDCG = 0.685

epoch 3
average train loss = -0.414202    	average train batch reward = 0.597
validation accuracy = 0.172		average validation NDCG = 0.708

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.067886    	average train batch reward = 0.578
validation accuracy = 0.118		average validation NDCG = 0.708

epoch 2
average train loss = -0.334257    	average train batch reward = 0.601
validation accuracy = 0.186		average validation NDCG = 0.724

epoch 3
average train loss = -0.615923    	average train batch reward = 0.620
validation accuracy = 0.231		average validation NDCG = 0.740

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.066136    	average train batch reward = 0.566
validation accuracy = 0.105		average validation NDCG = 0.692

epoch 2
average train loss = -0.156923    	average train batch reward = 0.589
validation accuracy = 0.145		average validation NDCG = 0.711

epoch 3
average train loss = -0.318125    	average train batch reward = 0.616
validation accuracy = 0.187		average validation NDCG = 0.735

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.039938    	average train batch reward = 0.558
validation accuracy = 0.104		average validation NDCG = 0.686

epoch 2
average train loss = -0.207734    	average train batch reward = 0.575
validation accuracy = 0.158		average validation NDCG = 0.702

epoch 3
average train loss = -0.421340    	average train batch reward = 0.591
validation accuracy = 0.189		average validation NDCG = 0.715

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.038471    	average train batch reward = 0.514
validation accuracy = 0.078		average validation NDCG = 0.660

epoch 2
average train loss = -0.048788    	average train batch reward = 0.541
validation accuracy = 0.110		average validation NDCG = 0.677

epoch 3
average train loss = -0.313470    	average train batch reward = 0.568
validation accuracy = 0.158		average validation NDCG = 0.695

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.022325    	average train batch reward = 0.567
validation accuracy = 0.126		average validation NDCG = 0.688

epoch 2
average train loss = -0.294056    	average train batch reward = 0.589
validation accuracy = 0.228		average validation NDCG = 0.707

epoch 3
average train loss = -0.293978    	average train batch reward = 0.606
validation accuracy = 0.256		average validation NDCG = 0.723

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -8.245894    	average train batch reward = 0.662
validation accuracy = 0.319		average validation NDCG = 0.823

epoch 2
average train loss = -56.223465    	average train batch reward = 0.694
validation accuracy = 0.276		average validation NDCG = 0.817

epoch 3
average train loss = -239.712860    	average train batch reward = 0.702
validation accuracy = 0.167		average validation NDCG = 0.827

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -16.159986    	average train batch reward = 0.664
validation accuracy = 0.375		average validation NDCG = 0.809

epoch 2
average train loss = -90.350021    	average train batch reward = 0.700
validation accuracy = 0.313		average validation NDCG = 0.828

epoch 3
average train loss = -215.679474    	average train batch reward = 0.715
validation accuracy = 0.280		average validation NDCG = 0.823

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -14.294703    	average train batch reward = 0.625
validation accuracy = 0.249		average validation NDCG = 0.743

epoch 2
average train loss = -69.708473    	average train batch reward = 0.631
validation accuracy = 0.301		average validation NDCG = 0.749

epoch 3
average train loss = -276.902405    	average train batch reward = 0.646
validation accuracy = 0.276		average validation NDCG = 0.761

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3.028406    	average train batch reward = 0.565
validation accuracy = 0.099		average validation NDCG = 0.693

epoch 2
average train loss = -18.389368    	average train batch reward = 0.574
validation accuracy = 0.151		average validation NDCG = 0.694

epoch 3
average train loss = -34.042522    	average train batch reward = 0.580
validation accuracy = 0.117		average validation NDCG = 0.698

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -6.531866    	average train batch reward = 0.602
validation accuracy = 0.198		average validation NDCG = 0.744

epoch 2
average train loss = -36.831085    	average train batch reward = 0.635
validation accuracy = 0.266		average validation NDCG = 0.749

epoch 3
average train loss = -208.863556    	average train batch reward = 0.635
validation accuracy = 0.274		average validation NDCG = 0.751

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -13.561017    	average train batch reward = 0.614
validation accuracy = 0.185		average validation NDCG = 0.750

epoch 2
average train loss = -112.372894    	average train batch reward = 0.643
validation accuracy = 0.267		average validation NDCG = 0.757

epoch 3
average train loss = -275.521149    	average train batch reward = 0.649
validation accuracy = 0.264		average validation NDCG = 0.756

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2.057201    	average train batch reward = 0.623
validation accuracy = 0.275		average validation NDCG = 0.772

epoch 2
average train loss = -5.430118    	average train batch reward = 0.683
validation accuracy = 0.338		average validation NDCG = 0.805

epoch 3
average train loss = -14.576388    	average train batch reward = 0.703
validation accuracy = 0.270		average validation NDCG = 0.817

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2.038733    	average train batch reward = 0.618
validation accuracy = 0.233		average validation NDCG = 0.770

epoch 2
average train loss = -6.744930    	average train batch reward = 0.684
validation accuracy = 0.394		average validation NDCG = 0.788

epoch 3
average train loss = -21.230515    	average train batch reward = 0.692
validation accuracy = 0.404		average validation NDCG = 0.804

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3.572680    	average train batch reward = 0.661
validation accuracy = 0.316		average validation NDCG = 0.823

epoch 2
average train loss = -9.824697    	average train batch reward = 0.730
validation accuracy = 0.410		average validation NDCG = 0.836

epoch 3
average train loss = -23.411776    	average train batch reward = 0.729
validation accuracy = 0.414		average validation NDCG = 0.837

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 1.5), (0.0001, 50, 0.0)], which got scores of [0.88527787565074401, 0.85552763784810959, 0.84884595951632225]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1.529144    	average train batch reward = 0.657
validation accuracy = 0.373		average validation NDCG = 0.814

epoch 2
average train loss = -11.942231    	average train batch reward = 0.732
validation accuracy = 0.336		average validation NDCG = 0.839

epoch 3
average train loss = -24.247099    	average train batch reward = 0.747
validation accuracy = 0.376		average validation NDCG = 0.859

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1.397852    	average train batch reward = 0.658
validation accuracy = 0.359		average validation NDCG = 0.805

epoch 2
average train loss = -9.445695    	average train batch reward = 0.713
validation accuracy = 0.414		average validation NDCG = 0.820

epoch 3
average train loss = -18.671032    	average train batch reward = 0.722
validation accuracy = 0.401		average validation NDCG = 0.831

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1.662490    	average train batch reward = 0.633
validation accuracy = 0.356		average validation NDCG = 0.798

epoch 2
average train loss = -10.698452    	average train batch reward = 0.680
validation accuracy = 0.401		average validation NDCG = 0.805

epoch 3
average train loss = -20.784912    	average train batch reward = 0.683
validation accuracy = 0.366		average validation NDCG = 0.805

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.410823    	average train batch reward = 0.626
validation accuracy = 0.327		average validation NDCG = 0.778

epoch 2
average train loss = -1.977302    	average train batch reward = 0.697
validation accuracy = 0.433		average validation NDCG = 0.812

epoch 3
average train loss = -3.591219    	average train batch reward = 0.707
validation accuracy = 0.451		average validation NDCG = 0.815

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.305269    	average train batch reward = 0.603
validation accuracy = 0.257		average validation NDCG = 0.761

epoch 2
average train loss = -1.835815    	average train batch reward = 0.695
validation accuracy = 0.415		average validation NDCG = 0.830

epoch 3
average train loss = -3.164212    	average train batch reward = 0.736
validation accuracy = 0.402		average validation NDCG = 0.851

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.558732    	average train batch reward = 0.581
validation accuracy = 0.192		average validation NDCG = 0.744

epoch 2
average train loss = -1.803057    	average train batch reward = 0.669
validation accuracy = 0.275		average validation NDCG = 0.810

epoch 3
average train loss = -4.435423    	average train batch reward = 0.710
validation accuracy = 0.444		average validation NDCG = 0.821

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.256190    	average train batch reward = 0.597
validation accuracy = 0.173		average validation NDCG = 0.763

epoch 2
average train loss = -1.343361    	average train batch reward = 0.680
validation accuracy = 0.306		average validation NDCG = 0.813

epoch 3
average train loss = -4.472058    	average train batch reward = 0.716
validation accuracy = 0.342		average validation NDCG = 0.837

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.290668    	average train batch reward = 0.592
validation accuracy = 0.181		average validation NDCG = 0.776

epoch 2
average train loss = -0.901238    	average train batch reward = 0.676
validation accuracy = 0.308		average validation NDCG = 0.806

epoch 3
average train loss = -2.460410    	average train batch reward = 0.704
validation accuracy = 0.348		average validation NDCG = 0.830

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.201712    	average train batch reward = 0.573
validation accuracy = 0.226		average validation NDCG = 0.733

epoch 2
average train loss = -1.492975    	average train batch reward = 0.647
validation accuracy = 0.286		average validation NDCG = 0.790

epoch 3
average train loss = -3.717948    	average train batch reward = 0.690
validation accuracy = 0.344		average validation NDCG = 0.815

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -256.373016    	average train batch reward = 0.584
validation accuracy = 0.194		average validation NDCG = 0.712

epoch 2
average train loss = -2134.299316    	average train batch reward = 0.593
validation accuracy = 0.200		average validation NDCG = 0.709

epoch 3
average train loss = -5747.866211    	average train batch reward = 0.594
validation accuracy = 0.162		average validation NDCG = 0.710

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -282.469727    	average train batch reward = 0.589
validation accuracy = 0.101		average validation NDCG = 0.723

epoch 2
average train loss = -2405.622070    	average train batch reward = 0.601
validation accuracy = 0.171		average validation NDCG = 0.722

epoch 3
average train loss = -11926.104492    	average train batch reward = 0.602
validation accuracy = 0.187		average validation NDCG = 0.722

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -399.925201    	average train batch reward = 0.566
validation accuracy = 0.104		average validation NDCG = 0.697

epoch 2
average train loss = -5140.453125    	average train batch reward = 0.581
validation accuracy = 0.099		average validation NDCG = 0.698

epoch 3
average train loss = -5163.674316    	average train batch reward = 0.579
validation accuracy = 0.100		average validation NDCG = 0.697

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -558.581787    	average train batch reward = 0.620
validation accuracy = 0.235		average validation NDCG = 0.752

epoch 2
average train loss = -6206.479980    	average train batch reward = 0.651
validation accuracy = 0.202		average validation NDCG = 0.794

epoch 3
average train loss = -15903.019531    	average train batch reward = 0.672
validation accuracy = 0.197		average validation NDCG = 0.790

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -193.606400    	average train batch reward = 0.584
validation accuracy = 0.193		average validation NDCG = 0.746

epoch 2
average train loss = -3349.756836    	average train batch reward = 0.635
validation accuracy = 0.255		average validation NDCG = 0.750

epoch 3
average train loss = -13774.301758    	average train batch reward = 0.637
validation accuracy = 0.203		average validation NDCG = 0.757

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -525.750793    	average train batch reward = 0.589
validation accuracy = 0.125		average validation NDCG = 0.722

epoch 2
average train loss = -1504.634399    	average train batch reward = 0.627
validation accuracy = 0.201		average validation NDCG = 0.743

epoch 3
average train loss = -6642.318359    	average train batch reward = 0.639
validation accuracy = 0.163		average validation NDCG = 0.755

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -47.428173    	average train batch reward = 0.631
validation accuracy = 0.293		average validation NDCG = 0.771

epoch 2
average train loss = -336.891357    	average train batch reward = 0.657
validation accuracy = 0.311		average validation NDCG = 0.770

epoch 3
average train loss = -1059.320435    	average train batch reward = 0.661
validation accuracy = 0.309		average validation NDCG = 0.767

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -35.876640    	average train batch reward = 0.618
validation accuracy = 0.312		average validation NDCG = 0.753

epoch 2
average train loss = -441.085510    	average train batch reward = 0.646
validation accuracy = 0.288		average validation NDCG = 0.770

epoch 3
average train loss = -864.600403    	average train batch reward = 0.664
validation accuracy = 0.279		average validation NDCG = 0.786

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -132.345901    	average train batch reward = 0.605
validation accuracy = 0.176		average validation NDCG = 0.728

epoch 2
average train loss = -843.677368    	average train batch reward = 0.609
validation accuracy = 0.185		average validation NDCG = 0.744

epoch 3
average train loss = -2369.902588    	average train batch reward = 0.621
validation accuracy = 0.181		average validation NDCG = 0.741

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3.953620    	average train batch reward = 0.575
validation accuracy = 0.146		average validation NDCG = 0.703

epoch 2
average train loss = -77.550621    	average train batch reward = 0.580
validation accuracy = 0.196		average validation NDCG = 0.707

epoch 3
average train loss = -356.032471    	average train batch reward = 0.598
validation accuracy = 0.192		average validation NDCG = 0.715

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -4.847817    	average train batch reward = 0.597
validation accuracy = 0.201		average validation NDCG = 0.715

epoch 2
average train loss = -68.802757    	average train batch reward = 0.600
validation accuracy = 0.147		average validation NDCG = 0.728

epoch 3
average train loss = -403.236359    	average train batch reward = 0.605
validation accuracy = 0.215		average validation NDCG = 0.725

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -58.516254    	average train batch reward = 0.631
validation accuracy = 0.255		average validation NDCG = 0.764

epoch 2
average train loss = -272.564850    	average train batch reward = 0.645
validation accuracy = 0.250		average validation NDCG = 0.770

epoch 3
average train loss = -1037.424561    	average train batch reward = 0.654
validation accuracy = 0.258		average validation NDCG = 0.775

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -4.986931    	average train batch reward = 0.625
validation accuracy = 0.329		average validation NDCG = 0.790

epoch 2
average train loss = -26.411728    	average train batch reward = 0.684
validation accuracy = 0.354		average validation NDCG = 0.809

epoch 3
average train loss = -93.642693    	average train batch reward = 0.699
validation accuracy = 0.368		average validation NDCG = 0.808

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3.279586    	average train batch reward = 0.614
validation accuracy = 0.279		average validation NDCG = 0.763

epoch 2
average train loss = -25.155148    	average train batch reward = 0.681
validation accuracy = 0.357		average validation NDCG = 0.818

epoch 3
average train loss = -81.109886    	average train batch reward = 0.712
validation accuracy = 0.344		average validation NDCG = 0.823

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3.172619    	average train batch reward = 0.623
validation accuracy = 0.321		average validation NDCG = 0.799

epoch 2
average train loss = -16.230167    	average train batch reward = 0.697
validation accuracy = 0.347		average validation NDCG = 0.830

epoch 3
average train loss = -47.274364    	average train batch reward = 0.718
validation accuracy = 0.302		average validation NDCG = 0.830

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3.498774    	average train batch reward = 0.650
validation accuracy = 0.307		average validation NDCG = 0.835

epoch 2
average train loss = -13.287677    	average train batch reward = 0.733
validation accuracy = 0.362		average validation NDCG = 0.844

epoch 3
average train loss = -36.805367    	average train batch reward = 0.735
validation accuracy = 0.340		average validation NDCG = 0.851

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.710459    	average train batch reward = 0.602
validation accuracy = 0.256		average validation NDCG = 0.746

epoch 2
average train loss = -14.327474    	average train batch reward = 0.643
validation accuracy = 0.282		average validation NDCG = 0.780

epoch 3
average train loss = -33.706100    	average train batch reward = 0.665
validation accuracy = 0.353		average validation NDCG = 0.785

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2.581517    	average train batch reward = 0.609
validation accuracy = 0.249		average validation NDCG = 0.774

epoch 2
average train loss = -26.624741    	average train batch reward = 0.677
validation accuracy = 0.365		average validation NDCG = 0.808

epoch 3
average train loss = -79.026230    	average train batch reward = 0.702
validation accuracy = 0.337		average validation NDCG = 0.822

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -118609.148438    	average train batch reward = 0.575
validation accuracy = 0.174		average validation NDCG = 0.699

epoch 2
average train loss = -913457.062500    	average train batch reward = 0.581
validation accuracy = 0.135		average validation NDCG = 0.700

epoch 3
average train loss = -2837684.750000    	average train batch reward = 0.585
validation accuracy = 0.135		average validation NDCG = 0.701

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 28.404545    	average train batch reward = 0.551
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 2
average train loss = 0.000000    	average train batch reward = 0.553
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 3
average train loss = 0.000000    	average train batch reward = 0.554
validation accuracy = 0.096		average validation NDCG = 0.672

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -23363.773438    	average train batch reward = 0.578
validation accuracy = 0.159		average validation NDCG = 0.707

epoch 2
average train loss = -212493.156250    	average train batch reward = 0.599
validation accuracy = 0.193		average validation NDCG = 0.715

epoch 3
average train loss = -554129.812500    	average train batch reward = 0.604
validation accuracy = 0.190		average validation NDCG = 0.715

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -60901.570312    	average train batch reward = 0.585
validation accuracy = 0.165		average validation NDCG = 0.730

epoch 2
average train loss = -769465.062500    	average train batch reward = 0.607
validation accuracy = 0.149		average validation NDCG = 0.730

epoch 3
average train loss = -2097752.250000    	average train batch reward = 0.609
validation accuracy = 0.142		average validation NDCG = 0.727

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -53090.257812    	average train batch reward = 0.580
validation accuracy = 0.118		average validation NDCG = 0.702

epoch 2
average train loss = -425005.000000    	average train batch reward = 0.594
validation accuracy = 0.152		average validation NDCG = 0.719

epoch 3
average train loss = -1053997.125000    	average train batch reward = 0.605
validation accuracy = 0.154		average validation NDCG = 0.719

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -21299.328125    	average train batch reward = 0.569
validation accuracy = 0.139		average validation NDCG = 0.692

epoch 2
average train loss = -50506.359375    	average train batch reward = 0.576
validation accuracy = 0.184		average validation NDCG = 0.695

epoch 3
average train loss = -102613.296875    	average train batch reward = 0.577
validation accuracy = 0.179		average validation NDCG = 0.695

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -7796.681641    	average train batch reward = 0.586
validation accuracy = 0.159		average validation NDCG = 0.708

epoch 2
average train loss = -32442.925781    	average train batch reward = 0.600
validation accuracy = 0.150		average validation NDCG = 0.715

epoch 3
average train loss = -98101.828125    	average train batch reward = 0.610
validation accuracy = 0.191		average validation NDCG = 0.724

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1118.000610    	average train batch reward = 0.585
validation accuracy = 0.093		average validation NDCG = 0.728

epoch 2
average train loss = -10229.214844    	average train batch reward = 0.614
validation accuracy = 0.175		average validation NDCG = 0.741

epoch 3
average train loss = -74156.546875    	average train batch reward = 0.613
validation accuracy = 0.172		average validation NDCG = 0.733

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -471.088593    	average train batch reward = 0.581
validation accuracy = 0.224		average validation NDCG = 0.715

epoch 2
average train loss = -27131.675781    	average train batch reward = 0.612
validation accuracy = 0.144		average validation NDCG = 0.721

epoch 3
average train loss = -99065.101562    	average train batch reward = 0.611
validation accuracy = 0.187		average validation NDCG = 0.727

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -9120.566406    	average train batch reward = 0.620
validation accuracy = 0.143		average validation NDCG = 0.758

epoch 2
average train loss = -46765.101562    	average train batch reward = 0.643
validation accuracy = 0.155		average validation NDCG = 0.753

epoch 3
average train loss = -102356.351562    	average train batch reward = 0.643
validation accuracy = 0.197		average validation NDCG = 0.753

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -7966.882324    	average train batch reward = 0.589
validation accuracy = 0.096		average validation NDCG = 0.702

epoch 2
average train loss = -107797.890625    	average train batch reward = 0.584
validation accuracy = 0.096		average validation NDCG = 0.703

epoch 3
average train loss = -170495.343750    	average train batch reward = 0.585
validation accuracy = 0.096		average validation NDCG = 0.703

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -5521.576172    	average train batch reward = 0.613
validation accuracy = 0.181		average validation NDCG = 0.731

epoch 2
average train loss = -63164.894531    	average train batch reward = 0.636
validation accuracy = 0.142		average validation NDCG = 0.753

epoch 3
average train loss = -167325.687500    	average train batch reward = 0.635
validation accuracy = 0.154		average validation NDCG = 0.751

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -119.933678    	average train batch reward = 0.587
validation accuracy = 0.118		average validation NDCG = 0.737

epoch 2
average train loss = -551.899048    	average train batch reward = 0.626
validation accuracy = 0.099		average validation NDCG = 0.738

epoch 3
average train loss = -1179.970459    	average train batch reward = 0.624
validation accuracy = 0.119		average validation NDCG = 0.744

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -7.752492    	average train batch reward = 0.580
validation accuracy = 0.156		average validation NDCG = 0.715

epoch 2
average train loss = -639.613220    	average train batch reward = 0.609
validation accuracy = 0.240		average validation NDCG = 0.722

epoch 3
average train loss = -2141.532227    	average train batch reward = 0.610
validation accuracy = 0.208		average validation NDCG = 0.720

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -123.477493    	average train batch reward = 0.572
validation accuracy = 0.098		average validation NDCG = 0.714

epoch 2
average train loss = -1003.694824    	average train batch reward = 0.608
validation accuracy = 0.159		average validation NDCG = 0.749

epoch 3
average train loss = -3675.391357    	average train batch reward = 0.628
validation accuracy = 0.177		average validation NDCG = 0.752

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -70.387909    	average train batch reward = 0.626
validation accuracy = 0.292		average validation NDCG = 0.790

epoch 2
average train loss = -1169.116943    	average train batch reward = 0.693
validation accuracy = 0.278		average validation NDCG = 0.823

epoch 3
average train loss = -2948.583252    	average train batch reward = 0.715
validation accuracy = 0.252		average validation NDCG = 0.832

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -64.875160    	average train batch reward = 0.590
validation accuracy = 0.174		average validation NDCG = 0.754

epoch 2
average train loss = -624.773560    	average train batch reward = 0.641
validation accuracy = 0.256		average validation NDCG = 0.762

epoch 3
average train loss = -2225.252197    	average train batch reward = 0.648
validation accuracy = 0.252		average validation NDCG = 0.764

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -148.130875    	average train batch reward = 0.620
validation accuracy = 0.254		average validation NDCG = 0.793

epoch 2
average train loss = -1742.148438    	average train batch reward = 0.687
validation accuracy = 0.333		average validation NDCG = 0.785

epoch 3
average train loss = -6806.794434    	average train batch reward = 0.685
validation accuracy = 0.352		average validation NDCG = 0.795

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1495498.250000    	average train batch reward = 0.607
validation accuracy = 0.264		average validation NDCG = 0.727

epoch 2
average train loss = -33356840.000000    	average train batch reward = 0.627
validation accuracy = 0.196		average validation NDCG = 0.740

epoch 3
average train loss = -49763992.000000    	average train batch reward = 0.628
validation accuracy = 0.222		average validation NDCG = 0.742

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2334667.750000    	average train batch reward = 0.564
validation accuracy = 0.092		average validation NDCG = 0.694

epoch 2
average train loss = -10521578.000000    	average train batch reward = 0.575
validation accuracy = 0.092		average validation NDCG = 0.697

epoch 3
average train loss = -54621632.000000    	average train batch reward = 0.582
validation accuracy = 0.108		average validation NDCG = 0.729

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 6020.464844    	average train batch reward = 0.553
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 2
average train loss = 0.000000    	average train batch reward = 0.553
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 3
average train loss = 0.000000    	average train batch reward = 0.552
validation accuracy = 0.096		average validation NDCG = 0.672

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.002074    	average train batch reward = 0.553
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 2
average train loss = 0.000000    	average train batch reward = 0.552
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 3
average train loss = 0.000000    	average train batch reward = 0.552
validation accuracy = 0.096		average validation NDCG = 0.672

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 2990.153076    	average train batch reward = 0.552
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 2
average train loss = 0.000000    	average train batch reward = 0.553
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 3
average train loss = 0.000000    	average train batch reward = 0.553
validation accuracy = 0.096		average validation NDCG = 0.672

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -544993.812500    	average train batch reward = 0.572
validation accuracy = 0.097		average validation NDCG = 0.693

epoch 2
average train loss = -10191001.000000    	average train batch reward = 0.581
validation accuracy = 0.141		average validation NDCG = 0.701

epoch 3
average train loss = -24669948.000000    	average train batch reward = 0.584
validation accuracy = 0.154		average validation NDCG = 0.702

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -116530.859375    	average train batch reward = 0.583
validation accuracy = 0.102		average validation NDCG = 0.703

epoch 2
average train loss = -2211916.750000    	average train batch reward = 0.601
validation accuracy = 0.184		average validation NDCG = 0.723

epoch 3
average train loss = -10279509.000000    	average train batch reward = 0.607
validation accuracy = 0.187		average validation NDCG = 0.724

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1114651.750000    	average train batch reward = 0.579
validation accuracy = 0.096		average validation NDCG = 0.703

epoch 2
average train loss = -11071439.000000    	average train batch reward = 0.586
validation accuracy = 0.096		average validation NDCG = 0.703

epoch 3
average train loss = -15916111.000000    	average train batch reward = 0.587
validation accuracy = 0.096		average validation NDCG = 0.703

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -199185.781250    	average train batch reward = 0.582
validation accuracy = 0.188		average validation NDCG = 0.720

epoch 2
average train loss = -2097603.250000    	average train batch reward = 0.607
validation accuracy = 0.188		average validation NDCG = 0.728

epoch 3
average train loss = -10802600.000000    	average train batch reward = 0.610
validation accuracy = 0.192		average validation NDCG = 0.727

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -97863.078125    	average train batch reward = 0.594
validation accuracy = 0.156		average validation NDCG = 0.742

epoch 2
average train loss = -2997571.750000    	average train batch reward = 0.632
validation accuracy = 0.154		average validation NDCG = 0.753

epoch 3
average train loss = -10963756.000000    	average train batch reward = 0.635
validation accuracy = 0.196		average validation NDCG = 0.742

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -445.640625    	average train batch reward = 0.575
validation accuracy = 0.098		average validation NDCG = 0.698

epoch 2
average train loss = -2724891.500000    	average train batch reward = 0.581
validation accuracy = 0.098		average validation NDCG = 0.699

epoch 3
average train loss = -9653806.000000    	average train batch reward = 0.579
validation accuracy = 0.098		average validation NDCG = 0.697

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1867743.000000    	average train batch reward = 0.617
validation accuracy = 0.172		average validation NDCG = 0.726

epoch 2
average train loss = -15713251.000000    	average train batch reward = 0.634
validation accuracy = 0.193		average validation NDCG = 0.752

epoch 3
average train loss = -42094300.000000    	average train batch reward = 0.633
validation accuracy = 0.185		average validation NDCG = 0.747

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -5380.520508    	average train batch reward = 0.611
validation accuracy = 0.239		average validation NDCG = 0.762

epoch 2
average train loss = -29036.160156    	average train batch reward = 0.644
validation accuracy = 0.280		average validation NDCG = 0.776

epoch 3
average train loss = -203998.468750    	average train batch reward = 0.676
validation accuracy = 0.250		average validation NDCG = 0.797

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2025.840088    	average train batch reward = 0.584
validation accuracy = 0.226		average validation NDCG = 0.754

epoch 2
average train loss = -70686.109375    	average train batch reward = 0.670
validation accuracy = 0.323		average validation NDCG = 0.801

epoch 3
average train loss = -216757.296875    	average train batch reward = 0.691
validation accuracy = 0.221		average validation NDCG = 0.807

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -4280.556152    	average train batch reward = 0.580
validation accuracy = 0.122		average validation NDCG = 0.710

epoch 2
average train loss = -33228.054688    	average train batch reward = 0.598
validation accuracy = 0.149		average validation NDCG = 0.707

epoch 3
average train loss = -133812.781250    	average train batch reward = 0.592
validation accuracy = 0.124		average validation NDCG = 0.709

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -5485.811523    	average train batch reward = 0.587
validation accuracy = 0.236		average validation NDCG = 0.719

epoch 2
average train loss = -131211.562500    	average train batch reward = 0.641
validation accuracy = 0.163		average validation NDCG = 0.782

epoch 3
average train loss = -643936.187500    	average train batch reward = 0.663
validation accuracy = 0.179		average validation NDCG = 0.767

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -5941.973633    	average train batch reward = 0.601
validation accuracy = 0.101		average validation NDCG = 0.758

epoch 2
average train loss = -74376.250000    	average train batch reward = 0.651
validation accuracy = 0.147		average validation NDCG = 0.782

epoch 3
average train loss = -177545.109375    	average train batch reward = 0.665
validation accuracy = 0.142		average validation NDCG = 0.797

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
Hyperparameters:
k = 9
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2b6f2527e0c8>
Reward function = <function ndcg_full at 0x2b6f2527e140>
Greedy action = <function sample at 0x2b6f1e0d4758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -9605.340820    	average train batch reward = 0.602
validation accuracy = 0.098		average validation NDCG = 0.771

epoch 2
average train loss = -142479.296875    	average train batch reward = 0.680
validation accuracy = 0.276		average validation NDCG = 0.809

epoch 3
average train loss = -430045.312500    	average train batch reward = 0.690
validation accuracy = 0.340		average validation NDCG = 0.805

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.5), (0.0001, 50, 1.5)], which got scores of [0.88527787565074401, 0.85860319544033137, 0.85552763784810959]
========
2017-06-30 14:54:51
