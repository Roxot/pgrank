2017-06-30 08:50:36
Finding best parameters for k = 10
=========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.007895    	average train batch reward = 0.509
validation accuracy = 0.083		average validation NDCG = 0.659

epoch 2
average train loss = 0.026020    	average train batch reward = 0.511
validation accuracy = 0.084		average validation NDCG = 0.659

epoch 3
average train loss = -0.084651    	average train batch reward = 0.510
validation accuracy = 0.084		average validation NDCG = 0.659

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.0), (), ()], which got scores of [0.65882730278463408, -1, -1]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.092085    	average train batch reward = 0.530
validation accuracy = 0.081		average validation NDCG = 0.664

epoch 2
average train loss = 0.002288    	average train batch reward = 0.531
validation accuracy = 0.081		average validation NDCG = 0.664

epoch 3
average train loss = 0.090941    	average train batch reward = 0.529
validation accuracy = 0.082		average validation NDCG = 0.664

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 50, 0.0), ()], which got scores of [0.6641737565846918, 0.65882730278463408, -1]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.057917    	average train batch reward = 0.525
validation accuracy = 0.086		average validation NDCG = 0.672

epoch 2
average train loss = 0.061796    	average train batch reward = 0.527
validation accuracy = 0.086		average validation NDCG = 0.672

epoch 3
average train loss = 0.032692    	average train batch reward = 0.527
validation accuracy = 0.087		average validation NDCG = 0.672

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.2), (9.9999999999999995e-08, 50, 0.05), ()], which got scores of [0.67212141684932114, 0.6641737565846918, -1]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.016400    	average train batch reward = 0.535
validation accuracy = 0.115		average validation NDCG = 0.665

epoch 2
average train loss = 0.042038    	average train batch reward = 0.536
validation accuracy = 0.115		average validation NDCG = 0.665

epoch 3
average train loss = -0.045921    	average train batch reward = 0.536
validation accuracy = 0.116		average validation NDCG = 0.666

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.2), (9.9999999999999995e-08, 50, 0.5), (9.9999999999999995e-08, 50, 0.05)], which got scores of [0.67212141684932114, 0.6655392401617729, 0.6641737565846918]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.058352    	average train batch reward = 0.541
validation accuracy = 0.100		average validation NDCG = 0.674

epoch 2
average train loss = -0.051352    	average train batch reward = 0.543
validation accuracy = 0.100		average validation NDCG = 0.674

epoch 3
average train loss = -0.092136    	average train batch reward = 0.545
validation accuracy = 0.100		average validation NDCG = 0.674

========
Currently the best setups are [(9.9999999999999995e-08, 50, 1.0), (9.9999999999999995e-08, 50, 0.2), (9.9999999999999995e-08, 50, 0.05)], which got scores of [0.67403920484434521, 0.67212141684932114, 0.6641737565846918]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.087228    	average train batch reward = 0.536
validation accuracy = 0.100		average validation NDCG = 0.672

epoch 2
average train loss = 0.070246    	average train batch reward = 0.537
validation accuracy = 0.100		average validation NDCG = 0.672

epoch 3
average train loss = 0.022836    	average train batch reward = 0.537
validation accuracy = 0.100		average validation NDCG = 0.672

========
Currently the best setups are [(9.9999999999999995e-08, 50, 1.0), (9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.67403920484434521, 0.67234654434647301, 0.67212141684932114]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.018180    	average train batch reward = 0.534
validation accuracy = 0.082		average validation NDCG = 0.666

epoch 2
average train loss = -0.101079    	average train batch reward = 0.533
validation accuracy = 0.082		average validation NDCG = 0.666

epoch 3
average train loss = 0.056187    	average train batch reward = 0.534
validation accuracy = 0.082		average validation NDCG = 0.666

========
Currently the best setups are [(9.9999999999999995e-08, 50, 1.0), (9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.67403920484434521, 0.67234654434647301, 0.67212141684932114]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.022378    	average train batch reward = 0.524
validation accuracy = 0.089		average validation NDCG = 0.657

epoch 2
average train loss = 0.081046    	average train batch reward = 0.523
validation accuracy = 0.089		average validation NDCG = 0.657

epoch 3
average train loss = -0.018237    	average train batch reward = 0.525
validation accuracy = 0.089		average validation NDCG = 0.658

========
Currently the best setups are [(9.9999999999999995e-08, 50, 1.0), (9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.67403920484434521, 0.67234654434647301, 0.67212141684932114]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.042786    	average train batch reward = 0.530
validation accuracy = 0.097		average validation NDCG = 0.669

epoch 2
average train loss = 0.027805    	average train batch reward = 0.533
validation accuracy = 0.097		average validation NDCG = 0.669

epoch 3
average train loss = 0.024893    	average train batch reward = 0.534
validation accuracy = 0.097		average validation NDCG = 0.669

========
Currently the best setups are [(9.9999999999999995e-08, 50, 1.0), (9.9999999999999995e-08, 50, 1.5), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.67403920484434521, 0.67234654434647301, 0.67212141684932114]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.036694    	average train batch reward = 0.540
validation accuracy = 0.101		average validation NDCG = 0.684

epoch 2
average train loss = -0.024406    	average train batch reward = 0.542
validation accuracy = 0.101		average validation NDCG = 0.684

epoch 3
average train loss = -0.009541    	average train batch reward = 0.543
validation accuracy = 0.101		average validation NDCG = 0.684

========
Currently the best setups are [(9.9999999999999995e-08, 512, 0.5), (9.9999999999999995e-08, 50, 1.0), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.68390965743343879, 0.67403920484434521, 0.67212141684932114]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.061978    	average train batch reward = 0.532
validation accuracy = 0.095		average validation NDCG = 0.665

epoch 2
average train loss = -0.070023    	average train batch reward = 0.532
validation accuracy = 0.095		average validation NDCG = 0.665

epoch 3
average train loss = 0.061560    	average train batch reward = 0.533
validation accuracy = 0.095		average validation NDCG = 0.665

========
Currently the best setups are [(9.9999999999999995e-08, 512, 0.5), (9.9999999999999995e-08, 50, 1.0), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.68390965743343879, 0.67403920484434521, 0.67212141684932114]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.087211    	average train batch reward = 0.540
validation accuracy = 0.121		average validation NDCG = 0.674

epoch 2
average train loss = -0.016206    	average train batch reward = 0.539
validation accuracy = 0.121		average validation NDCG = 0.674

epoch 3
average train loss = -0.083044    	average train batch reward = 0.539
validation accuracy = 0.121		average validation NDCG = 0.674

========
Currently the best setups are [(9.9999999999999995e-08, 512, 0.5), (9.9999999999999995e-08, 512, 1.5), (9.9999999999999995e-08, 50, 1.0)], which got scores of [0.68390965743343879, 0.67442559336885299, 0.67403920484434521]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.069359    	average train batch reward = 0.556
validation accuracy = 0.158		average validation NDCG = 0.683

epoch 2
average train loss = -0.130547    	average train batch reward = 0.554
validation accuracy = 0.158		average validation NDCG = 0.683

epoch 3
average train loss = -0.172665    	average train batch reward = 0.556
validation accuracy = 0.158		average validation NDCG = 0.683

========
Currently the best setups are [(9.9999999999999995e-08, 512, 0.5), (9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 512, 1.5)], which got scores of [0.68390965743343879, 0.68311759000997763, 0.67442559336885299]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.018859    	average train batch reward = 0.559
validation accuracy = 0.137		average validation NDCG = 0.683

epoch 2
average train loss = -0.078152    	average train batch reward = 0.561
validation accuracy = 0.137		average validation NDCG = 0.683

epoch 3
average train loss = -0.101834    	average train batch reward = 0.558
validation accuracy = 0.137		average validation NDCG = 0.683

========
Currently the best setups are [(9.9999999999999995e-08, 512, 0.5), (9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 5012, 0.05)], which got scores of [0.68390965743343879, 0.68311759000997763, 0.6829420368328456]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.012609    	average train batch reward = 0.559
validation accuracy = 0.099		average validation NDCG = 0.685

epoch 2
average train loss = -0.088556    	average train batch reward = 0.559
validation accuracy = 0.099		average validation NDCG = 0.685

epoch 3
average train loss = 0.004476    	average train batch reward = 0.559
validation accuracy = 0.099		average validation NDCG = 0.685

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.2), (9.9999999999999995e-08, 512, 0.5), (9.9999999999999995e-08, 5012, 0.05)], which got scores of [0.68535188330049501, 0.68390965743343879, 0.6829420368328456]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.011498    	average train batch reward = 0.533
validation accuracy = 0.065		average validation NDCG = 0.674

epoch 2
average train loss = 0.066397    	average train batch reward = 0.534
validation accuracy = 0.065		average validation NDCG = 0.674

epoch 3
average train loss = 0.154857    	average train batch reward = 0.534
validation accuracy = 0.065		average validation NDCG = 0.674

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.2), (9.9999999999999995e-08, 512, 0.5), (9.9999999999999995e-08, 5012, 0.05)], which got scores of [0.68535188330049501, 0.68390965743343879, 0.6829420368328456]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.030239    	average train batch reward = 0.543
validation accuracy = 0.090		average validation NDCG = 0.680

epoch 2
average train loss = 0.021481    	average train batch reward = 0.543
validation accuracy = 0.090		average validation NDCG = 0.680

epoch 3
average train loss = 0.039569    	average train batch reward = 0.543
validation accuracy = 0.090		average validation NDCG = 0.680

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 0.2), (9.9999999999999995e-08, 512, 0.5), (9.9999999999999995e-08, 5012, 0.05)], which got scores of [0.68535188330049501, 0.68390965743343879, 0.6829420368328456]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.023897    	average train batch reward = 0.551
validation accuracy = 0.080		average validation NDCG = 0.686

epoch 2
average train loss = 0.060956    	average train batch reward = 0.554
validation accuracy = 0.080		average validation NDCG = 0.686

epoch 3
average train loss = 0.103241    	average train batch reward = 0.553
validation accuracy = 0.080		average validation NDCG = 0.686

========
Currently the best setups are [(9.9999999999999995e-08, 5012, 1.5), (9.9999999999999995e-08, 5012, 0.2), (9.9999999999999995e-08, 5012, 0.05)], which got scores of [0.68594131549481496, 0.68535188330049501, 0.6829420368328456]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.047685    	average train batch reward = 0.597
validation accuracy = 0.132		average validation NDCG = 0.712

epoch 2
average train loss = -0.084116    	average train batch reward = 0.602
validation accuracy = 0.141		average validation NDCG = 0.715

epoch 3
average train loss = -0.083666    	average train batch reward = 0.605
validation accuracy = 0.148		average validation NDCG = 0.718

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-08, 5012, 1.5), (9.9999999999999995e-08, 5012, 0.05)], which got scores of [0.71797194343153092, 0.68594131549481496, 0.6829420368328456]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.063472    	average train batch reward = 0.552
validation accuracy = 0.121		average validation NDCG = 0.681

epoch 2
average train loss = -0.088565    	average train batch reward = 0.555
validation accuracy = 0.127		average validation NDCG = 0.683

epoch 3
average train loss = -0.105738    	average train batch reward = 0.559
validation accuracy = 0.131		average validation NDCG = 0.686

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-08, 5012, 1.5), (9.9999999999999995e-07, 50, 0.05)], which got scores of [0.71797194343153092, 0.68594131549481496, 0.68563754538277188]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.091058    	average train batch reward = 0.563
validation accuracy = 0.104		average validation NDCG = 0.694

epoch 2
average train loss = -0.047668    	average train batch reward = 0.568
validation accuracy = 0.110		average validation NDCG = 0.696

epoch 3
average train loss = 0.044956    	average train batch reward = 0.570
validation accuracy = 0.117		average validation NDCG = 0.699

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 50, 0.2), (9.9999999999999995e-08, 5012, 1.5)], which got scores of [0.71797194343153092, 0.6986025393495765, 0.68594131549481496]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.164511    	average train batch reward = 0.566
validation accuracy = 0.168		average validation NDCG = 0.690

epoch 2
average train loss = -0.167451    	average train batch reward = 0.569
validation accuracy = 0.173		average validation NDCG = 0.692

epoch 3
average train loss = -0.156850    	average train batch reward = 0.574
validation accuracy = 0.178		average validation NDCG = 0.694

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 50, 0.2), (9.9999999999999995e-07, 50, 0.5)], which got scores of [0.71797194343153092, 0.6986025393495765, 0.69384133167510376]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.049393    	average train batch reward = 0.558
validation accuracy = 0.104		average validation NDCG = 0.686

epoch 2
average train loss = -0.119466    	average train batch reward = 0.563
validation accuracy = 0.107		average validation NDCG = 0.689

epoch 3
average train loss = -0.087960    	average train batch reward = 0.566
validation accuracy = 0.111		average validation NDCG = 0.691

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 50, 0.2), (9.9999999999999995e-07, 50, 0.5)], which got scores of [0.71797194343153092, 0.6986025393495765, 0.69384133167510376]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.070501    	average train batch reward = 0.524
validation accuracy = 0.096		average validation NDCG = 0.665

epoch 2
average train loss = 0.045097    	average train batch reward = 0.526
validation accuracy = 0.102		average validation NDCG = 0.667

epoch 3
average train loss = -0.078380    	average train batch reward = 0.529
validation accuracy = 0.109		average validation NDCG = 0.669

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 50, 0.2), (9.9999999999999995e-07, 50, 0.5)], which got scores of [0.71797194343153092, 0.6986025393495765, 0.69384133167510376]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.088104    	average train batch reward = 0.574
validation accuracy = 0.138		average validation NDCG = 0.688

epoch 2
average train loss = -0.014921    	average train batch reward = 0.576
validation accuracy = 0.140		average validation NDCG = 0.689

epoch 3
average train loss = 0.013359    	average train batch reward = 0.574
validation accuracy = 0.142		average validation NDCG = 0.689

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 50, 0.2), (9.9999999999999995e-07, 50, 0.5)], which got scores of [0.71797194343153092, 0.6986025393495765, 0.69384133167510376]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.009184    	average train batch reward = 0.512
validation accuracy = 0.057		average validation NDCG = 0.656

epoch 2
average train loss = 0.079658    	average train batch reward = 0.510
validation accuracy = 0.057		average validation NDCG = 0.656

epoch 3
average train loss = 0.115707    	average train batch reward = 0.513
validation accuracy = 0.058		average validation NDCG = 0.656

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 50, 0.2), (9.9999999999999995e-07, 50, 0.5)], which got scores of [0.71797194343153092, 0.6986025393495765, 0.69384133167510376]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.001771    	average train batch reward = 0.534
validation accuracy = 0.117		average validation NDCG = 0.669

epoch 2
average train loss = 0.009017    	average train batch reward = 0.536
validation accuracy = 0.118		average validation NDCG = 0.670

epoch 3
average train loss = 0.070622    	average train batch reward = 0.535
validation accuracy = 0.119		average validation NDCG = 0.670

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 50, 0.2), (9.9999999999999995e-07, 50, 0.5)], which got scores of [0.71797194343153092, 0.6986025393495765, 0.69384133167510376]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.043206    	average train batch reward = 0.533
validation accuracy = 0.091		average validation NDCG = 0.672

epoch 2
average train loss = -0.029712    	average train batch reward = 0.536
validation accuracy = 0.092		average validation NDCG = 0.673

epoch 3
average train loss = -0.030292    	average train batch reward = 0.537
validation accuracy = 0.093		average validation NDCG = 0.673

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 50, 0.2), (9.9999999999999995e-07, 50, 0.5)], which got scores of [0.71797194343153092, 0.6986025393495765, 0.69384133167510376]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.071370    	average train batch reward = 0.519
validation accuracy = 0.080		average validation NDCG = 0.657

epoch 2
average train loss = -0.016676    	average train batch reward = 0.521
validation accuracy = 0.080		average validation NDCG = 0.657

epoch 3
average train loss = 0.151201    	average train batch reward = 0.521
validation accuracy = 0.082		average validation NDCG = 0.657

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 50, 0.2), (9.9999999999999995e-07, 50, 0.5)], which got scores of [0.71797194343153092, 0.6986025393495765, 0.69384133167510376]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.030132    	average train batch reward = 0.587
validation accuracy = 0.148		average validation NDCG = 0.703

epoch 2
average train loss = -0.144445    	average train batch reward = 0.589
validation accuracy = 0.150		average validation NDCG = 0.704

epoch 3
average train loss = -0.077571    	average train batch reward = 0.588
validation accuracy = 0.151		average validation NDCG = 0.705

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 512, 1.5), (9.9999999999999995e-07, 50, 0.2)], which got scores of [0.71797194343153092, 0.70465833134554035, 0.6986025393495765]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.206677    	average train batch reward = 0.546
validation accuracy = 0.120		average validation NDCG = 0.678

epoch 2
average train loss = 0.003916    	average train batch reward = 0.547
validation accuracy = 0.121		average validation NDCG = 0.678

epoch 3
average train loss = -0.182690    	average train batch reward = 0.546
validation accuracy = 0.121		average validation NDCG = 0.678

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 512, 1.5), (9.9999999999999995e-07, 50, 0.2)], which got scores of [0.71797194343153092, 0.70465833134554035, 0.6986025393495765]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.061052    	average train batch reward = 0.546
validation accuracy = 0.119		average validation NDCG = 0.676

epoch 2
average train loss = -0.021827    	average train batch reward = 0.545
validation accuracy = 0.119		average validation NDCG = 0.676

epoch 3
average train loss = -0.082698    	average train batch reward = 0.546
validation accuracy = 0.120		average validation NDCG = 0.676

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 512, 1.5), (9.9999999999999995e-07, 50, 0.2)], which got scores of [0.71797194343153092, 0.70465833134554035, 0.6986025393495765]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.072236    	average train batch reward = 0.513
validation accuracy = 0.077		average validation NDCG = 0.651

epoch 2
average train loss = 0.058108    	average train batch reward = 0.512
validation accuracy = 0.077		average validation NDCG = 0.651

epoch 3
average train loss = 0.019375    	average train batch reward = 0.512
validation accuracy = 0.077		average validation NDCG = 0.651

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 512, 1.5), (9.9999999999999995e-07, 50, 0.2)], which got scores of [0.71797194343153092, 0.70465833134554035, 0.6986025393495765]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.098487    	average train batch reward = 0.511
validation accuracy = 0.076		average validation NDCG = 0.646

epoch 2
average train loss = 0.104344    	average train batch reward = 0.511
validation accuracy = 0.075		average validation NDCG = 0.646

epoch 3
average train loss = 0.037334    	average train batch reward = 0.510
validation accuracy = 0.075		average validation NDCG = 0.646

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 512, 1.5), (9.9999999999999995e-07, 50, 0.2)], which got scores of [0.71797194343153092, 0.70465833134554035, 0.6986025393495765]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.004116    	average train batch reward = 0.520
validation accuracy = 0.062		average validation NDCG = 0.656

epoch 2
average train loss = 0.063643    	average train batch reward = 0.521
validation accuracy = 0.062		average validation NDCG = 0.656

epoch 3
average train loss = -0.036379    	average train batch reward = 0.521
validation accuracy = 0.062		average validation NDCG = 0.656

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 512, 1.5), (9.9999999999999995e-07, 50, 0.2)], which got scores of [0.71797194343153092, 0.70465833134554035, 0.6986025393495765]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.045702    	average train batch reward = 0.532
validation accuracy = 0.106		average validation NDCG = 0.668

epoch 2
average train loss = 0.032985    	average train batch reward = 0.534
validation accuracy = 0.106		average validation NDCG = 0.668

epoch 3
average train loss = -0.050804    	average train batch reward = 0.532
validation accuracy = 0.106		average validation NDCG = 0.669

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 512, 1.5), (9.9999999999999995e-07, 50, 0.2)], which got scores of [0.71797194343153092, 0.70465833134554035, 0.6986025393495765]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.115744    	average train batch reward = 0.537
validation accuracy = 0.119		average validation NDCG = 0.685

epoch 2
average train loss = -0.343417    	average train batch reward = 0.567
validation accuracy = 0.126		average validation NDCG = 0.707

epoch 3
average train loss = -0.407996    	average train batch reward = 0.589
validation accuracy = 0.147		average validation NDCG = 0.728

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.0), (9.9999999999999995e-07, 50, 0.0), (9.9999999999999995e-07, 50, 0.2)], which got scores of [0.72841930830611545, 0.71797194343153092, 0.6986025393495765]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.173400    	average train batch reward = 0.545
validation accuracy = 0.109		average validation NDCG = 0.686

epoch 2
average train loss = -0.643916    	average train batch reward = 0.566
validation accuracy = 0.111		average validation NDCG = 0.699

epoch 3
average train loss = -0.744320    	average train batch reward = 0.588
validation accuracy = 0.128		average validation NDCG = 0.716

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.0), (9.9999999999999995e-07, 50, 0.0), (1.0000000000000001e-05, 50, 0.05)], which got scores of [0.72841930830611545, 0.71797194343153092, 0.71611677871939461]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.058199    	average train batch reward = 0.537
validation accuracy = 0.106		average validation NDCG = 0.674

epoch 2
average train loss = -0.080462    	average train batch reward = 0.560
validation accuracy = 0.142		average validation NDCG = 0.691

epoch 3
average train loss = -0.469551    	average train batch reward = 0.587
validation accuracy = 0.188		average validation NDCG = 0.714

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.0), (9.9999999999999995e-07, 50, 0.0), (1.0000000000000001e-05, 50, 0.05)], which got scores of [0.72841930830611545, 0.71797194343153092, 0.71611677871939461]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.184264    	average train batch reward = 0.550
validation accuracy = 0.122		average validation NDCG = 0.686

epoch 2
average train loss = -0.331656    	average train batch reward = 0.573
validation accuracy = 0.153		average validation NDCG = 0.705

epoch 3
average train loss = -0.357130    	average train batch reward = 0.594
validation accuracy = 0.187		average validation NDCG = 0.722

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 0.5), (9.9999999999999995e-07, 50, 0.0)], which got scores of [0.72841930830611545, 0.7224969156937695, 0.71797194343153092]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.063700    	average train batch reward = 0.549
validation accuracy = 0.155		average validation NDCG = 0.683

epoch 2
average train loss = -0.330797    	average train batch reward = 0.578
validation accuracy = 0.200		average validation NDCG = 0.709

epoch 3
average train loss = -0.478954    	average train batch reward = 0.605
validation accuracy = 0.223		average validation NDCG = 0.734

========
Currently the best setups are [(1.0000000000000001e-05, 50, 1.0), (1.0000000000000001e-05, 50, 0.0), (9.9999999999999995e-07, 50, 0.0)], which got scores of [0.73368700609777482, 0.72841930830611545, 0.71797194343153092]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.406821    	average train batch reward = 0.548
validation accuracy = 0.148		average validation NDCG = 0.697

epoch 2
average train loss = -0.200120    	average train batch reward = 0.572
validation accuracy = 0.176		average validation NDCG = 0.714

epoch 3
average train loss = -0.477178    	average train batch reward = 0.601
validation accuracy = 0.215		average validation NDCG = 0.732

========
Currently the best setups are [(1.0000000000000001e-05, 50, 1.0), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.0)], which got scores of [0.73368700609777482, 0.73205277121056578, 0.72841930830611545]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.092024    	average train batch reward = 0.546
validation accuracy = 0.138		average validation NDCG = 0.676

epoch 2
average train loss = -0.000199    	average train batch reward = 0.553
validation accuracy = 0.138		average validation NDCG = 0.680

epoch 3
average train loss = -0.203912    	average train batch reward = 0.559
validation accuracy = 0.150		average validation NDCG = 0.686

========
Currently the best setups are [(1.0000000000000001e-05, 50, 1.0), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.0)], which got scores of [0.73368700609777482, 0.73205277121056578, 0.72841930830611545]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.042401    	average train batch reward = 0.557
validation accuracy = 0.142		average validation NDCG = 0.692

epoch 2
average train loss = -0.232151    	average train batch reward = 0.567
validation accuracy = 0.166		average validation NDCG = 0.701

epoch 3
average train loss = -0.220559    	average train batch reward = 0.578
validation accuracy = 0.191		average validation NDCG = 0.710

========
Currently the best setups are [(1.0000000000000001e-05, 50, 1.0), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.0)], which got scores of [0.73368700609777482, 0.73205277121056578, 0.72841930830611545]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.101679    	average train batch reward = 0.579
validation accuracy = 0.137		average validation NDCG = 0.711

epoch 2
average train loss = -0.114381    	average train batch reward = 0.590
validation accuracy = 0.160		average validation NDCG = 0.718

epoch 3
average train loss = -0.178555    	average train batch reward = 0.599
validation accuracy = 0.185		average validation NDCG = 0.724

========
Currently the best setups are [(1.0000000000000001e-05, 50, 1.0), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.0)], which got scores of [0.73368700609777482, 0.73205277121056578, 0.72841930830611545]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.051939    	average train batch reward = 0.531
validation accuracy = 0.091		average validation NDCG = 0.669

epoch 2
average train loss = 0.055555    	average train batch reward = 0.536
validation accuracy = 0.097		average validation NDCG = 0.674

epoch 3
average train loss = 0.015032    	average train batch reward = 0.541
validation accuracy = 0.104		average validation NDCG = 0.677

========
Currently the best setups are [(1.0000000000000001e-05, 50, 1.0), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.0)], which got scores of [0.73368700609777482, 0.73205277121056578, 0.72841930830611545]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.150611    	average train batch reward = 0.548
validation accuracy = 0.164		average validation NDCG = 0.685

epoch 2
average train loss = -0.167612    	average train batch reward = 0.560
validation accuracy = 0.173		average validation NDCG = 0.692

epoch 3
average train loss = -0.197867    	average train batch reward = 0.565
validation accuracy = 0.191		average validation NDCG = 0.697

========
Currently the best setups are [(1.0000000000000001e-05, 50, 1.0), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.0)], which got scores of [0.73368700609777482, 0.73205277121056578, 0.72841930830611545]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.179840    	average train batch reward = 0.545
validation accuracy = 0.137		average validation NDCG = 0.680

epoch 2
average train loss = -0.220723    	average train batch reward = 0.554
validation accuracy = 0.152		average validation NDCG = 0.688

epoch 3
average train loss = -0.172231    	average train batch reward = 0.565
validation accuracy = 0.166		average validation NDCG = 0.696

========
Currently the best setups are [(1.0000000000000001e-05, 50, 1.0), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.0)], which got scores of [0.73368700609777482, 0.73205277121056578, 0.72841930830611545]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.128073    	average train batch reward = 0.576
validation accuracy = 0.137		average validation NDCG = 0.705

epoch 2
average train loss = -0.147276    	average train batch reward = 0.579
validation accuracy = 0.141		average validation NDCG = 0.708

epoch 3
average train loss = -0.167428    	average train batch reward = 0.579
validation accuracy = 0.146		average validation NDCG = 0.710

========
Currently the best setups are [(1.0000000000000001e-05, 50, 1.0), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.0)], which got scores of [0.73368700609777482, 0.73205277121056578, 0.72841930830611545]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.059834    	average train batch reward = 0.549
validation accuracy = 0.093		average validation NDCG = 0.671

epoch 2
average train loss = 0.061846    	average train batch reward = 0.553
validation accuracy = 0.094		average validation NDCG = 0.673

epoch 3
average train loss = -0.006027    	average train batch reward = 0.557
validation accuracy = 0.094		average validation NDCG = 0.675

========
Currently the best setups are [(1.0000000000000001e-05, 50, 1.0), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.0)], which got scores of [0.73368700609777482, 0.73205277121056578, 0.72841930830611545]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.022201    	average train batch reward = 0.544
validation accuracy = 0.079		average validation NDCG = 0.673

epoch 2
average train loss = 0.145412    	average train batch reward = 0.546
validation accuracy = 0.081		average validation NDCG = 0.675

epoch 3
average train loss = -0.006018    	average train batch reward = 0.551
validation accuracy = 0.084		average validation NDCG = 0.677

========
Currently the best setups are [(1.0000000000000001e-05, 50, 1.0), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.0)], which got scores of [0.73368700609777482, 0.73205277121056578, 0.72841930830611545]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.126228    	average train batch reward = 0.565
validation accuracy = 0.119		average validation NDCG = 0.692

epoch 2
average train loss = 0.032330    	average train batch reward = 0.570
validation accuracy = 0.123		average validation NDCG = 0.695

epoch 3
average train loss = -0.051131    	average train batch reward = 0.574
validation accuracy = 0.126		average validation NDCG = 0.699

========
Currently the best setups are [(1.0000000000000001e-05, 50, 1.0), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.0)], which got scores of [0.73368700609777482, 0.73205277121056578, 0.72841930830611545]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.063025    	average train batch reward = 0.546
validation accuracy = 0.096		average validation NDCG = 0.679

epoch 2
average train loss = 0.080780    	average train batch reward = 0.546
validation accuracy = 0.100		average validation NDCG = 0.680

epoch 3
average train loss = -0.031582    	average train batch reward = 0.549
validation accuracy = 0.103		average validation NDCG = 0.682

========
Currently the best setups are [(1.0000000000000001e-05, 50, 1.0), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.0)], which got scores of [0.73368700609777482, 0.73205277121056578, 0.72841930830611545]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.106925    	average train batch reward = 0.531
validation accuracy = 0.060		average validation NDCG = 0.663

epoch 2
average train loss = 0.055503    	average train batch reward = 0.530
validation accuracy = 0.064		average validation NDCG = 0.665

epoch 3
average train loss = 0.078282    	average train batch reward = 0.532
validation accuracy = 0.066		average validation NDCG = 0.666

========
Currently the best setups are [(1.0000000000000001e-05, 50, 1.0), (1.0000000000000001e-05, 50, 1.5), (1.0000000000000001e-05, 50, 0.0)], which got scores of [0.73368700609777482, 0.73205277121056578, 0.72841930830611545]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1.070357    	average train batch reward = 0.633
validation accuracy = 0.389		average validation NDCG = 0.806

epoch 2
average train loss = -3.532228    	average train batch reward = 0.702
validation accuracy = 0.447		average validation NDCG = 0.828

epoch 3
average train loss = -6.502163    	average train batch reward = 0.714
validation accuracy = 0.456		average validation NDCG = 0.841

========
Currently the best setups are [(0.0001, 50, 0.0), (1.0000000000000001e-05, 50, 1.0), (1.0000000000000001e-05, 50, 0.0)], which got scores of [0.84069806888538723, 0.73368700609777482, 0.72841930830611545]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.747673    	average train batch reward = 0.601
validation accuracy = 0.295		average validation NDCG = 0.785

epoch 2
average train loss = -2.867270    	average train batch reward = 0.733
validation accuracy = 0.345		average validation NDCG = 0.871

epoch 3
average train loss = -4.643652    	average train batch reward = 0.763
validation accuracy = 0.458		average validation NDCG = 0.884

========
Currently the best setups are [(0.0001, 50, 0.05), (0.0001, 50, 0.0), (1.0000000000000001e-05, 50, 0.0)], which got scores of [0.88422439380932294, 0.84069806888538723, 0.72841930830611545]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1.279997    	average train batch reward = 0.621
validation accuracy = 0.380		average validation NDCG = 0.797

epoch 2
average train loss = -2.877783    	average train batch reward = 0.690
validation accuracy = 0.432		average validation NDCG = 0.831

epoch 3
average train loss = -2.665010    	average train batch reward = 0.713
validation accuracy = 0.450		average validation NDCG = 0.853

========
Currently the best setups are [(0.0001, 50, 0.05), (0.0001, 50, 0.2), (0.0001, 50, 0.0)], which got scores of [0.88422439380932294, 0.85270570659681277, 0.84069806888538723]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.593746    	average train batch reward = 0.613
validation accuracy = 0.398		average validation NDCG = 0.811

epoch 2
average train loss = -2.113999    	average train batch reward = 0.721
validation accuracy = 0.428		average validation NDCG = 0.849

epoch 3
average train loss = -3.834201    	average train batch reward = 0.740
validation accuracy = 0.477		average validation NDCG = 0.873

========
Currently the best setups are [(0.0001, 50, 0.05), (0.0001, 50, 0.5), (0.0001, 50, 0.2)], which got scores of [0.88422439380932294, 0.87321095464835197, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.999085    	average train batch reward = 0.670
validation accuracy = 0.431		average validation NDCG = 0.849

epoch 2
average train loss = -3.530159    	average train batch reward = 0.758
validation accuracy = 0.518		average validation NDCG = 0.881

epoch 3
average train loss = -3.501738    	average train batch reward = 0.775
validation accuracy = 0.552		average validation NDCG = 0.901

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.767164    	average train batch reward = 0.602
validation accuracy = 0.209		average validation NDCG = 0.753

epoch 2
average train loss = -2.222772    	average train batch reward = 0.664
validation accuracy = 0.343		average validation NDCG = 0.818

epoch 3
average train loss = -5.100321    	average train batch reward = 0.706
validation accuracy = 0.455		average validation NDCG = 0.827

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.290920    	average train batch reward = 0.564
validation accuracy = 0.227		average validation NDCG = 0.721

epoch 2
average train loss = -0.826364    	average train batch reward = 0.609
validation accuracy = 0.271		average validation NDCG = 0.752

epoch 3
average train loss = -0.827064    	average train batch reward = 0.629
validation accuracy = 0.278		average validation NDCG = 0.769

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.201305    	average train batch reward = 0.563
validation accuracy = 0.183		average validation NDCG = 0.727

epoch 2
average train loss = -1.270601    	average train batch reward = 0.631
validation accuracy = 0.278		average validation NDCG = 0.764

epoch 3
average train loss = -2.005586    	average train batch reward = 0.658
validation accuracy = 0.298		average validation NDCG = 0.791

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.391934    	average train batch reward = 0.611
validation accuracy = 0.299		average validation NDCG = 0.757

epoch 2
average train loss = -0.735367    	average train batch reward = 0.663
validation accuracy = 0.357		average validation NDCG = 0.799

epoch 3
average train loss = -1.035369    	average train batch reward = 0.705
validation accuracy = 0.393		average validation NDCG = 0.829

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.441178    	average train batch reward = 0.560
validation accuracy = 0.142		average validation NDCG = 0.712

epoch 2
average train loss = -1.212755    	average train batch reward = 0.622
validation accuracy = 0.230		average validation NDCG = 0.766

epoch 3
average train loss = -2.171924    	average train batch reward = 0.695
validation accuracy = 0.321		average validation NDCG = 0.816

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.240801    	average train batch reward = 0.577
validation accuracy = 0.226		average validation NDCG = 0.747

epoch 2
average train loss = -1.293453    	average train batch reward = 0.673
validation accuracy = 0.388		average validation NDCG = 0.801

epoch 3
average train loss = -1.661682    	average train batch reward = 0.705
validation accuracy = 0.409		average validation NDCG = 0.818

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.261333    	average train batch reward = 0.577
validation accuracy = 0.193		average validation NDCG = 0.737

epoch 2
average train loss = -0.955135    	average train batch reward = 0.630
validation accuracy = 0.292		average validation NDCG = 0.767

epoch 3
average train loss = -1.461289    	average train batch reward = 0.668
validation accuracy = 0.301		average validation NDCG = 0.804

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.017477    	average train batch reward = 0.521
validation accuracy = 0.121		average validation NDCG = 0.664

epoch 2
average train loss = -0.216284    	average train batch reward = 0.546
validation accuracy = 0.153		average validation NDCG = 0.683

epoch 3
average train loss = -0.563864    	average train batch reward = 0.572
validation accuracy = 0.215		average validation NDCG = 0.704

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.271705    	average train batch reward = 0.571
validation accuracy = 0.132		average validation NDCG = 0.707

epoch 2
average train loss = -0.378120    	average train batch reward = 0.595
validation accuracy = 0.173		average validation NDCG = 0.726

epoch 3
average train loss = -0.493895    	average train batch reward = 0.615
validation accuracy = 0.204		average validation NDCG = 0.741

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.005609    	average train batch reward = 0.517
validation accuracy = 0.103		average validation NDCG = 0.655

epoch 2
average train loss = -0.146025    	average train batch reward = 0.534
validation accuracy = 0.127		average validation NDCG = 0.668

epoch 3
average train loss = -0.210947    	average train batch reward = 0.556
validation accuracy = 0.169		average validation NDCG = 0.682

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.047652    	average train batch reward = 0.540
validation accuracy = 0.109		average validation NDCG = 0.677

epoch 2
average train loss = -0.162675    	average train batch reward = 0.554
validation accuracy = 0.132		average validation NDCG = 0.690

epoch 3
average train loss = -0.243816    	average train batch reward = 0.578
validation accuracy = 0.162		average validation NDCG = 0.711

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.090917    	average train batch reward = 0.553
validation accuracy = 0.147		average validation NDCG = 0.693

epoch 2
average train loss = -0.237021    	average train batch reward = 0.574
validation accuracy = 0.191		average validation NDCG = 0.710

epoch 3
average train loss = -0.361464    	average train batch reward = 0.605
validation accuracy = 0.242		average validation NDCG = 0.736

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.059687    	average train batch reward = 0.590
validation accuracy = 0.145		average validation NDCG = 0.729

epoch 2
average train loss = -0.395345    	average train batch reward = 0.624
validation accuracy = 0.218		average validation NDCG = 0.749

epoch 3
average train loss = -0.561417    	average train batch reward = 0.643
validation accuracy = 0.314		average validation NDCG = 0.765

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -5.437832    	average train batch reward = 0.600
validation accuracy = 0.252		average validation NDCG = 0.735

epoch 2
average train loss = -26.732906    	average train batch reward = 0.612
validation accuracy = 0.232		average validation NDCG = 0.745

epoch 3
average train loss = -90.975945    	average train batch reward = 0.614
validation accuracy = 0.173		average validation NDCG = 0.746

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -4.430781    	average train batch reward = 0.587
validation accuracy = 0.199		average validation NDCG = 0.740

epoch 2
average train loss = -38.849632    	average train batch reward = 0.618
validation accuracy = 0.269		average validation NDCG = 0.749

epoch 3
average train loss = -140.229599    	average train batch reward = 0.621
validation accuracy = 0.266		average validation NDCG = 0.752

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -5.130624    	average train batch reward = 0.610
validation accuracy = 0.216		average validation NDCG = 0.756

epoch 2
average train loss = -63.626801    	average train batch reward = 0.657
validation accuracy = 0.205		average validation NDCG = 0.800

epoch 3
average train loss = -186.477234    	average train batch reward = 0.674
validation accuracy = 0.208		average validation NDCG = 0.795

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2.486066    	average train batch reward = 0.575
validation accuracy = 0.216		average validation NDCG = 0.728

epoch 2
average train loss = -23.335924    	average train batch reward = 0.604
validation accuracy = 0.218		average validation NDCG = 0.743

epoch 3
average train loss = -77.888428    	average train batch reward = 0.629
validation accuracy = 0.268		average validation NDCG = 0.770

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -8.159421    	average train batch reward = 0.606
validation accuracy = 0.208		average validation NDCG = 0.764

epoch 2
average train loss = -28.908943    	average train batch reward = 0.653
validation accuracy = 0.208		average validation NDCG = 0.790

epoch 3
average train loss = -79.461929    	average train batch reward = 0.670
validation accuracy = 0.311		average validation NDCG = 0.790

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -20.984451    	average train batch reward = 0.583
validation accuracy = 0.174		average validation NDCG = 0.722

epoch 2
average train loss = -114.861214    	average train batch reward = 0.604
validation accuracy = 0.227		average validation NDCG = 0.733

epoch 3
average train loss = -132.827225    	average train batch reward = 0.606
validation accuracy = 0.252		average validation NDCG = 0.739

========
Currently the best setups are [(0.0001, 50, 1.0), (0.0001, 50, 0.05), (0.0001, 50, 0.2)], which got scores of [0.901402638351818, 0.88422439380932294, 0.85270570659681277]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.964210    	average train batch reward = 0.620
validation accuracy = 0.389		average validation NDCG = 0.822

epoch 2
average train loss = -4.336489    	average train batch reward = 0.715
validation accuracy = 0.392		average validation NDCG = 0.869

epoch 3
average train loss = -13.497388    	average train batch reward = 0.762
validation accuracy = 0.485		average validation NDCG = 0.885

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2.106029    	average train batch reward = 0.622
validation accuracy = 0.306		average validation NDCG = 0.777

epoch 2
average train loss = -7.064344    	average train batch reward = 0.653
validation accuracy = 0.276		average validation NDCG = 0.817

epoch 3
average train loss = -15.389146    	average train batch reward = 0.680
validation accuracy = 0.268		average validation NDCG = 0.813

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2.589877    	average train batch reward = 0.640
validation accuracy = 0.283		average validation NDCG = 0.808

epoch 2
average train loss = -11.090204    	average train batch reward = 0.695
validation accuracy = 0.423		average validation NDCG = 0.833

epoch 3
average train loss = -17.322611    	average train batch reward = 0.715
validation accuracy = 0.514		average validation NDCG = 0.837

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1.335765    	average train batch reward = 0.619
validation accuracy = 0.352		average validation NDCG = 0.830

epoch 2
average train loss = -7.684391    	average train batch reward = 0.706
validation accuracy = 0.426		average validation NDCG = 0.852

epoch 3
average train loss = -12.205449    	average train batch reward = 0.730
validation accuracy = 0.422		average validation NDCG = 0.873

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1.472441    	average train batch reward = 0.599
validation accuracy = 0.276		average validation NDCG = 0.762

epoch 2
average train loss = -5.866924    	average train batch reward = 0.647
validation accuracy = 0.319		average validation NDCG = 0.801

epoch 3
average train loss = -13.327523    	average train batch reward = 0.681
validation accuracy = 0.385		average validation NDCG = 0.808

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2.184414    	average train batch reward = 0.590
validation accuracy = 0.215		average validation NDCG = 0.751

epoch 2
average train loss = -5.606888    	average train batch reward = 0.652
validation accuracy = 0.316		average validation NDCG = 0.804

epoch 3
average train loss = -13.564470    	average train batch reward = 0.695
validation accuracy = 0.313		average validation NDCG = 0.821

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.608999    	average train batch reward = 0.591
validation accuracy = 0.218		average validation NDCG = 0.751

epoch 2
average train loss = -1.477757    	average train batch reward = 0.644
validation accuracy = 0.274		average validation NDCG = 0.799

epoch 3
average train loss = -4.753173    	average train batch reward = 0.689
validation accuracy = 0.293		average validation NDCG = 0.823

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.243150    	average train batch reward = 0.607
validation accuracy = 0.228		average validation NDCG = 0.773

epoch 2
average train loss = -1.785413    	average train batch reward = 0.685
validation accuracy = 0.269		average validation NDCG = 0.836

epoch 3
average train loss = -4.130676    	average train batch reward = 0.739
validation accuracy = 0.354		average validation NDCG = 0.870

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.273330    	average train batch reward = 0.560
validation accuracy = 0.178		average validation NDCG = 0.731

epoch 2
average train loss = -2.069362    	average train batch reward = 0.635
validation accuracy = 0.207		average validation NDCG = 0.787

epoch 3
average train loss = -3.459025    	average train batch reward = 0.683
validation accuracy = 0.252		average validation NDCG = 0.823

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.221253    	average train batch reward = 0.538
validation accuracy = 0.206		average validation NDCG = 0.709

epoch 2
average train loss = -1.654158    	average train batch reward = 0.613
validation accuracy = 0.283		average validation NDCG = 0.765

epoch 3
average train loss = -3.666219    	average train batch reward = 0.651
validation accuracy = 0.325		average validation NDCG = 0.790

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.675913    	average train batch reward = 0.629
validation accuracy = 0.189		average validation NDCG = 0.816

epoch 2
average train loss = -3.019736    	average train batch reward = 0.716
validation accuracy = 0.325		average validation NDCG = 0.850

epoch 3
average train loss = -3.327058    	average train batch reward = 0.746
validation accuracy = 0.346		average validation NDCG = 0.878

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.374013    	average train batch reward = 0.627
validation accuracy = 0.345		average validation NDCG = 0.816

epoch 2
average train loss = -1.890807    	average train batch reward = 0.723
validation accuracy = 0.389		average validation NDCG = 0.864

epoch 3
average train loss = -3.675828    	average train batch reward = 0.758
validation accuracy = 0.488		average validation NDCG = 0.872

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -140.236969    	average train batch reward = 0.572
validation accuracy = 0.091		average validation NDCG = 0.713

epoch 2
average train loss = -1407.242310    	average train batch reward = 0.594
validation accuracy = 0.111		average validation NDCG = 0.742

epoch 3
average train loss = -6990.377930    	average train batch reward = 0.605
validation accuracy = 0.166		average validation NDCG = 0.737

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 1.055969    	average train batch reward = 0.555
validation accuracy = 0.236		average validation NDCG = 0.719

epoch 2
average train loss = -702.134766    	average train batch reward = 0.597
validation accuracy = 0.214		average validation NDCG = 0.725

epoch 3
average train loss = -3112.738525    	average train batch reward = 0.596
validation accuracy = 0.218		average validation NDCG = 0.725

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -429.148010    	average train batch reward = 0.572
validation accuracy = 0.114		average validation NDCG = 0.697

epoch 2
average train loss = -5933.913574    	average train batch reward = 0.573
validation accuracy = 0.181		average validation NDCG = 0.699

epoch 3
average train loss = -8627.123047    	average train batch reward = 0.571
validation accuracy = 0.199		average validation NDCG = 0.699

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -517.246582    	average train batch reward = 0.598
validation accuracy = 0.202		average validation NDCG = 0.728

epoch 2
average train loss = -3152.775635    	average train batch reward = 0.603
validation accuracy = 0.207		average validation NDCG = 0.726

epoch 3
average train loss = -7235.068359    	average train batch reward = 0.604
validation accuracy = 0.206		average validation NDCG = 0.727

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -434.698212    	average train batch reward = 0.586
validation accuracy = 0.186		average validation NDCG = 0.720

epoch 2
average train loss = -4855.881836    	average train batch reward = 0.600
validation accuracy = 0.202		average validation NDCG = 0.727

epoch 3
average train loss = -7050.979492    	average train batch reward = 0.601
validation accuracy = 0.193		average validation NDCG = 0.728

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -933.180298    	average train batch reward = 0.570
validation accuracy = 0.191		average validation NDCG = 0.724

epoch 2
average train loss = -6776.666504    	average train batch reward = 0.596
validation accuracy = 0.146		average validation NDCG = 0.730

epoch 3
average train loss = -13016.356445    	average train batch reward = 0.600
validation accuracy = 0.119		average validation NDCG = 0.730

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -28.820982    	average train batch reward = 0.630
validation accuracy = 0.216		average validation NDCG = 0.793

epoch 2
average train loss = -97.746162    	average train batch reward = 0.667
validation accuracy = 0.288		average validation NDCG = 0.806

epoch 3
average train loss = -181.427002    	average train batch reward = 0.663
validation accuracy = 0.330		average validation NDCG = 0.808

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -112.241959    	average train batch reward = 0.560
validation accuracy = 0.126		average validation NDCG = 0.699

epoch 2
average train loss = -1050.806274    	average train batch reward = 0.571
validation accuracy = 0.136		average validation NDCG = 0.701

epoch 3
average train loss = -1874.020142    	average train batch reward = 0.572
validation accuracy = 0.119		average validation NDCG = 0.700

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -11.836095    	average train batch reward = 0.623
validation accuracy = 0.288		average validation NDCG = 0.745

epoch 2
average train loss = -478.885956    	average train batch reward = 0.629
validation accuracy = 0.226		average validation NDCG = 0.760

epoch 3
average train loss = -909.665283    	average train batch reward = 0.630
validation accuracy = 0.275		average validation NDCG = 0.770

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -30.597921    	average train batch reward = 0.605
validation accuracy = 0.120		average validation NDCG = 0.774

epoch 2
average train loss = -320.312286    	average train batch reward = 0.641
validation accuracy = 0.312		average validation NDCG = 0.769

epoch 3
average train loss = -767.276550    	average train batch reward = 0.651
validation accuracy = 0.354		average validation NDCG = 0.781

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -55.431374    	average train batch reward = 0.614
validation accuracy = 0.189		average validation NDCG = 0.757

epoch 2
average train loss = -415.410828    	average train batch reward = 0.639
validation accuracy = 0.317		average validation NDCG = 0.774

epoch 3
average train loss = -775.617676    	average train batch reward = 0.650
validation accuracy = 0.276		average validation NDCG = 0.784

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -34.356979    	average train batch reward = 0.598
validation accuracy = 0.187		average validation NDCG = 0.733

epoch 2
average train loss = -373.628052    	average train batch reward = 0.612
validation accuracy = 0.205		average validation NDCG = 0.739

epoch 3
average train loss = -1205.942017    	average train batch reward = 0.623
validation accuracy = 0.210		average validation NDCG = 0.757

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2.739621    	average train batch reward = 0.590
validation accuracy = 0.198		average validation NDCG = 0.722

epoch 2
average train loss = -15.811706    	average train batch reward = 0.633
validation accuracy = 0.156		average validation NDCG = 0.810

epoch 3
average train loss = -41.688141    	average train batch reward = 0.696
validation accuracy = 0.149		average validation NDCG = 0.838

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -4.814349    	average train batch reward = 0.627
validation accuracy = 0.241		average validation NDCG = 0.806

epoch 2
average train loss = -19.287415    	average train batch reward = 0.687
validation accuracy = 0.239		average validation NDCG = 0.801

epoch 3
average train loss = -47.371998    	average train batch reward = 0.672
validation accuracy = 0.238		average validation NDCG = 0.794

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3.241365    	average train batch reward = 0.601
validation accuracy = 0.234		average validation NDCG = 0.756

epoch 2
average train loss = -20.322104    	average train batch reward = 0.636
validation accuracy = 0.255		average validation NDCG = 0.778

epoch 3
average train loss = -43.784950    	average train batch reward = 0.652
validation accuracy = 0.275		average validation NDCG = 0.772

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -4.877697    	average train batch reward = 0.597
validation accuracy = 0.323		average validation NDCG = 0.755

epoch 2
average train loss = -39.091976    	average train batch reward = 0.650
validation accuracy = 0.239		average validation NDCG = 0.802

epoch 3
average train loss = -77.913857    	average train batch reward = 0.678
validation accuracy = 0.248		average validation NDCG = 0.805

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3.241287    	average train batch reward = 0.592
validation accuracy = 0.222		average validation NDCG = 0.789

epoch 2
average train loss = -13.085483    	average train batch reward = 0.679
validation accuracy = 0.347		average validation NDCG = 0.828

epoch 3
average train loss = -51.040653    	average train batch reward = 0.694
validation accuracy = 0.410		average validation NDCG = 0.825

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2.252991    	average train batch reward = 0.581
validation accuracy = 0.235		average validation NDCG = 0.744

epoch 2
average train loss = -13.278459    	average train batch reward = 0.635
validation accuracy = 0.259		average validation NDCG = 0.791

epoch 3
average train loss = -33.972729    	average train batch reward = 0.676
validation accuracy = 0.253		average validation NDCG = 0.799

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -102.229271    	average train batch reward = 0.547
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 2
average train loss = 0.000000    	average train batch reward = 0.540
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 3
average train loss = 0.000000    	average train batch reward = 0.540
validation accuracy = 0.096		average validation NDCG = 0.672

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 369.457031    	average train batch reward = 0.540
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 2
average train loss = 0.000000    	average train batch reward = 0.540
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 3
average train loss = 0.000000    	average train batch reward = 0.539
validation accuracy = 0.096		average validation NDCG = 0.672

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 818.294495    	average train batch reward = 0.566
validation accuracy = 0.110		average validation NDCG = 0.695

epoch 2
average train loss = -153116.687500    	average train batch reward = 0.563
validation accuracy = 0.110		average validation NDCG = 0.698

epoch 3
average train loss = -552119.125000    	average train batch reward = 0.568
validation accuracy = 0.111		average validation NDCG = 0.699

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -61437.371094    	average train batch reward = 0.565
validation accuracy = 0.096		average validation NDCG = 0.702

epoch 2
average train loss = -677825.250000    	average train batch reward = 0.572
validation accuracy = 0.096		average validation NDCG = 0.703

epoch 3
average train loss = -1282548.625000    	average train batch reward = 0.572
validation accuracy = 0.096		average validation NDCG = 0.703

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 368.475647    	average train batch reward = 0.551
validation accuracy = 0.172		average validation NDCG = 0.697

epoch 2
average train loss = -35217.042969    	average train batch reward = 0.563
validation accuracy = 0.107		average validation NDCG = 0.696

epoch 3
average train loss = -112694.515625    	average train batch reward = 0.563
validation accuracy = 0.162		average validation NDCG = 0.699

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -63525.058594    	average train batch reward = 0.571
validation accuracy = 0.096		average validation NDCG = 0.702

epoch 2
average train loss = -693945.250000    	average train batch reward = 0.572
validation accuracy = 0.096		average validation NDCG = 0.703

epoch 3
average train loss = -2705440.750000    	average train batch reward = 0.573
validation accuracy = 0.096		average validation NDCG = 0.703

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2956.422363    	average train batch reward = 0.549
validation accuracy = 0.092		average validation NDCG = 0.693

epoch 2
average train loss = -3170.170166    	average train batch reward = 0.577
validation accuracy = 0.134		average validation NDCG = 0.741

epoch 3
average train loss = -9275.058594    	average train batch reward = 0.606
validation accuracy = 0.208		average validation NDCG = 0.754

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2844.974609    	average train batch reward = 0.568
validation accuracy = 0.193		average validation NDCG = 0.698

epoch 2
average train loss = -17627.312500    	average train batch reward = 0.574
validation accuracy = 0.197		average validation NDCG = 0.699

epoch 3
average train loss = -94230.882812    	average train batch reward = 0.573
validation accuracy = 0.188		average validation NDCG = 0.699

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2371.784424    	average train batch reward = 0.582
validation accuracy = 0.098		average validation NDCG = 0.726

epoch 2
average train loss = -25142.175781    	average train batch reward = 0.597
validation accuracy = 0.153		average validation NDCG = 0.729

epoch 3
average train loss = -135627.109375    	average train batch reward = 0.603
validation accuracy = 0.173		average validation NDCG = 0.731

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -576.885315    	average train batch reward = 0.570
validation accuracy = 0.199		average validation NDCG = 0.733

epoch 2
average train loss = -9723.114258    	average train batch reward = 0.608
validation accuracy = 0.197		average validation NDCG = 0.738

epoch 3
average train loss = -14435.921875    	average train batch reward = 0.616
validation accuracy = 0.286		average validation NDCG = 0.747

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 300.438080    	average train batch reward = 0.575
validation accuracy = 0.138		average validation NDCG = 0.714

epoch 2
average train loss = -8531.078125    	average train batch reward = 0.570
validation accuracy = 0.098		average validation NDCG = 0.710

epoch 3
average train loss = -118774.039062    	average train batch reward = 0.583
validation accuracy = 0.126		average validation NDCG = 0.705

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1900.918823    	average train batch reward = 0.556
validation accuracy = 0.127		average validation NDCG = 0.693

epoch 2
average train loss = -27065.416016    	average train batch reward = 0.564
validation accuracy = 0.128		average validation NDCG = 0.695

epoch 3
average train loss = 5519.905273    	average train batch reward = 0.564
validation accuracy = 0.173		average validation NDCG = 0.696

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -23.470751    	average train batch reward = 0.565
validation accuracy = 0.162		average validation NDCG = 0.721

epoch 2
average train loss = -391.571991    	average train batch reward = 0.609
validation accuracy = 0.266		average validation NDCG = 0.733

epoch 3
average train loss = -3037.402100    	average train batch reward = 0.609
validation accuracy = 0.252		average validation NDCG = 0.737

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -75.178558    	average train batch reward = 0.565
validation accuracy = 0.195		average validation NDCG = 0.725

epoch 2
average train loss = -195.583099    	average train batch reward = 0.630
validation accuracy = 0.210		average validation NDCG = 0.781

epoch 3
average train loss = -1071.199829    	average train batch reward = 0.657
validation accuracy = 0.261		average validation NDCG = 0.781

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -31.491600    	average train batch reward = 0.587
validation accuracy = 0.106		average validation NDCG = 0.744

epoch 2
average train loss = -1313.429077    	average train batch reward = 0.614
validation accuracy = 0.144		average validation NDCG = 0.758

epoch 3
average train loss = -3109.842285    	average train batch reward = 0.626
validation accuracy = 0.157		average validation NDCG = 0.751

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -33.588978    	average train batch reward = 0.561
validation accuracy = 0.174		average validation NDCG = 0.709

epoch 2
average train loss = -744.632507    	average train batch reward = 0.582
validation accuracy = 0.116		average validation NDCG = 0.734

epoch 3
average train loss = -1676.741089    	average train batch reward = 0.615
validation accuracy = 0.137		average validation NDCG = 0.750

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -207.389023    	average train batch reward = 0.619
validation accuracy = 0.254		average validation NDCG = 0.779

epoch 2
average train loss = -1471.730957    	average train batch reward = 0.659
validation accuracy = 0.290		average validation NDCG = 0.784

epoch 3
average train loss = -5859.000977    	average train batch reward = 0.659
validation accuracy = 0.313		average validation NDCG = 0.781

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -125.365921    	average train batch reward = 0.610
validation accuracy = 0.186		average validation NDCG = 0.773

epoch 2
average train loss = -774.259155    	average train batch reward = 0.657
validation accuracy = 0.188		average validation NDCG = 0.785

epoch 3
average train loss = -2882.806396    	average train batch reward = 0.647
validation accuracy = 0.288		average validation NDCG = 0.776

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 42026.097656    	average train batch reward = 0.546
validation accuracy = 0.096		average validation NDCG = 0.673

epoch 2
average train loss = -276210.000000    	average train batch reward = 0.542
validation accuracy = 0.147		average validation NDCG = 0.692

epoch 3
average train loss = 2352173.500000    	average train batch reward = 0.557
validation accuracy = 0.099		average validation NDCG = 0.694

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 1653.039917    	average train batch reward = 0.541
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 2
average train loss = 0.000000    	average train batch reward = 0.540
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 3
average train loss = 0.000000    	average train batch reward = 0.539
validation accuracy = 0.096		average validation NDCG = 0.672

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 8922.284180    	average train batch reward = 0.540
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 2
average train loss = 0.052839    	average train batch reward = 0.539
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 3
average train loss = 0.000000    	average train batch reward = 0.541
validation accuracy = 0.096		average validation NDCG = 0.672

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -11056286.000000    	average train batch reward = 0.561
validation accuracy = 0.096		average validation NDCG = 0.699

epoch 2
average train loss = -87799960.000000    	average train batch reward = 0.569
validation accuracy = 0.096		average validation NDCG = 0.702

epoch 3
average train loss = -224492720.000000    	average train batch reward = 0.570
validation accuracy = 0.096		average validation NDCG = 0.702

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2233748.250000    	average train batch reward = 0.577
validation accuracy = 0.099		average validation NDCG = 0.743

epoch 2
average train loss = -26319446.000000    	average train batch reward = 0.582
validation accuracy = 0.100		average validation NDCG = 0.719

epoch 3
average train loss = -95579208.000000    	average train batch reward = 0.605
validation accuracy = 0.107		average validation NDCG = 0.729

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3741949.000000    	average train batch reward = 0.567
validation accuracy = 0.176		average validation NDCG = 0.700

epoch 2
average train loss = -35703464.000000    	average train batch reward = 0.572
validation accuracy = 0.192		average validation NDCG = 0.700

epoch 3
average train loss = -192841232.000000    	average train batch reward = 0.570
validation accuracy = 0.155		average validation NDCG = 0.699

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -459872.468750    	average train batch reward = 0.574
validation accuracy = 0.096		average validation NDCG = 0.716

epoch 2
average train loss = -4452760.000000    	average train batch reward = 0.590
validation accuracy = 0.157		average validation NDCG = 0.718

epoch 3
average train loss = -12290318.000000    	average train batch reward = 0.587
validation accuracy = 0.132		average validation NDCG = 0.722

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -512349.312500    	average train batch reward = 0.602
validation accuracy = 0.130		average validation NDCG = 0.743

epoch 2
average train loss = -1475948.500000    	average train batch reward = 0.618
validation accuracy = 0.187		average validation NDCG = 0.750

epoch 3
average train loss = -3861439.750000    	average train batch reward = 0.623
validation accuracy = 0.186		average validation NDCG = 0.752

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -146490.015625    	average train batch reward = 0.558
validation accuracy = 0.144		average validation NDCG = 0.702

epoch 2
average train loss = -2123374.500000    	average train batch reward = 0.568
validation accuracy = 0.099		average validation NDCG = 0.699

epoch 3
average train loss = -4025377.500000    	average train batch reward = 0.567
validation accuracy = 0.099		average validation NDCG = 0.701

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -38880.613281    	average train batch reward = 0.577
validation accuracy = 0.096		average validation NDCG = 0.698

epoch 2
average train loss = -5357271.500000    	average train batch reward = 0.570
validation accuracy = 0.096		average validation NDCG = 0.702

epoch 3
average train loss = -23855068.000000    	average train batch reward = 0.571
validation accuracy = 0.096		average validation NDCG = 0.702

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 1494.336670    	average train batch reward = 0.542
validation accuracy = 0.099		average validation NDCG = 0.679

epoch 2
average train loss = 42516.132812    	average train batch reward = 0.553
validation accuracy = 0.110		average validation NDCG = 0.697

epoch 3
average train loss = -915146.625000    	average train batch reward = 0.577
validation accuracy = 0.111		average validation NDCG = 0.707

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -397068.500000    	average train batch reward = 0.574
validation accuracy = 0.197		average validation NDCG = 0.728

epoch 2
average train loss = -2119033.250000    	average train batch reward = 0.603
validation accuracy = 0.185		average validation NDCG = 0.732

epoch 3
average train loss = -9705734.000000    	average train batch reward = 0.609
validation accuracy = 0.191		average validation NDCG = 0.733

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 950.624451    	average train batch reward = 0.548
validation accuracy = 0.163		average validation NDCG = 0.691

epoch 2
average train loss = -2832.061035    	average train batch reward = 0.576
validation accuracy = 0.310		average validation NDCG = 0.737

epoch 3
average train loss = -46272.125000    	average train batch reward = 0.629
validation accuracy = 0.253		average validation NDCG = 0.767

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -15786.424805    	average train batch reward = 0.566
validation accuracy = 0.129		average validation NDCG = 0.746

epoch 2
average train loss = -187126.812500    	average train batch reward = 0.616
validation accuracy = 0.153		average validation NDCG = 0.746

epoch 3
average train loss = -510457.312500    	average train batch reward = 0.608
validation accuracy = 0.236		average validation NDCG = 0.737

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -5855.297852    	average train batch reward = 0.578
validation accuracy = 0.125		average validation NDCG = 0.734

epoch 2
average train loss = -48439.089844    	average train batch reward = 0.603
validation accuracy = 0.105		average validation NDCG = 0.739

epoch 3
average train loss = -96892.070312    	average train batch reward = 0.609
validation accuracy = 0.121		average validation NDCG = 0.741

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3773.928955    	average train batch reward = 0.567
validation accuracy = 0.167		average validation NDCG = 0.739

epoch 2
average train loss = -72888.125000    	average train batch reward = 0.616
validation accuracy = 0.243		average validation NDCG = 0.768

epoch 3
average train loss = -283883.593750    	average train batch reward = 0.644
validation accuracy = 0.269		average validation NDCG = 0.775

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -10237.714844    	average train batch reward = 0.562
validation accuracy = 0.151		average validation NDCG = 0.710

epoch 2
average train loss = -110677.257812    	average train batch reward = 0.598
validation accuracy = 0.176		average validation NDCG = 0.733

epoch 3
average train loss = -522119.125000    	average train batch reward = 0.600
validation accuracy = 0.251		average validation NDCG = 0.731

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
Hyperparameters:
k = 10
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2aedc918d0c8>
Reward function = <function ndcg_full at 0x2aedc918d140>
Greedy action = <function sample at 0x2aedc1fe1758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -5344.509766    	average train batch reward = 0.591
validation accuracy = 0.276		average validation NDCG = 0.741

epoch 2
average train loss = -100795.851562    	average train batch reward = 0.619
validation accuracy = 0.227		average validation NDCG = 0.750

epoch 3
average train loss = -483160.375000    	average train batch reward = 0.623
validation accuracy = 0.232		average validation NDCG = 0.753

========
Currently the best setups are [(0.0001, 50, 1.0), (0.001, 512, 0.0), (0.0001, 50, 0.05)], which got scores of [0.901402638351818, 0.88518040414608889, 0.88422439380932294]
========
2017-06-30 16:25:59
