2017-06-30 08:49:50
Finding best parameters for k = 7
=========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.056874    	average train batch reward = 0.581
validation accuracy = 0.094		average validation NDCG = 0.663

epoch 2
average train loss = 0.037547    	average train batch reward = 0.583
validation accuracy = 0.095		average validation NDCG = 0.663

epoch 3
average train loss = 0.069981    	average train batch reward = 0.586
validation accuracy = 0.095		average validation NDCG = 0.664

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.0), (), ()], which got scores of [0.66351721625535909, -1, -1]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.109900    	average train batch reward = 0.633
validation accuracy = 0.127		average validation NDCG = 0.699

epoch 2
average train loss = -0.167085    	average train batch reward = 0.633
validation accuracy = 0.128		average validation NDCG = 0.699

epoch 3
average train loss = -0.052206    	average train batch reward = 0.635
validation accuracy = 0.128		average validation NDCG = 0.700

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 50, 0.0), ()], which got scores of [0.69997697951629079, 0.66351721625535909, -1]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.088199    	average train batch reward = 0.595
validation accuracy = 0.101		average validation NDCG = 0.691

epoch 2
average train loss = -0.066373    	average train batch reward = 0.598
validation accuracy = 0.101		average validation NDCG = 0.691

epoch 3
average train loss = -0.064313    	average train batch reward = 0.597
validation accuracy = 0.101		average validation NDCG = 0.691

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 50, 0.2), (9.9999999999999995e-08, 50, 0.0)], which got scores of [0.69997697951629079, 0.69145255537089845, 0.66351721625535909]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.044592    	average train batch reward = 0.579
validation accuracy = 0.158		average validation NDCG = 0.669

epoch 2
average train loss = 0.099568    	average train batch reward = 0.580
validation accuracy = 0.158		average validation NDCG = 0.669

epoch 3
average train loss = 0.005711    	average train batch reward = 0.579
validation accuracy = 0.159		average validation NDCG = 0.669

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 50, 0.2), (9.9999999999999995e-08, 50, 0.5)], which got scores of [0.69997697951629079, 0.69145255537089845, 0.66936733424648331]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.047298    	average train batch reward = 0.597
validation accuracy = 0.128		average validation NDCG = 0.675

epoch 2
average train loss = -0.032535    	average train batch reward = 0.597
validation accuracy = 0.129		average validation NDCG = 0.675

epoch 3
average train loss = -0.009666    	average train batch reward = 0.600
validation accuracy = 0.130		average validation NDCG = 0.675

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 50, 0.2), (9.9999999999999995e-08, 50, 1.0)], which got scores of [0.69997697951629079, 0.69145255537089845, 0.67545247342669668]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.046627    	average train batch reward = 0.583
validation accuracy = 0.111		average validation NDCG = 0.677

epoch 2
average train loss = 0.014907    	average train batch reward = 0.584
validation accuracy = 0.112		average validation NDCG = 0.677

epoch 3
average train loss = 0.035922    	average train batch reward = 0.584
validation accuracy = 0.112		average validation NDCG = 0.677

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 50, 0.2), (9.9999999999999995e-08, 50, 1.5)], which got scores of [0.69997697951629079, 0.69145255537089845, 0.67715293001199206]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.076560    	average train batch reward = 0.596
validation accuracy = 0.118		average validation NDCG = 0.674

epoch 2
average train loss = 0.007502    	average train batch reward = 0.594
validation accuracy = 0.118		average validation NDCG = 0.674

epoch 3
average train loss = -0.063442    	average train batch reward = 0.596
validation accuracy = 0.118		average validation NDCG = 0.674

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 50, 0.2), (9.9999999999999995e-08, 50, 1.5)], which got scores of [0.69997697951629079, 0.69145255537089845, 0.67715293001199206]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.064862    	average train batch reward = 0.580
validation accuracy = 0.079		average validation NDCG = 0.667

epoch 2
average train loss = -0.054203    	average train batch reward = 0.579
validation accuracy = 0.080		average validation NDCG = 0.668

epoch 3
average train loss = -0.019235    	average train batch reward = 0.581
validation accuracy = 0.080		average validation NDCG = 0.668

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 50, 0.2), (9.9999999999999995e-08, 50, 1.5)], which got scores of [0.69997697951629079, 0.69145255537089845, 0.67715293001199206]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.077487    	average train batch reward = 0.577
validation accuracy = 0.074		average validation NDCG = 0.670

epoch 2
average train loss = 0.037331    	average train batch reward = 0.575
validation accuracy = 0.074		average validation NDCG = 0.670

epoch 3
average train loss = 0.036659    	average train batch reward = 0.575
validation accuracy = 0.074		average validation NDCG = 0.670

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 50, 0.2), (9.9999999999999995e-08, 50, 1.5)], which got scores of [0.69997697951629079, 0.69145255537089845, 0.67715293001199206]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.075824    	average train batch reward = 0.604
validation accuracy = 0.117		average validation NDCG = 0.690

epoch 2
average train loss = -0.132259    	average train batch reward = 0.605
validation accuracy = 0.117		average validation NDCG = 0.690

epoch 3
average train loss = -0.052015    	average train batch reward = 0.606
validation accuracy = 0.117		average validation NDCG = 0.690

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 50, 0.2), (9.9999999999999995e-08, 512, 0.5)], which got scores of [0.69997697951629079, 0.69145255537089845, 0.69040115405091484]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.049777    	average train batch reward = 0.567
validation accuracy = 0.114		average validation NDCG = 0.661

epoch 2
average train loss = -0.051664    	average train batch reward = 0.567
validation accuracy = 0.114		average validation NDCG = 0.661

epoch 3
average train loss = 0.014271    	average train batch reward = 0.567
validation accuracy = 0.114		average validation NDCG = 0.661

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 50, 0.2), (9.9999999999999995e-08, 512, 0.5)], which got scores of [0.69997697951629079, 0.69145255537089845, 0.69040115405091484]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.010235    	average train batch reward = 0.579
validation accuracy = 0.123		average validation NDCG = 0.669

epoch 2
average train loss = -0.000039    	average train batch reward = 0.580
validation accuracy = 0.123		average validation NDCG = 0.669

epoch 3
average train loss = 0.071032    	average train batch reward = 0.579
validation accuracy = 0.123		average validation NDCG = 0.669

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 50, 0.2), (9.9999999999999995e-08, 512, 0.5)], which got scores of [0.69997697951629079, 0.69145255537089845, 0.69040115405091484]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.018008    	average train batch reward = 0.615
validation accuracy = 0.120		average validation NDCG = 0.693

epoch 2
average train loss = -0.170990    	average train batch reward = 0.614
validation accuracy = 0.119		average validation NDCG = 0.693

epoch 3
average train loss = -0.164063    	average train batch reward = 0.618
validation accuracy = 0.120		average validation NDCG = 0.693

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.69997697951629079, 0.69280420515938568, 0.69145255537089845]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.033743    	average train batch reward = 0.577
validation accuracy = 0.140		average validation NDCG = 0.672

epoch 2
average train loss = 0.110960    	average train batch reward = 0.576
validation accuracy = 0.140		average validation NDCG = 0.672

epoch 3
average train loss = 0.011703    	average train batch reward = 0.578
validation accuracy = 0.140		average validation NDCG = 0.672

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.69997697951629079, 0.69280420515938568, 0.69145255537089845]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.008282    	average train batch reward = 0.599
validation accuracy = 0.108		average validation NDCG = 0.686

epoch 2
average train loss = -0.051989    	average train batch reward = 0.600
validation accuracy = 0.108		average validation NDCG = 0.686

epoch 3
average train loss = -0.011143    	average train batch reward = 0.600
validation accuracy = 0.108		average validation NDCG = 0.686

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.69997697951629079, 0.69280420515938568, 0.69145255537089845]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.012647    	average train batch reward = 0.591
validation accuracy = 0.106		average validation NDCG = 0.675

epoch 2
average train loss = 0.072042    	average train batch reward = 0.593
validation accuracy = 0.106		average validation NDCG = 0.675

epoch 3
average train loss = 0.054501    	average train batch reward = 0.593
validation accuracy = 0.107		average validation NDCG = 0.675

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.69997697951629079, 0.69280420515938568, 0.69145255537089845]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.060263    	average train batch reward = 0.595
validation accuracy = 0.102		average validation NDCG = 0.676

epoch 2
average train loss = -0.014539    	average train batch reward = 0.595
validation accuracy = 0.102		average validation NDCG = 0.676

epoch 3
average train loss = -0.006339    	average train batch reward = 0.596
validation accuracy = 0.102		average validation NDCG = 0.676

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.69997697951629079, 0.69280420515938568, 0.69145255537089845]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.047618    	average train batch reward = 0.579
validation accuracy = 0.111		average validation NDCG = 0.671

epoch 2
average train loss = -0.017249    	average train batch reward = 0.578
validation accuracy = 0.111		average validation NDCG = 0.671

epoch 3
average train loss = 0.025848    	average train batch reward = 0.580
validation accuracy = 0.111		average validation NDCG = 0.671

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.69997697951629079, 0.69280420515938568, 0.69145255537089845]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.030352    	average train batch reward = 0.591
validation accuracy = 0.120		average validation NDCG = 0.680

epoch 2
average train loss = -0.108283    	average train batch reward = 0.597
validation accuracy = 0.129		average validation NDCG = 0.683

epoch 3
average train loss = -0.175143    	average train batch reward = 0.603
validation accuracy = 0.137		average validation NDCG = 0.687

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.69997697951629079, 0.69280420515938568, 0.69145255537089845]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.067675    	average train batch reward = 0.566
validation accuracy = 0.121		average validation NDCG = 0.658

epoch 2
average train loss = -0.119900    	average train batch reward = 0.572
validation accuracy = 0.129		average validation NDCG = 0.660

epoch 3
average train loss = -0.038868    	average train batch reward = 0.576
validation accuracy = 0.133		average validation NDCG = 0.662

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.69997697951629079, 0.69280420515938568, 0.69145255537089845]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.016797    	average train batch reward = 0.590
validation accuracy = 0.085		average validation NDCG = 0.676

epoch 2
average train loss = 0.042389    	average train batch reward = 0.595
validation accuracy = 0.091		average validation NDCG = 0.680

epoch 3
average train loss = 0.006245    	average train batch reward = 0.601
validation accuracy = 0.103		average validation NDCG = 0.686

========
Currently the best setups are [(9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 5012, 0.0), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.69997697951629079, 0.69280420515938568, 0.69145255537089845]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.081620    	average train batch reward = 0.616
validation accuracy = 0.092		average validation NDCG = 0.696

epoch 2
average train loss = -0.013356    	average train batch reward = 0.620
validation accuracy = 0.096		average validation NDCG = 0.700

epoch 3
average train loss = -0.058198    	average train batch reward = 0.626
validation accuracy = 0.100		average validation NDCG = 0.705

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.5), (9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.70450755248657271, 0.69997697951629079, 0.69145255537089845]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.056678    	average train batch reward = 0.562
validation accuracy = 0.097		average validation NDCG = 0.655

epoch 2
average train loss = -0.079134    	average train batch reward = 0.567
validation accuracy = 0.107		average validation NDCG = 0.658

epoch 3
average train loss = -0.043484    	average train batch reward = 0.570
validation accuracy = 0.113		average validation NDCG = 0.661

========
Currently the best setups are [(9.9999999999999995e-07, 50, 0.5), (9.9999999999999995e-08, 50, 0.05), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.70450755248657271, 0.69997697951629079, 0.69145255537089845]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.068614    	average train batch reward = 0.605
validation accuracy = 0.093		average validation NDCG = 0.697

epoch 2
average train loss = -0.011399    	average train batch reward = 0.612
validation accuracy = 0.100		average validation NDCG = 0.702

epoch 3
average train loss = -0.167758    	average train batch reward = 0.617
validation accuracy = 0.107		average validation NDCG = 0.707

========
Currently the best setups are [(9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 50, 0.5), (9.9999999999999995e-08, 50, 0.2)], which got scores of [0.70723747845524854, 0.70450755248657271, 0.69145255537089845]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.098030    	average train batch reward = 0.610
validation accuracy = 0.110		average validation NDCG = 0.693

epoch 2
average train loss = 0.035350    	average train batch reward = 0.615
validation accuracy = 0.111		average validation NDCG = 0.695

epoch 3
average train loss = 0.063477    	average train batch reward = 0.617
validation accuracy = 0.113		average validation NDCG = 0.698

========
Currently the best setups are [(9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 50, 0.5), (9.9999999999999995e-07, 512, 0.0)], which got scores of [0.70723747845524854, 0.70450755248657271, 0.697808479127211]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.066634    	average train batch reward = 0.582
validation accuracy = 0.071		average validation NDCG = 0.671

epoch 2
average train loss = -0.026344    	average train batch reward = 0.584
validation accuracy = 0.073		average validation NDCG = 0.671

epoch 3
average train loss = 0.031714    	average train batch reward = 0.583
validation accuracy = 0.077		average validation NDCG = 0.672

========
Currently the best setups are [(9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 50, 0.5), (9.9999999999999995e-07, 512, 0.0)], which got scores of [0.70723747845524854, 0.70450755248657271, 0.697808479127211]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.059069    	average train batch reward = 0.587
validation accuracy = 0.099		average validation NDCG = 0.664

epoch 2
average train loss = -0.008843    	average train batch reward = 0.590
validation accuracy = 0.102		average validation NDCG = 0.665

epoch 3
average train loss = 0.004751    	average train batch reward = 0.592
validation accuracy = 0.106		average validation NDCG = 0.666

========
Currently the best setups are [(9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 50, 0.5), (9.9999999999999995e-07, 512, 0.0)], which got scores of [0.70723747845524854, 0.70450755248657271, 0.697808479127211]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.006188    	average train batch reward = 0.574
validation accuracy = 0.096		average validation NDCG = 0.664

epoch 2
average train loss = -0.074199    	average train batch reward = 0.577
validation accuracy = 0.100		average validation NDCG = 0.665

epoch 3
average train loss = -0.087233    	average train batch reward = 0.579
validation accuracy = 0.101		average validation NDCG = 0.666

========
Currently the best setups are [(9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 50, 0.5), (9.9999999999999995e-07, 512, 0.0)], which got scores of [0.70723747845524854, 0.70450755248657271, 0.697808479127211]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.046050    	average train batch reward = 0.594
validation accuracy = 0.126		average validation NDCG = 0.684

epoch 2
average train loss = -0.026025    	average train batch reward = 0.596
validation accuracy = 0.129		average validation NDCG = 0.685

epoch 3
average train loss = -0.167957    	average train batch reward = 0.598
validation accuracy = 0.135		average validation NDCG = 0.686

========
Currently the best setups are [(9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 50, 0.5), (9.9999999999999995e-07, 512, 0.0)], which got scores of [0.70723747845524854, 0.70450755248657271, 0.697808479127211]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.073883    	average train batch reward = 0.569
validation accuracy = 0.113		average validation NDCG = 0.669

epoch 2
average train loss = -0.056285    	average train batch reward = 0.571
validation accuracy = 0.114		average validation NDCG = 0.670

epoch 3
average train loss = -0.080179    	average train batch reward = 0.574
validation accuracy = 0.115		average validation NDCG = 0.671

========
Currently the best setups are [(9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 50, 0.5), (9.9999999999999995e-07, 512, 0.0)], which got scores of [0.70723747845524854, 0.70450755248657271, 0.697808479127211]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.022335    	average train batch reward = 0.604
validation accuracy = 0.123		average validation NDCG = 0.679

epoch 2
average train loss = 0.016370    	average train batch reward = 0.604
validation accuracy = 0.123		average validation NDCG = 0.679

epoch 3
average train loss = 0.054638    	average train batch reward = 0.604
validation accuracy = 0.123		average validation NDCG = 0.679

========
Currently the best setups are [(9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 50, 0.5), (9.9999999999999995e-07, 512, 0.0)], which got scores of [0.70723747845524854, 0.70450755248657271, 0.697808479127211]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.070011    	average train batch reward = 0.569
validation accuracy = 0.084		average validation NDCG = 0.663

epoch 2
average train loss = -0.016695    	average train batch reward = 0.570
validation accuracy = 0.084		average validation NDCG = 0.663

epoch 3
average train loss = 0.033605    	average train batch reward = 0.569
validation accuracy = 0.085		average validation NDCG = 0.664

========
Currently the best setups are [(9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 50, 0.5), (9.9999999999999995e-07, 512, 0.0)], which got scores of [0.70723747845524854, 0.70450755248657271, 0.697808479127211]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.114477    	average train batch reward = 0.612
validation accuracy = 0.169		average validation NDCG = 0.694

epoch 2
average train loss = -0.243725    	average train batch reward = 0.612
validation accuracy = 0.170		average validation NDCG = 0.694

epoch 3
average train loss = -0.188522    	average train batch reward = 0.613
validation accuracy = 0.170		average validation NDCG = 0.695

========
Currently the best setups are [(9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 50, 0.5), (9.9999999999999995e-07, 512, 0.0)], which got scores of [0.70723747845524854, 0.70450755248657271, 0.697808479127211]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.049813    	average train batch reward = 0.584
validation accuracy = 0.100		average validation NDCG = 0.675

epoch 2
average train loss = 0.038696    	average train batch reward = 0.584
validation accuracy = 0.100		average validation NDCG = 0.675

epoch 3
average train loss = 0.009624    	average train batch reward = 0.586
validation accuracy = 0.101		average validation NDCG = 0.675

========
Currently the best setups are [(9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 50, 0.5), (9.9999999999999995e-07, 512, 0.0)], which got scores of [0.70723747845524854, 0.70450755248657271, 0.697808479127211]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.044848    	average train batch reward = 0.593
validation accuracy = 0.122		average validation NDCG = 0.690

epoch 2
average train loss = -0.059393    	average train batch reward = 0.594
validation accuracy = 0.122		average validation NDCG = 0.690

epoch 3
average train loss = -0.069241    	average train batch reward = 0.594
validation accuracy = 0.122		average validation NDCG = 0.690

========
Currently the best setups are [(9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 50, 0.5), (9.9999999999999995e-07, 512, 0.0)], which got scores of [0.70723747845524854, 0.70450755248657271, 0.697808479127211]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.067591    	average train batch reward = 0.606
validation accuracy = 0.095		average validation NDCG = 0.680

epoch 2
average train loss = -0.032269    	average train batch reward = 0.608
validation accuracy = 0.095		average validation NDCG = 0.680

epoch 3
average train loss = -0.067413    	average train batch reward = 0.610
validation accuracy = 0.096		average validation NDCG = 0.681

========
Currently the best setups are [(9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 50, 0.5), (9.9999999999999995e-07, 512, 0.0)], which got scores of [0.70723747845524854, 0.70450755248657271, 0.697808479127211]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.129954    	average train batch reward = 0.618
validation accuracy = 0.189		average validation NDCG = 0.731

epoch 2
average train loss = -0.668672    	average train batch reward = 0.676
validation accuracy = 0.240		average validation NDCG = 0.774

epoch 3
average train loss = -1.104620    	average train batch reward = 0.713
validation accuracy = 0.293		average validation NDCG = 0.804

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.0), (9.9999999999999995e-07, 50, 1.5), (9.9999999999999995e-07, 512, 0.0)], which got scores of [0.80374391869839601, 0.70723747845524854, 0.697808479127211]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.258629    	average train batch reward = 0.636
validation accuracy = 0.269		average validation NDCG = 0.736

epoch 2
average train loss = -0.766611    	average train batch reward = 0.687
validation accuracy = 0.333		average validation NDCG = 0.772

epoch 3
average train loss = -1.403710    	average train batch reward = 0.716
validation accuracy = 0.372		average validation NDCG = 0.790

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 0.05), (9.9999999999999995e-07, 50, 1.5)], which got scores of [0.80374391869839601, 0.79013193066026433, 0.70723747845524854]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.170169    	average train batch reward = 0.631
validation accuracy = 0.166		average validation NDCG = 0.730

epoch 2
average train loss = -0.538284    	average train batch reward = 0.689
validation accuracy = 0.240		average validation NDCG = 0.778

epoch 3
average train loss = -0.960950    	average train batch reward = 0.726
validation accuracy = 0.309		average validation NDCG = 0.813

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (9.9999999999999995e-07, 50, 1.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.70723747845524854]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.162176    	average train batch reward = 0.593
validation accuracy = 0.195		average validation NDCG = 0.695

epoch 2
average train loss = -0.570705    	average train batch reward = 0.636
validation accuracy = 0.266		average validation NDCG = 0.739

epoch 3
average train loss = -0.979132    	average train batch reward = 0.676
validation accuracy = 0.332		average validation NDCG = 0.772

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 0.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.77173873997371178]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.082181    	average train batch reward = 0.558
validation accuracy = 0.115		average validation NDCG = 0.665

epoch 2
average train loss = -0.320090    	average train batch reward = 0.599
validation accuracy = 0.177		average validation NDCG = 0.692

epoch 3
average train loss = -0.685576    	average train batch reward = 0.651
validation accuracy = 0.223		average validation NDCG = 0.733

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 0.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.77173873997371178]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.286263    	average train batch reward = 0.644
validation accuracy = 0.264		average validation NDCG = 0.741

epoch 2
average train loss = -0.881687    	average train batch reward = 0.686
validation accuracy = 0.331		average validation NDCG = 0.777

epoch 3
average train loss = -1.156190    	average train batch reward = 0.713
validation accuracy = 0.349		average validation NDCG = 0.799

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 1.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.79876838631541902]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.052835    	average train batch reward = 0.599
validation accuracy = 0.130		average validation NDCG = 0.687

epoch 2
average train loss = -0.193824    	average train batch reward = 0.619
validation accuracy = 0.171		average validation NDCG = 0.703

epoch 3
average train loss = -0.325336    	average train batch reward = 0.640
validation accuracy = 0.215		average validation NDCG = 0.720

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 1.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.79876838631541902]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.125483    	average train batch reward = 0.624
validation accuracy = 0.144		average validation NDCG = 0.708

epoch 2
average train loss = -0.235962    	average train batch reward = 0.641
validation accuracy = 0.168		average validation NDCG = 0.721

epoch 3
average train loss = -0.419306    	average train batch reward = 0.659
validation accuracy = 0.203		average validation NDCG = 0.735

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 1.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.79876838631541902]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.000171    	average train batch reward = 0.580
validation accuracy = 0.101		average validation NDCG = 0.670

epoch 2
average train loss = -0.061420    	average train batch reward = 0.593
validation accuracy = 0.108		average validation NDCG = 0.680

epoch 3
average train loss = -0.182951    	average train batch reward = 0.612
validation accuracy = 0.122		average validation NDCG = 0.691

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 1.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.79876838631541902]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.217275    	average train batch reward = 0.610
validation accuracy = 0.140		average validation NDCG = 0.693

epoch 2
average train loss = -0.286878    	average train batch reward = 0.626
validation accuracy = 0.156		average validation NDCG = 0.705

epoch 3
average train loss = -0.329824    	average train batch reward = 0.639
validation accuracy = 0.175		average validation NDCG = 0.714

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 1.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.79876838631541902]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.055324    	average train batch reward = 0.583
validation accuracy = 0.114		average validation NDCG = 0.685

epoch 2
average train loss = -0.191326    	average train batch reward = 0.597
validation accuracy = 0.133		average validation NDCG = 0.694

epoch 3
average train loss = -0.114742    	average train batch reward = 0.610
validation accuracy = 0.146		average validation NDCG = 0.703

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 1.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.79876838631541902]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.023703    	average train batch reward = 0.596
validation accuracy = 0.102		average validation NDCG = 0.682

epoch 2
average train loss = -0.089055    	average train batch reward = 0.616
validation accuracy = 0.147		average validation NDCG = 0.694

epoch 3
average train loss = -0.343139    	average train batch reward = 0.633
validation accuracy = 0.192		average validation NDCG = 0.708

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 1.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.79876838631541902]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.007989    	average train batch reward = 0.580
validation accuracy = 0.116		average validation NDCG = 0.669

epoch 2
average train loss = 0.045739    	average train batch reward = 0.581
validation accuracy = 0.121		average validation NDCG = 0.671

epoch 3
average train loss = -0.015166    	average train batch reward = 0.585
validation accuracy = 0.125		average validation NDCG = 0.674

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 1.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.79876838631541902]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.009279    	average train batch reward = 0.591
validation accuracy = 0.126		average validation NDCG = 0.682

epoch 2
average train loss = 0.060049    	average train batch reward = 0.594
validation accuracy = 0.129		average validation NDCG = 0.684

epoch 3
average train loss = -0.106759    	average train batch reward = 0.597
validation accuracy = 0.132		average validation NDCG = 0.686

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 1.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.79876838631541902]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.063866    	average train batch reward = 0.579
validation accuracy = 0.088		average validation NDCG = 0.670

epoch 2
average train loss = 0.068560    	average train batch reward = 0.582
validation accuracy = 0.090		average validation NDCG = 0.672

epoch 3
average train loss = -0.062698    	average train batch reward = 0.584
validation accuracy = 0.092		average validation NDCG = 0.675

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 1.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.79876838631541902]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.051365    	average train batch reward = 0.611
validation accuracy = 0.170		average validation NDCG = 0.698

epoch 2
average train loss = 0.032874    	average train batch reward = 0.617
validation accuracy = 0.176		average validation NDCG = 0.701

epoch 3
average train loss = -0.030680    	average train batch reward = 0.621
validation accuracy = 0.181		average validation NDCG = 0.704

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 1.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.79876838631541902]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.029662    	average train batch reward = 0.573
validation accuracy = 0.092		average validation NDCG = 0.658

epoch 2
average train loss = 0.026588    	average train batch reward = 0.575
validation accuracy = 0.097		average validation NDCG = 0.660

epoch 3
average train loss = 0.105148    	average train batch reward = 0.577
validation accuracy = 0.101		average validation NDCG = 0.661

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 1.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.79876838631541902]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.019602    	average train batch reward = 0.609
validation accuracy = 0.128		average validation NDCG = 0.693

epoch 2
average train loss = 0.067316    	average train batch reward = 0.613
validation accuracy = 0.131		average validation NDCG = 0.696

epoch 3
average train loss = -0.065160    	average train batch reward = 0.617
validation accuracy = 0.136		average validation NDCG = 0.698

========
Currently the best setups are [(1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 0.0), (1.0000000000000001e-05, 50, 1.5)], which got scores of [0.81278970317753707, 0.80374391869839601, 0.79876838631541902]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1.694430    	average train batch reward = 0.736
validation accuracy = 0.455		average validation NDCG = 0.850

epoch 2
average train loss = -3.988929    	average train batch reward = 0.789
validation accuracy = 0.494		average validation NDCG = 0.869

epoch 3
average train loss = -7.536260    	average train batch reward = 0.822
validation accuracy = 0.562		average validation NDCG = 0.899

========
Currently the best setups are [(0.0001, 50, 0.0), (1.0000000000000001e-05, 50, 0.2), (1.0000000000000001e-05, 50, 1.5)], which got scores of [0.89916907557995585, 0.81278970317753707, 0.79876838631541902]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1.807996    	average train batch reward = 0.688
validation accuracy = 0.387		average validation NDCG = 0.813

epoch 2
average train loss = -5.359029    	average train batch reward = 0.766
validation accuracy = 0.428		average validation NDCG = 0.843

epoch 3
average train loss = -8.753412    	average train batch reward = 0.779
validation accuracy = 0.474		average validation NDCG = 0.857

========
Currently the best setups are [(0.0001, 50, 0.0), (0.0001, 50, 0.05), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.89916907557995585, 0.85734756767744469, 0.81278970317753707]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1.671526    	average train batch reward = 0.753
validation accuracy = 0.466		average validation NDCG = 0.896

epoch 2
average train loss = -5.679722    	average train batch reward = 0.831
validation accuracy = 0.481		average validation NDCG = 0.918

epoch 3
average train loss = -7.350108    	average train batch reward = 0.841
validation accuracy = 0.471		average validation NDCG = 0.920

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (1.0000000000000001e-05, 50, 0.2)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.81278970317753707]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2.516459    	average train batch reward = 0.701
validation accuracy = 0.350		average validation NDCG = 0.815

epoch 2
average train loss = -6.547288    	average train batch reward = 0.752
validation accuracy = 0.389		average validation NDCG = 0.837

epoch 3
average train loss = -12.813073    	average train batch reward = 0.756
validation accuracy = 0.402		average validation NDCG = 0.836

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 0.5)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.83687361204458566]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1.712098    	average train batch reward = 0.727
validation accuracy = 0.515		average validation NDCG = 0.851

epoch 2
average train loss = -4.901162    	average train batch reward = 0.796
validation accuracy = 0.479		average validation NDCG = 0.872

epoch 3
average train loss = -9.234088    	average train batch reward = 0.804
validation accuracy = 0.527		average validation NDCG = 0.872

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3.283646    	average train batch reward = 0.717
validation accuracy = 0.425		average validation NDCG = 0.824

epoch 2
average train loss = -6.891940    	average train batch reward = 0.755
validation accuracy = 0.448		average validation NDCG = 0.834

epoch 3
average train loss = -13.683347    	average train batch reward = 0.766
validation accuracy = 0.442		average validation NDCG = 0.837

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.477068    	average train batch reward = 0.644
validation accuracy = 0.269		average validation NDCG = 0.768

epoch 2
average train loss = -1.978047    	average train batch reward = 0.734
validation accuracy = 0.297		average validation NDCG = 0.839

epoch 3
average train loss = -3.272932    	average train batch reward = 0.781
validation accuracy = 0.381		average validation NDCG = 0.865

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.611883    	average train batch reward = 0.656
validation accuracy = 0.280		average validation NDCG = 0.783

epoch 2
average train loss = -1.708694    	average train batch reward = 0.738
validation accuracy = 0.393		average validation NDCG = 0.835

epoch 3
average train loss = -2.534981    	average train batch reward = 0.786
validation accuracy = 0.515		average validation NDCG = 0.866

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.570964    	average train batch reward = 0.631
validation accuracy = 0.181		average validation NDCG = 0.761

epoch 2
average train loss = -2.251575    	average train batch reward = 0.710
validation accuracy = 0.264		average validation NDCG = 0.807

epoch 3
average train loss = -3.892611    	average train batch reward = 0.748
validation accuracy = 0.342		average validation NDCG = 0.843

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.177446    	average train batch reward = 0.594
validation accuracy = 0.204		average validation NDCG = 0.715

epoch 2
average train loss = -1.257099    	average train batch reward = 0.662
validation accuracy = 0.295		average validation NDCG = 0.767

epoch 3
average train loss = -2.716701    	average train batch reward = 0.715
validation accuracy = 0.368		average validation NDCG = 0.797

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.484297    	average train batch reward = 0.620
validation accuracy = 0.251		average validation NDCG = 0.737

epoch 2
average train loss = -1.840348    	average train batch reward = 0.704
validation accuracy = 0.300		average validation NDCG = 0.810

epoch 3
average train loss = -3.202557    	average train batch reward = 0.753
validation accuracy = 0.370		average validation NDCG = 0.846

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.382554    	average train batch reward = 0.612
validation accuracy = 0.249		average validation NDCG = 0.744

epoch 2
average train loss = -1.601402    	average train batch reward = 0.690
validation accuracy = 0.321		average validation NDCG = 0.796

epoch 3
average train loss = -2.613333    	average train batch reward = 0.722
validation accuracy = 0.361		average validation NDCG = 0.822

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.023677    	average train batch reward = 0.583
validation accuracy = 0.117		average validation NDCG = 0.691

epoch 2
average train loss = -0.197174    	average train batch reward = 0.620
validation accuracy = 0.165		average validation NDCG = 0.726

epoch 3
average train loss = -0.456593    	average train batch reward = 0.661
validation accuracy = 0.249		average validation NDCG = 0.753

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.126795    	average train batch reward = 0.610
validation accuracy = 0.141		average validation NDCG = 0.692

epoch 2
average train loss = -0.341808    	average train batch reward = 0.633
validation accuracy = 0.195		average validation NDCG = 0.717

epoch 3
average train loss = -0.533418    	average train batch reward = 0.663
validation accuracy = 0.258		average validation NDCG = 0.745

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.078163    	average train batch reward = 0.607
validation accuracy = 0.144		average validation NDCG = 0.702

epoch 2
average train loss = -0.311011    	average train batch reward = 0.623
validation accuracy = 0.147		average validation NDCG = 0.714

epoch 3
average train loss = -0.632745    	average train batch reward = 0.643
validation accuracy = 0.156		average validation NDCG = 0.726

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.096108    	average train batch reward = 0.629
validation accuracy = 0.134		average validation NDCG = 0.716

epoch 2
average train loss = -0.339716    	average train batch reward = 0.654
validation accuracy = 0.196		average validation NDCG = 0.741

epoch 3
average train loss = -0.536772    	average train batch reward = 0.679
validation accuracy = 0.259		average validation NDCG = 0.760

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.023833    	average train batch reward = 0.600
validation accuracy = 0.123		average validation NDCG = 0.692

epoch 2
average train loss = -0.129454    	average train batch reward = 0.626
validation accuracy = 0.150		average validation NDCG = 0.711

epoch 3
average train loss = -0.336281    	average train batch reward = 0.650
validation accuracy = 0.200		average validation NDCG = 0.733

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.058529    	average train batch reward = 0.571
validation accuracy = 0.106		average validation NDCG = 0.673

epoch 2
average train loss = -0.239138    	average train batch reward = 0.598
validation accuracy = 0.153		average validation NDCG = 0.696

epoch 3
average train loss = -0.567059    	average train batch reward = 0.632
validation accuracy = 0.188		average validation NDCG = 0.718

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -23.512659    	average train batch reward = 0.676
validation accuracy = 0.290		average validation NDCG = 0.774

epoch 2
average train loss = -149.580688    	average train batch reward = 0.693
validation accuracy = 0.279		average validation NDCG = 0.780

epoch 3
average train loss = -427.370728    	average train batch reward = 0.693
validation accuracy = 0.261		average validation NDCG = 0.777

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -31.454950    	average train batch reward = 0.714
validation accuracy = 0.288		average validation NDCG = 0.825

epoch 2
average train loss = -202.287888    	average train batch reward = 0.743
validation accuracy = 0.357		average validation NDCG = 0.833

epoch 3
average train loss = -367.626709    	average train batch reward = 0.747
validation accuracy = 0.401		average validation NDCG = 0.823

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -20.391985    	average train batch reward = 0.681
validation accuracy = 0.339		average validation NDCG = 0.800

epoch 2
average train loss = -128.282669    	average train batch reward = 0.728
validation accuracy = 0.356		average validation NDCG = 0.811

epoch 3
average train loss = -359.659149    	average train batch reward = 0.727
validation accuracy = 0.377		average validation NDCG = 0.811

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -44.111702    	average train batch reward = 0.682
validation accuracy = 0.157		average validation NDCG = 0.796

epoch 2
average train loss = -317.058807    	average train batch reward = 0.708
validation accuracy = 0.166		average validation NDCG = 0.796

epoch 3
average train loss = -926.965332    	average train batch reward = 0.709
validation accuracy = 0.167		average validation NDCG = 0.789

========
Currently the best setups are [(0.0001, 50, 0.2), (0.0001, 50, 0.0), (0.0001, 50, 1.0)], which got scores of [0.91976067048595278, 0.89916907557995585, 0.87176228240137021]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -23.991495    	average train batch reward = 0.752
validation accuracy = 0.507		average validation NDCG = 0.901

epoch 2
average train loss = -89.618553    	average train batch reward = 0.825
validation accuracy = 0.507		average validation NDCG = 0.907

epoch 3
average train loss = -184.477692    	average train batch reward = 0.832
validation accuracy = 0.542		average validation NDCG = 0.915

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -15.290962    	average train batch reward = 0.653
validation accuracy = 0.323		average validation NDCG = 0.776

epoch 2
average train loss = -199.888016    	average train batch reward = 0.696
validation accuracy = 0.309		average validation NDCG = 0.790

epoch 3
average train loss = -550.403503    	average train batch reward = 0.721
validation accuracy = 0.338		average validation NDCG = 0.804

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -5.690042    	average train batch reward = 0.700
validation accuracy = 0.321		average validation NDCG = 0.831

epoch 2
average train loss = -30.113186    	average train batch reward = 0.759
validation accuracy = 0.321		average validation NDCG = 0.830

epoch 3
average train loss = -71.620193    	average train batch reward = 0.765
validation accuracy = 0.374		average validation NDCG = 0.841

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -4.413525    	average train batch reward = 0.652
validation accuracy = 0.221		average validation NDCG = 0.753

epoch 2
average train loss = -23.315619    	average train batch reward = 0.679
validation accuracy = 0.220		average validation NDCG = 0.774

epoch 3
average train loss = -51.156090    	average train batch reward = 0.689
validation accuracy = 0.203		average validation NDCG = 0.775

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3.342319    	average train batch reward = 0.688
validation accuracy = 0.307		average validation NDCG = 0.824

epoch 2
average train loss = -12.959860    	average train batch reward = 0.754
validation accuracy = 0.428		average validation NDCG = 0.832

epoch 3
average train loss = -33.399006    	average train batch reward = 0.761
validation accuracy = 0.430		average validation NDCG = 0.837

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -5.965062    	average train batch reward = 0.698
validation accuracy = 0.252		average validation NDCG = 0.835

epoch 2
average train loss = -24.011232    	average train batch reward = 0.763
validation accuracy = 0.273		average validation NDCG = 0.851

epoch 3
average train loss = -55.203186    	average train batch reward = 0.769
validation accuracy = 0.261		average validation NDCG = 0.866

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -5.865536    	average train batch reward = 0.703
validation accuracy = 0.262		average validation NDCG = 0.804

epoch 2
average train loss = -32.614437    	average train batch reward = 0.717
validation accuracy = 0.212		average validation NDCG = 0.807

epoch 3
average train loss = -69.669304    	average train batch reward = 0.723
validation accuracy = 0.210		average validation NDCG = 0.809

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -6.862737    	average train batch reward = 0.741
validation accuracy = 0.365		average validation NDCG = 0.872

epoch 2
average train loss = -18.608437    	average train batch reward = 0.801
validation accuracy = 0.294		average validation NDCG = 0.887

epoch 3
average train loss = -46.984596    	average train batch reward = 0.801
validation accuracy = 0.383		average validation NDCG = 0.880

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.293724    	average train batch reward = 0.616
validation accuracy = 0.242		average validation NDCG = 0.769

epoch 2
average train loss = -2.155023    	average train batch reward = 0.709
validation accuracy = 0.425		average validation NDCG = 0.810

epoch 3
average train loss = -3.905068    	average train batch reward = 0.732
validation accuracy = 0.463		average validation NDCG = 0.822

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.709996    	average train batch reward = 0.633
validation accuracy = 0.225		average validation NDCG = 0.774

epoch 2
average train loss = -2.523688    	average train batch reward = 0.723
validation accuracy = 0.260		average validation NDCG = 0.848

epoch 3
average train loss = -5.162927    	average train batch reward = 0.780
validation accuracy = 0.326		average validation NDCG = 0.868

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.358255    	average train batch reward = 0.657
validation accuracy = 0.369		average validation NDCG = 0.791

epoch 2
average train loss = -2.243027    	average train batch reward = 0.752
validation accuracy = 0.456		average validation NDCG = 0.852

epoch 3
average train loss = -4.434588    	average train batch reward = 0.800
validation accuracy = 0.515		average validation NDCG = 0.877

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.355912    	average train batch reward = 0.613
validation accuracy = 0.244		average validation NDCG = 0.741

epoch 2
average train loss = -1.682262    	average train batch reward = 0.697
validation accuracy = 0.355		average validation NDCG = 0.813

epoch 3
average train loss = -3.860943    	average train batch reward = 0.746
validation accuracy = 0.412		average validation NDCG = 0.847

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.541101    	average train batch reward = 0.667
validation accuracy = 0.331		average validation NDCG = 0.782

epoch 2
average train loss = -2.064538    	average train batch reward = 0.719
validation accuracy = 0.380		average validation NDCG = 0.811

epoch 3
average train loss = -4.603605    	average train batch reward = 0.747
validation accuracy = 0.411		average validation NDCG = 0.838

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.454024    	average train batch reward = 0.625
validation accuracy = 0.294		average validation NDCG = 0.765

epoch 2
average train loss = -2.562585    	average train batch reward = 0.713
validation accuracy = 0.342		average validation NDCG = 0.810

epoch 3
average train loss = -4.413260    	average train batch reward = 0.743
validation accuracy = 0.377		average validation NDCG = 0.843

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -4076.210938    	average train batch reward = 0.628
validation accuracy = 0.155		average validation NDCG = 0.721

epoch 2
average train loss = -17645.353516    	average train batch reward = 0.641
validation accuracy = 0.170		average validation NDCG = 0.724

epoch 3
average train loss = -33152.496094    	average train batch reward = 0.640
validation accuracy = 0.181		average validation NDCG = 0.723

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3013.721436    	average train batch reward = 0.656
validation accuracy = 0.223		average validation NDCG = 0.747

epoch 2
average train loss = -23734.273438    	average train batch reward = 0.660
validation accuracy = 0.143		average validation NDCG = 0.750

epoch 3
average train loss = -44299.343750    	average train batch reward = 0.665
validation accuracy = 0.149		average validation NDCG = 0.748

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1964.323853    	average train batch reward = 0.622
validation accuracy = 0.107		average validation NDCG = 0.726

epoch 2
average train loss = -15097.742188    	average train batch reward = 0.645
validation accuracy = 0.140		average validation NDCG = 0.730

epoch 3
average train loss = -48633.113281    	average train batch reward = 0.648
validation accuracy = 0.129		average validation NDCG = 0.730

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2186.508545    	average train batch reward = 0.628
validation accuracy = 0.161		average validation NDCG = 0.719

epoch 2
average train loss = -17869.328125    	average train batch reward = 0.637
validation accuracy = 0.142		average validation NDCG = 0.724

epoch 3
average train loss = -59146.312500    	average train batch reward = 0.641
validation accuracy = 0.129		average validation NDCG = 0.728

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -2919.886963    	average train batch reward = 0.689
validation accuracy = 0.282		average validation NDCG = 0.786

epoch 2
average train loss = -15243.454102    	average train batch reward = 0.713
validation accuracy = 0.204		average validation NDCG = 0.804

epoch 3
average train loss = -42175.101562    	average train batch reward = 0.722
validation accuracy = 0.215		average validation NDCG = 0.807

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -431.277771    	average train batch reward = 0.604
validation accuracy = 0.133		average validation NDCG = 0.696

epoch 2
average train loss = -3352.838623    	average train batch reward = 0.611
validation accuracy = 0.136		average validation NDCG = 0.698

epoch 3
average train loss = -18796.486328    	average train batch reward = 0.616
validation accuracy = 0.175		average validation NDCG = 0.699

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -143.557693    	average train batch reward = 0.673
validation accuracy = 0.267		average validation NDCG = 0.773

epoch 2
average train loss = -1384.502075    	average train batch reward = 0.690
validation accuracy = 0.266		average validation NDCG = 0.770

epoch 3
average train loss = -3918.138916    	average train batch reward = 0.688
validation accuracy = 0.268		average validation NDCG = 0.774

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -174.286133    	average train batch reward = 0.639
validation accuracy = 0.188		average validation NDCG = 0.736

epoch 2
average train loss = -839.054565    	average train batch reward = 0.648
validation accuracy = 0.135		average validation NDCG = 0.731

epoch 3
average train loss = -2674.073486    	average train batch reward = 0.647
validation accuracy = 0.130		average validation NDCG = 0.736

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -94.410614    	average train batch reward = 0.727
validation accuracy = 0.299		average validation NDCG = 0.828

epoch 2
average train loss = -1317.033447    	average train batch reward = 0.735
validation accuracy = 0.357		average validation NDCG = 0.816

epoch 3
average train loss = -4425.187988    	average train batch reward = 0.746
validation accuracy = 0.327		average validation NDCG = 0.820

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -124.060669    	average train batch reward = 0.698
validation accuracy = 0.300		average validation NDCG = 0.802

epoch 2
average train loss = -1199.886841    	average train batch reward = 0.731
validation accuracy = 0.354		average validation NDCG = 0.804

epoch 3
average train loss = -3323.204102    	average train batch reward = 0.729
validation accuracy = 0.311		average validation NDCG = 0.799

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -327.815765    	average train batch reward = 0.666
validation accuracy = 0.261		average validation NDCG = 0.791

epoch 2
average train loss = -2862.682861    	average train batch reward = 0.718
validation accuracy = 0.234		average validation NDCG = 0.804

epoch 3
average train loss = -7431.824707    	average train batch reward = 0.718
validation accuracy = 0.178		average validation NDCG = 0.812

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -229.557007    	average train batch reward = 0.680
validation accuracy = 0.236		average validation NDCG = 0.772

epoch 2
average train loss = -1821.397705    	average train batch reward = 0.696
validation accuracy = 0.256		average validation NDCG = 0.772

epoch 3
average train loss = -5664.141602    	average train batch reward = 0.702
validation accuracy = 0.222		average validation NDCG = 0.787

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -4.520212    	average train batch reward = 0.702
validation accuracy = 0.428		average validation NDCG = 0.850

epoch 2
average train loss = -36.208351    	average train batch reward = 0.777
validation accuracy = 0.477		average validation NDCG = 0.863

epoch 3
average train loss = -84.176987    	average train batch reward = 0.784
validation accuracy = 0.460		average validation NDCG = 0.865

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -5.116808    	average train batch reward = 0.687
validation accuracy = 0.409		average validation NDCG = 0.834

epoch 2
average train loss = -36.794697    	average train batch reward = 0.768
validation accuracy = 0.355		average validation NDCG = 0.851

epoch 3
average train loss = -79.728821    	average train batch reward = 0.777
validation accuracy = 0.464		average validation NDCG = 0.849

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -4.859125    	average train batch reward = 0.650
validation accuracy = 0.323		average validation NDCG = 0.824

epoch 2
average train loss = -21.181334    	average train batch reward = 0.744
validation accuracy = 0.418		average validation NDCG = 0.853

epoch 3
average train loss = -64.703819    	average train batch reward = 0.771
validation accuracy = 0.435		average validation NDCG = 0.864

========
Currently the best setups are [(0.0001, 50, 0.2), (0.001, 50, 1.0), (0.0001, 50, 0.0)], which got scores of [0.91976067048595278, 0.91543106101854443, 0.89916907557995585]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3.744350    	average train batch reward = 0.717
validation accuracy = 0.481		average validation NDCG = 0.893

epoch 2
average train loss = -18.250652    	average train batch reward = 0.825
validation accuracy = 0.606		average validation NDCG = 0.910

epoch 3
average train loss = -54.575352    	average train batch reward = 0.837
validation accuracy = 0.552		average validation NDCG = 0.920

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3.634087    	average train batch reward = 0.689
validation accuracy = 0.390		average validation NDCG = 0.846

epoch 2
average train loss = -18.482517    	average train batch reward = 0.775
validation accuracy = 0.423		average validation NDCG = 0.872

epoch 3
average train loss = -47.656662    	average train batch reward = 0.789
validation accuracy = 0.439		average validation NDCG = 0.875

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -4.183604    	average train batch reward = 0.664
validation accuracy = 0.267		average validation NDCG = 0.810

epoch 2
average train loss = -26.514662    	average train batch reward = 0.738
validation accuracy = 0.351		average validation NDCG = 0.831

epoch 3
average train loss = -102.761559    	average train batch reward = 0.751
validation accuracy = 0.305		average validation NDCG = 0.835

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -55247.828125    	average train batch reward = 0.607
validation accuracy = 0.139		average validation NDCG = 0.698

epoch 2
average train loss = -698726.000000    	average train batch reward = 0.615
validation accuracy = 0.167		average validation NDCG = 0.699

epoch 3
average train loss = -886999.187500    	average train batch reward = 0.614
validation accuracy = 0.194		average validation NDCG = 0.700

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 1.032201    	average train batch reward = 0.588
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 2
average train loss = 0.000000    	average train batch reward = 0.586
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 3
average train loss = 0.000000    	average train batch reward = 0.588
validation accuracy = 0.096		average validation NDCG = 0.672

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 3.251638    	average train batch reward = 0.587
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 2
average train loss = 0.000000    	average train batch reward = 0.587
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 3
average train loss = 0.000000    	average train batch reward = 0.589
validation accuracy = 0.096		average validation NDCG = 0.672

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -369810.281250    	average train batch reward = 0.649
validation accuracy = 0.122		average validation NDCG = 0.753

epoch 2
average train loss = -2465775.000000    	average train batch reward = 0.663
validation accuracy = 0.182		average validation NDCG = 0.751

epoch 3
average train loss = -3680180.000000    	average train batch reward = 0.668
validation accuracy = 0.165		average validation NDCG = 0.754

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -222949.125000    	average train batch reward = 0.638
validation accuracy = 0.114		average validation NDCG = 0.734

epoch 2
average train loss = -1274644.500000    	average train batch reward = 0.663
validation accuracy = 0.211		average validation NDCG = 0.751

epoch 3
average train loss = -3602205.500000    	average train batch reward = 0.670
validation accuracy = 0.113		average validation NDCG = 0.756

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -584080.687500    	average train batch reward = 0.647
validation accuracy = 0.205		average validation NDCG = 0.731

epoch 2
average train loss = -3502720.500000    	average train batch reward = 0.654
validation accuracy = 0.205		average validation NDCG = 0.732

epoch 3
average train loss = -5477756.000000    	average train batch reward = 0.656
validation accuracy = 0.207		average validation NDCG = 0.732

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -13472.949219    	average train batch reward = 0.665
validation accuracy = 0.297		average validation NDCG = 0.778

epoch 2
average train loss = -87250.789062    	average train batch reward = 0.703
validation accuracy = 0.286		average validation NDCG = 0.787

epoch 3
average train loss = -274986.750000    	average train batch reward = 0.709
validation accuracy = 0.339		average validation NDCG = 0.787

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -8643.330078    	average train batch reward = 0.632
validation accuracy = 0.098		average validation NDCG = 0.707

epoch 2
average train loss = -92331.273438    	average train batch reward = 0.635
validation accuracy = 0.124		average validation NDCG = 0.727

epoch 3
average train loss = -320529.156250    	average train batch reward = 0.654
validation accuracy = 0.175		average validation NDCG = 0.732

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -8488.015625    	average train batch reward = 0.609
validation accuracy = 0.114		average validation NDCG = 0.702

epoch 2
average train loss = -141040.953125    	average train batch reward = 0.617
validation accuracy = 0.115		average validation NDCG = 0.702

epoch 3
average train loss = -361856.687500    	average train batch reward = 0.619
validation accuracy = 0.121		average validation NDCG = 0.703

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -14996.165039    	average train batch reward = 0.631
validation accuracy = 0.182		average validation NDCG = 0.734

epoch 2
average train loss = -101884.328125    	average train batch reward = 0.664
validation accuracy = 0.189		average validation NDCG = 0.750

epoch 3
average train loss = -380973.406250    	average train batch reward = 0.666
validation accuracy = 0.184		average validation NDCG = 0.744

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -15413.948242    	average train batch reward = 0.648
validation accuracy = 0.142		average validation NDCG = 0.724

epoch 2
average train loss = -216287.031250    	average train batch reward = 0.656
validation accuracy = 0.144		average validation NDCG = 0.746

epoch 3
average train loss = -662389.125000    	average train batch reward = 0.668
validation accuracy = 0.128		average validation NDCG = 0.749

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -12227.205078    	average train batch reward = 0.683
validation accuracy = 0.099		average validation NDCG = 0.766

epoch 2
average train loss = -82399.859375    	average train batch reward = 0.706
validation accuracy = 0.135		average validation NDCG = 0.795

epoch 3
average train loss = -280249.500000    	average train batch reward = 0.719
validation accuracy = 0.174		average validation NDCG = 0.797

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -108.775124    	average train batch reward = 0.663
validation accuracy = 0.244		average validation NDCG = 0.801

epoch 2
average train loss = -1380.804077    	average train batch reward = 0.723
validation accuracy = 0.364		average validation NDCG = 0.804

epoch 3
average train loss = -6439.978516    	average train batch reward = 0.726
validation accuracy = 0.290		average validation NDCG = 0.804

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -83.892464    	average train batch reward = 0.669
validation accuracy = 0.381		average validation NDCG = 0.785

epoch 2
average train loss = -1290.094238    	average train batch reward = 0.716
validation accuracy = 0.336		average validation NDCG = 0.787

epoch 3
average train loss = -4132.536621    	average train batch reward = 0.720
validation accuracy = 0.357		average validation NDCG = 0.801

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -95.955811    	average train batch reward = 0.668
validation accuracy = 0.225		average validation NDCG = 0.807

epoch 2
average train loss = -1385.933838    	average train batch reward = 0.733
validation accuracy = 0.332		average validation NDCG = 0.827

epoch 3
average train loss = -5518.124023    	average train batch reward = 0.745
validation accuracy = 0.327		average validation NDCG = 0.835

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -55.223625    	average train batch reward = 0.661
validation accuracy = 0.255		average validation NDCG = 0.786

epoch 2
average train loss = -1285.945557    	average train batch reward = 0.723
validation accuracy = 0.291		average validation NDCG = 0.793

epoch 3
average train loss = -4712.991699    	average train batch reward = 0.729
validation accuracy = 0.314		average validation NDCG = 0.816

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -39.656334    	average train batch reward = 0.634
validation accuracy = 0.406		average validation NDCG = 0.781

epoch 2
average train loss = -693.406128    	average train batch reward = 0.712
validation accuracy = 0.261		average validation NDCG = 0.804

epoch 3
average train loss = -2267.482422    	average train batch reward = 0.729
validation accuracy = 0.300		average validation NDCG = 0.813

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -73.808594    	average train batch reward = 0.653
validation accuracy = 0.251		average validation NDCG = 0.772

epoch 2
average train loss = -1029.840820    	average train batch reward = 0.688
validation accuracy = 0.271		average validation NDCG = 0.770

epoch 3
average train loss = -4333.204102    	average train batch reward = 0.690
validation accuracy = 0.262		average validation NDCG = 0.773

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 968.251831    	average train batch reward = 0.586
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 2
average train loss = 0.000000    	average train batch reward = 0.588
validation accuracy = 0.096		average validation NDCG = 0.672

epoch 3
average train loss = 0.000000    	average train batch reward = 0.588
validation accuracy = 0.096		average validation NDCG = 0.672

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -5204957.000000    	average train batch reward = 0.637
validation accuracy = 0.216		average validation NDCG = 0.731

epoch 2
average train loss = -19998892.000000    	average train batch reward = 0.668
validation accuracy = 0.273		average validation NDCG = 0.761

epoch 3
average train loss = -120678616.000000    	average train batch reward = 0.681
validation accuracy = 0.272		average validation NDCG = 0.768

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -13784681.000000    	average train batch reward = 0.614
validation accuracy = 0.096		average validation NDCG = 0.703

epoch 2
average train loss = -144461776.000000    	average train batch reward = 0.619
validation accuracy = 0.096		average validation NDCG = 0.703

epoch 3
average train loss = -321471680.000000    	average train batch reward = 0.618
validation accuracy = 0.096		average validation NDCG = 0.703

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -32078062.000000    	average train batch reward = 0.617
validation accuracy = 0.096		average validation NDCG = 0.703

epoch 2
average train loss = -244214544.000000    	average train batch reward = 0.620
validation accuracy = 0.096		average validation NDCG = 0.703

epoch 3
average train loss = -605352448.000000    	average train batch reward = 0.618
validation accuracy = 0.096		average validation NDCG = 0.703

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -15905608.000000    	average train batch reward = 0.615
validation accuracy = 0.126		average validation NDCG = 0.716

epoch 2
average train loss = -116612752.000000    	average train batch reward = 0.637
validation accuracy = 0.134		average validation NDCG = 0.726

epoch 3
average train loss = -394675328.000000    	average train batch reward = 0.645
validation accuracy = 0.125		average validation NDCG = 0.729

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 50
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -26080534.000000    	average train batch reward = 0.616
validation accuracy = 0.131		average validation NDCG = 0.703

epoch 2
average train loss = -181746960.000000    	average train batch reward = 0.619
validation accuracy = 0.122		average validation NDCG = 0.703

epoch 3
average train loss = -235121376.000000    	average train batch reward = 0.617
validation accuracy = 0.121		average validation NDCG = 0.703

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -308908.968750    	average train batch reward = 0.634
validation accuracy = 0.170		average validation NDCG = 0.739

epoch 2
average train loss = -4500965.500000    	average train batch reward = 0.658
validation accuracy = 0.259		average validation NDCG = 0.749

epoch 3
average train loss = -10535163.000000    	average train batch reward = 0.663
validation accuracy = 0.264		average validation NDCG = 0.753

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1002532.000000    	average train batch reward = 0.662
validation accuracy = 0.166		average validation NDCG = 0.765

epoch 2
average train loss = -13282159.000000    	average train batch reward = 0.675
validation accuracy = 0.210		average validation NDCG = 0.757

epoch 3
average train loss = -58555128.000000    	average train batch reward = 0.678
validation accuracy = 0.171		average validation NDCG = 0.759

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -788873.875000    	average train batch reward = 0.649
validation accuracy = 0.188		average validation NDCG = 0.734

epoch 2
average train loss = -9923329.000000    	average train batch reward = 0.663
validation accuracy = 0.193		average validation NDCG = 0.759

epoch 3
average train loss = -52151352.000000    	average train batch reward = 0.672
validation accuracy = 0.198		average validation NDCG = 0.756

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -884964.500000    	average train batch reward = 0.652
validation accuracy = 0.202		average validation NDCG = 0.738

epoch 2
average train loss = -13373627.000000    	average train batch reward = 0.664
validation accuracy = 0.192		average validation NDCG = 0.738

epoch 3
average train loss = -34529320.000000    	average train batch reward = 0.662
validation accuracy = 0.206		average validation NDCG = 0.739

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -1901648.500000    	average train batch reward = 0.632
validation accuracy = 0.199		average validation NDCG = 0.729

epoch 2
average train loss = -15742465.000000    	average train batch reward = 0.648
validation accuracy = 0.197		average validation NDCG = 0.727

epoch 3
average train loss = -53533548.000000    	average train batch reward = 0.644
validation accuracy = 0.196		average validation NDCG = 0.727

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 512
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -441522.593750    	average train batch reward = 0.616
validation accuracy = 0.168		average validation NDCG = 0.698

epoch 2
average train loss = -8333675.500000    	average train batch reward = 0.622
validation accuracy = 0.206		average validation NDCG = 0.701

epoch 3
average train loss = -27707854.000000    	average train batch reward = 0.622
validation accuracy = 0.207		average validation NDCG = 0.701

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -4052.994873    	average train batch reward = 0.610
validation accuracy = 0.273		average validation NDCG = 0.723

epoch 2
average train loss = -84705.656250    	average train batch reward = 0.657
validation accuracy = 0.307		average validation NDCG = 0.734

epoch 3
average train loss = -222433.656250    	average train batch reward = 0.656
validation accuracy = 0.265		average validation NDCG = 0.738

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.050000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -11299.768555    	average train batch reward = 0.660
validation accuracy = 0.243		average validation NDCG = 0.778

epoch 2
average train loss = -170652.281250    	average train batch reward = 0.681
validation accuracy = 0.209		average validation NDCG = 0.762

epoch 3
average train loss = -658698.625000    	average train batch reward = 0.679
validation accuracy = 0.165		average validation NDCG = 0.766

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -3877.163086    	average train batch reward = 0.606
validation accuracy = 0.269		average validation NDCG = 0.733

epoch 2
average train loss = -64452.964844    	average train batch reward = 0.682
validation accuracy = 0.309		average validation NDCG = 0.779

epoch 3
average train loss = -317157.812500    	average train batch reward = 0.705
validation accuracy = 0.321		average validation NDCG = 0.785

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -4063.915283    	average train batch reward = 0.631
validation accuracy = 0.212		average validation NDCG = 0.774

epoch 2
average train loss = -79020.687500    	average train batch reward = 0.695
validation accuracy = 0.324		average validation NDCG = 0.794

epoch 3
average train loss = -460717.468750    	average train batch reward = 0.713
validation accuracy = 0.333		average validation NDCG = 0.794

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -7734.001465    	average train batch reward = 0.631
validation accuracy = 0.275		average validation NDCG = 0.755

epoch 2
average train loss = -105918.843750    	average train batch reward = 0.682
validation accuracy = 0.303		average validation NDCG = 0.776

epoch 3
average train loss = -301841.906250    	average train batch reward = 0.690
validation accuracy = 0.359		average validation NDCG = 0.779

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
Hyperparameters:
k = 7
Batch size = 5012
Num epochs = 3
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2ac4353bf0c8>
Reward function = <function ndcg_full at 0x2ac4353bf140>
Greedy action = <function sample at 0x2ac42e213758>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -4390.249512    	average train batch reward = 0.621
validation accuracy = 0.172		average validation NDCG = 0.733

epoch 2
average train loss = -63186.703125    	average train batch reward = 0.658
validation accuracy = 0.248		average validation NDCG = 0.743

epoch 3
average train loss = -254207.187500    	average train batch reward = 0.664
validation accuracy = 0.194		average validation NDCG = 0.751

========
Currently the best setups are [(0.0001, 50, 0.2), (0.01, 5012, 0.5), (0.001, 50, 1.0)], which got scores of [0.91976067048595278, 0.91954076065055845, 0.91543106101854443]
========
2017-06-30 15:11:00
