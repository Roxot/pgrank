2017-07-03 06:33:18
Finding best parameters for k = 3
=========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.002136    	average train batch reward = 0.740
validation accuracy = 0.086		average validation NDCG = 0.675

epoch 2
average train loss = 0.001895    	average train batch reward = 0.743
validation accuracy = 0.088		average validation NDCG = 0.677

epoch 3
average train loss = 0.000000    	average train batch reward = 0.744
validation accuracy = 0.091		average validation NDCG = 0.678

========
Currently the best setups are [(9.9999999999999995e-07, 0.1, 0.0), (), ()], which got scores of [0.67807687865188959, -1, -1]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.003290    	average train batch reward = 0.757
validation accuracy = 0.133		average validation NDCG = 0.690

epoch 2
average train loss = 0.000625    	average train batch reward = 0.757
validation accuracy = 0.135		average validation NDCG = 0.691

epoch 3
average train loss = 0.003858    	average train batch reward = 0.759
validation accuracy = 0.138		average validation NDCG = 0.693

========
Currently the best setups are [(9.9999999999999995e-07, 0.1, 0.2), (9.9999999999999995e-07, 0.1, 0.0), ()], which got scores of [0.69307156624254429, 0.67807687865188959, -1]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.000828    	average train batch reward = 0.749
validation accuracy = 0.091		average validation NDCG = 0.676

epoch 2
average train loss = 0.002774    	average train batch reward = 0.752
validation accuracy = 0.092		average validation NDCG = 0.678

epoch 3
average train loss = 0.001541    	average train batch reward = 0.754
validation accuracy = 0.092		average validation NDCG = 0.679

========
Currently the best setups are [(9.9999999999999995e-07, 0.1, 0.2), (9.9999999999999995e-07, 0.1, 0.5), (9.9999999999999995e-07, 0.1, 0.0)], which got scores of [0.69307156624254429, 0.67928166872384588, 0.67807687865188959]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.000256    	average train batch reward = 0.740
validation accuracy = 0.096		average validation NDCG = 0.666

epoch 2
average train loss = 0.000967    	average train batch reward = 0.741
validation accuracy = 0.098		average validation NDCG = 0.667

epoch 3
average train loss = 0.002838    	average train batch reward = 0.743
validation accuracy = 0.099		average validation NDCG = 0.669

========
Currently the best setups are [(9.9999999999999995e-07, 0.1, 0.2), (9.9999999999999995e-07, 0.1, 0.5), (9.9999999999999995e-07, 0.1, 0.0)], which got scores of [0.69307156624254429, 0.67928166872384588, 0.67807687865188959]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.000694    	average train batch reward = 0.729
validation accuracy = 0.089		average validation NDCG = 0.666

epoch 2
average train loss = 0.000358    	average train batch reward = 0.732
validation accuracy = 0.093		average validation NDCG = 0.667

epoch 3
average train loss = -0.001587    	average train batch reward = 0.735
validation accuracy = 0.094		average validation NDCG = 0.669

========
Currently the best setups are [(9.9999999999999995e-07, 0.1, 0.2), (9.9999999999999995e-07, 0.1, 0.5), (9.9999999999999995e-07, 0.1, 0.0)], which got scores of [0.69307156624254429, 0.67928166872384588, 0.67807687865188959]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.001593    	average train batch reward = 0.749
validation accuracy = 0.115		average validation NDCG = 0.682

epoch 2
average train loss = -0.000148    	average train batch reward = 0.752
validation accuracy = 0.115		average validation NDCG = 0.684

epoch 3
average train loss = 0.000186    	average train batch reward = 0.755
validation accuracy = 0.115		average validation NDCG = 0.687

========
Currently the best setups are [(9.9999999999999995e-07, 0.1, 0.2), (9.9999999999999995e-07, 0.25, 0.0), (9.9999999999999995e-07, 0.1, 0.5)], which got scores of [0.69307156624254429, 0.68716257433099348, 0.67928166872384588]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.001885    	average train batch reward = 0.740
validation accuracy = 0.090		average validation NDCG = 0.672

epoch 2
average train loss = -0.001726    	average train batch reward = 0.741
validation accuracy = 0.091		average validation NDCG = 0.674

epoch 3
average train loss = -0.001778    	average train batch reward = 0.741
validation accuracy = 0.092		average validation NDCG = 0.675

========
Currently the best setups are [(9.9999999999999995e-07, 0.1, 0.2), (9.9999999999999995e-07, 0.25, 0.0), (9.9999999999999995e-07, 0.1, 0.5)], which got scores of [0.69307156624254429, 0.68716257433099348, 0.67928166872384588]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.000857    	average train batch reward = 0.731
validation accuracy = 0.089		average validation NDCG = 0.654

epoch 2
average train loss = -0.000372    	average train batch reward = 0.734
validation accuracy = 0.090		average validation NDCG = 0.656

epoch 3
average train loss = 0.000776    	average train batch reward = 0.734
validation accuracy = 0.090		average validation NDCG = 0.658

========
Currently the best setups are [(9.9999999999999995e-07, 0.1, 0.2), (9.9999999999999995e-07, 0.25, 0.0), (9.9999999999999995e-07, 0.1, 0.5)], which got scores of [0.69307156624254429, 0.68716257433099348, 0.67928166872384588]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.001398    	average train batch reward = 0.750
validation accuracy = 0.125		average validation NDCG = 0.677

epoch 2
average train loss = 0.000275    	average train batch reward = 0.754
validation accuracy = 0.129		average validation NDCG = 0.679

epoch 3
average train loss = -0.000808    	average train batch reward = 0.755
validation accuracy = 0.132		average validation NDCG = 0.682

========
Currently the best setups are [(9.9999999999999995e-07, 0.1, 0.2), (9.9999999999999995e-07, 0.25, 0.0), (9.9999999999999995e-07, 0.25, 1.0)], which got scores of [0.69307156624254429, 0.68716257433099348, 0.68235428164077327]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.002038    	average train batch reward = 0.754
validation accuracy = 0.116		average validation NDCG = 0.689

epoch 2
average train loss = 0.001581    	average train batch reward = 0.756
validation accuracy = 0.119		average validation NDCG = 0.691

epoch 3
average train loss = 0.000754    	average train batch reward = 0.759
validation accuracy = 0.124		average validation NDCG = 0.694

========
Currently the best setups are [(9.9999999999999995e-07, 0.25, 1.5), (9.9999999999999995e-07, 0.1, 0.2), (9.9999999999999995e-07, 0.25, 1.0)], which got scores of [0.69359779575345937, 0.69307156624254429, 0.68235428164077327]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.000746    	average train batch reward = 0.746
validation accuracy = 0.046		average validation NDCG = 0.691

epoch 2
average train loss = -0.002538    	average train batch reward = 0.746
validation accuracy = 0.047		average validation NDCG = 0.692

epoch 3
average train loss = 0.001065    	average train batch reward = 0.746
validation accuracy = 0.049		average validation NDCG = 0.694

========
Currently the best setups are [(9.9999999999999995e-07, 0.5, 0.0), (9.9999999999999995e-07, 0.25, 1.5), (9.9999999999999995e-07, 0.25, 1.0)], which got scores of [0.69376686026641887, 0.69359779575345937, 0.68235428164077327]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.002120    	average train batch reward = 0.748
validation accuracy = 0.169		average validation NDCG = 0.684

epoch 2
average train loss = 0.000806    	average train batch reward = 0.750
validation accuracy = 0.170		average validation NDCG = 0.686

epoch 3
average train loss = 0.002384    	average train batch reward = 0.752
validation accuracy = 0.172		average validation NDCG = 0.688

========
Currently the best setups are [(9.9999999999999995e-07, 0.5, 0.0), (9.9999999999999995e-07, 0.25, 1.5), (9.9999999999999995e-07, 0.5, 0.2)], which got scores of [0.69376686026641887, 0.69359779575345937, 0.68756396250568275]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.001602    	average train batch reward = 0.737
validation accuracy = 0.093		average validation NDCG = 0.658

epoch 2
average train loss = -0.000027    	average train batch reward = 0.737
validation accuracy = 0.095		average validation NDCG = 0.660

epoch 3
average train loss = 0.001724    	average train batch reward = 0.741
validation accuracy = 0.096		average validation NDCG = 0.662

========
Currently the best setups are [(9.9999999999999995e-07, 0.5, 0.0), (9.9999999999999995e-07, 0.25, 1.5), (9.9999999999999995e-07, 0.5, 0.2)], which got scores of [0.69376686026641887, 0.69359779575345937, 0.68756396250568275]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.000313    	average train batch reward = 0.738
validation accuracy = 0.090		average validation NDCG = 0.665

epoch 2
average train loss = -0.000400    	average train batch reward = 0.742
validation accuracy = 0.092		average validation NDCG = 0.667

epoch 3
average train loss = 0.002178    	average train batch reward = 0.741
validation accuracy = 0.094		average validation NDCG = 0.669

========
Currently the best setups are [(9.9999999999999995e-07, 0.5, 0.0), (9.9999999999999995e-07, 0.25, 1.5), (9.9999999999999995e-07, 0.5, 0.2)], which got scores of [0.69376686026641887, 0.69359779575345937, 0.68756396250568275]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.000597    	average train batch reward = 0.745
validation accuracy = 0.105		average validation NDCG = 0.692

epoch 2
average train loss = 0.000461    	average train batch reward = 0.748
validation accuracy = 0.105		average validation NDCG = 0.694

epoch 3
average train loss = 0.000205    	average train batch reward = 0.749
validation accuracy = 0.106		average validation NDCG = 0.696

========
Currently the best setups are [(9.9999999999999995e-07, 0.5, 1.5), (9.9999999999999995e-07, 0.5, 0.0), (9.9999999999999995e-07, 0.5, 0.2)], which got scores of [0.69625556406782141, 0.69376686026641887, 0.68756396250568275]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.001159    	average train batch reward = 0.744
validation accuracy = 0.173		average validation NDCG = 0.680

epoch 2
average train loss = 0.005894    	average train batch reward = 0.747
validation accuracy = 0.174		average validation NDCG = 0.682

epoch 3
average train loss = -0.000433    	average train batch reward = 0.745
validation accuracy = 0.176		average validation NDCG = 0.684

========
Currently the best setups are [(9.9999999999999995e-07, 0.5, 1.5), (9.9999999999999995e-07, 0.5, 0.0), (9.9999999999999995e-07, 0.5, 0.2)], which got scores of [0.69625556406782141, 0.69376686026641887, 0.68756396250568275]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.001935    	average train batch reward = 0.737
validation accuracy = 0.100		average validation NDCG = 0.669

epoch 2
average train loss = 0.000242    	average train batch reward = 0.742
validation accuracy = 0.102		average validation NDCG = 0.671

epoch 3
average train loss = -0.000782    	average train batch reward = 0.741
validation accuracy = 0.105		average validation NDCG = 0.672

========
Currently the best setups are [(9.9999999999999995e-07, 0.5, 1.5), (9.9999999999999995e-07, 0.5, 0.0), (9.9999999999999995e-07, 0.5, 0.2)], which got scores of [0.69625556406782141, 0.69376686026641887, 0.68756396250568275]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.003783    	average train batch reward = 0.748
validation accuracy = 0.124		average validation NDCG = 0.683

epoch 2
average train loss = 0.002377    	average train batch reward = 0.749
validation accuracy = 0.126		average validation NDCG = 0.685

epoch 3
average train loss = 0.004815    	average train batch reward = 0.751
validation accuracy = 0.128		average validation NDCG = 0.687

========
Currently the best setups are [(9.9999999999999995e-07, 0.5, 1.5), (9.9999999999999995e-07, 0.5, 0.0), (9.9999999999999995e-07, 0.5, 0.2)], which got scores of [0.69625556406782141, 0.69376686026641887, 0.68756396250568275]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.001552    	average train batch reward = 0.743
validation accuracy = 0.139		average validation NDCG = 0.671

epoch 2
average train loss = 0.000538    	average train batch reward = 0.745
validation accuracy = 0.141		average validation NDCG = 0.673

epoch 3
average train loss = 0.001712    	average train batch reward = 0.747
validation accuracy = 0.141		average validation NDCG = 0.675

========
Currently the best setups are [(9.9999999999999995e-07, 0.5, 1.5), (9.9999999999999995e-07, 0.5, 0.0), (9.9999999999999995e-07, 0.5, 0.2)], which got scores of [0.69625556406782141, 0.69376686026641887, 0.68756396250568275]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000001
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.000194    	average train batch reward = 0.742
validation accuracy = 0.079		average validation NDCG = 0.668

epoch 2
average train loss = -0.001307    	average train batch reward = 0.742
validation accuracy = 0.080		average validation NDCG = 0.669

epoch 3
average train loss = -0.002257    	average train batch reward = 0.741
validation accuracy = 0.083		average validation NDCG = 0.671

========
Currently the best setups are [(9.9999999999999995e-07, 0.5, 1.5), (9.9999999999999995e-07, 0.5, 0.0), (9.9999999999999995e-07, 0.5, 0.2)], which got scores of [0.69625556406782141, 0.69376686026641887, 0.68756396250568275]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.000849    	average train batch reward = 0.752
validation accuracy = 0.167		average validation NDCG = 0.691

epoch 2
average train loss = 0.002123    	average train batch reward = 0.772
validation accuracy = 0.210		average validation NDCG = 0.715

epoch 3
average train loss = 0.005586    	average train batch reward = 0.790
validation accuracy = 0.248		average validation NDCG = 0.738

========
Currently the best setups are [(1.0000000000000001e-05, 0.1, 0.0), (9.9999999999999995e-07, 0.5, 1.5), (9.9999999999999995e-07, 0.5, 0.2)], which got scores of [0.73806218593902817, 0.69625556406782141, 0.68756396250568275]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.001766    	average train batch reward = 0.758
validation accuracy = 0.120		average validation NDCG = 0.705

epoch 2
average train loss = -0.001547    	average train batch reward = 0.779
validation accuracy = 0.140		average validation NDCG = 0.727

epoch 3
average train loss = 0.002260    	average train batch reward = 0.798
validation accuracy = 0.167		average validation NDCG = 0.752

========
Currently the best setups are [(1.0000000000000001e-05, 0.1, 0.2), (1.0000000000000001e-05, 0.1, 0.0), (9.9999999999999995e-07, 0.5, 0.2)], which got scores of [0.75233227288029503, 0.73806218593902817, 0.68756396250568275]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.000909    	average train batch reward = 0.742
validation accuracy = 0.099		average validation NDCG = 0.675

epoch 2
average train loss = 0.001019    	average train batch reward = 0.765
validation accuracy = 0.140		average validation NDCG = 0.699

epoch 3
average train loss = 0.006484    	average train batch reward = 0.788
validation accuracy = 0.192		average validation NDCG = 0.726

========
Currently the best setups are [(1.0000000000000001e-05, 0.1, 0.2), (1.0000000000000001e-05, 0.1, 0.0), (1.0000000000000001e-05, 0.1, 0.5)], which got scores of [0.75233227288029503, 0.73806218593902817, 0.72647711630801437]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.003319    	average train batch reward = 0.764
validation accuracy = 0.150		average validation NDCG = 0.694

epoch 2
average train loss = 0.008615    	average train batch reward = 0.785
validation accuracy = 0.183		average validation NDCG = 0.723

epoch 3
average train loss = 0.004579    	average train batch reward = 0.803
validation accuracy = 0.205		average validation NDCG = 0.748

========
Currently the best setups are [(1.0000000000000001e-05, 0.1, 0.2), (1.0000000000000001e-05, 0.1, 1.0), (1.0000000000000001e-05, 0.1, 0.0)], which got scores of [0.75233227288029503, 0.74764706242120893, 0.73806218593902817]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.001057    	average train batch reward = 0.754
validation accuracy = 0.079		average validation NDCG = 0.701

epoch 2
average train loss = -0.000388    	average train batch reward = 0.778
validation accuracy = 0.096		average validation NDCG = 0.728

epoch 3
average train loss = 0.004459    	average train batch reward = 0.800
validation accuracy = 0.118		average validation NDCG = 0.756

========
Currently the best setups are [(1.0000000000000001e-05, 0.1, 1.5), (1.0000000000000001e-05, 0.1, 0.2), (1.0000000000000001e-05, 0.1, 0.0)], which got scores of [0.75582877672159565, 0.75233227288029503, 0.73806218593902817]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.002651    	average train batch reward = 0.754
validation accuracy = 0.173		average validation NDCG = 0.697

epoch 2
average train loss = 0.002823    	average train batch reward = 0.775
validation accuracy = 0.220		average validation NDCG = 0.725

epoch 3
average train loss = 0.003841    	average train batch reward = 0.796
validation accuracy = 0.275		average validation NDCG = 0.756

========
Currently the best setups are [(1.0000000000000001e-05, 0.25, 0.0), (1.0000000000000001e-05, 0.1, 1.5), (1.0000000000000001e-05, 0.1, 0.0)], which got scores of [0.7562992660949488, 0.75582877672159565, 0.73806218593902817]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.001562    	average train batch reward = 0.742
validation accuracy = 0.119		average validation NDCG = 0.686

epoch 2
average train loss = 0.002692    	average train batch reward = 0.760
validation accuracy = 0.159		average validation NDCG = 0.707

epoch 3
average train loss = 0.003999    	average train batch reward = 0.775
validation accuracy = 0.208		average validation NDCG = 0.726

========
Currently the best setups are [(1.0000000000000001e-05, 0.25, 0.0), (1.0000000000000001e-05, 0.1, 1.5), (1.0000000000000001e-05, 0.1, 0.0)], which got scores of [0.7562992660949488, 0.75582877672159565, 0.73806218593902817]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.000774    	average train batch reward = 0.754
validation accuracy = 0.122		average validation NDCG = 0.703

epoch 2
average train loss = 0.001724    	average train batch reward = 0.773
validation accuracy = 0.171		average validation NDCG = 0.738

epoch 3
average train loss = 0.002106    	average train batch reward = 0.792
validation accuracy = 0.221		average validation NDCG = 0.771

========
Currently the best setups are [(1.0000000000000001e-05, 0.25, 0.5), (1.0000000000000001e-05, 0.25, 0.0), (1.0000000000000001e-05, 0.1, 0.0)], which got scores of [0.77085619907019942, 0.7562992660949488, 0.73806218593902817]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.001188    	average train batch reward = 0.752
validation accuracy = 0.137		average validation NDCG = 0.690

epoch 2
average train loss = 0.004675    	average train batch reward = 0.767
validation accuracy = 0.165		average validation NDCG = 0.712

epoch 3
average train loss = 0.003081    	average train batch reward = 0.782
validation accuracy = 0.195		average validation NDCG = 0.731

========
Currently the best setups are [(1.0000000000000001e-05, 0.25, 0.5), (1.0000000000000001e-05, 0.25, 0.0), (1.0000000000000001e-05, 0.1, 0.0)], which got scores of [0.77085619907019942, 0.7562992660949488, 0.73806218593902817]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.002162    	average train batch reward = 0.728
validation accuracy = 0.086		average validation NDCG = 0.667

epoch 2
average train loss = 0.001155    	average train batch reward = 0.746
validation accuracy = 0.112		average validation NDCG = 0.690

epoch 3
average train loss = 0.004973    	average train batch reward = 0.764
validation accuracy = 0.141		average validation NDCG = 0.714

========
Currently the best setups are [(1.0000000000000001e-05, 0.25, 0.5), (1.0000000000000001e-05, 0.25, 0.0), (1.0000000000000001e-05, 0.1, 0.0)], which got scores of [0.77085619907019942, 0.7562992660949488, 0.73806218593902817]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.000744    	average train batch reward = 0.747
validation accuracy = 0.128		average validation NDCG = 0.700

epoch 2
average train loss = 0.000662    	average train batch reward = 0.759
validation accuracy = 0.183		average validation NDCG = 0.725

epoch 3
average train loss = 0.002551    	average train batch reward = 0.769
validation accuracy = 0.221		average validation NDCG = 0.749

========
Currently the best setups are [(1.0000000000000001e-05, 0.25, 0.5), (1.0000000000000001e-05, 0.25, 0.0), (1.0000000000000001e-05, 0.5, 0.0)], which got scores of [0.77085619907019942, 0.7562992660949488, 0.74947455582194478]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.000853    	average train batch reward = 0.744
validation accuracy = 0.106		average validation NDCG = 0.686

epoch 2
average train loss = 0.000475    	average train batch reward = 0.755
validation accuracy = 0.122		average validation NDCG = 0.706

epoch 3
average train loss = 0.003746    	average train batch reward = 0.768
validation accuracy = 0.137		average validation NDCG = 0.729

========
Currently the best setups are [(1.0000000000000001e-05, 0.25, 0.5), (1.0000000000000001e-05, 0.25, 0.0), (1.0000000000000001e-05, 0.5, 0.0)], which got scores of [0.77085619907019942, 0.7562992660949488, 0.74947455582194478]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.002211    	average train batch reward = 0.748
validation accuracy = 0.131		average validation NDCG = 0.702

epoch 2
average train loss = 0.001227    	average train batch reward = 0.763
validation accuracy = 0.166		average validation NDCG = 0.732

epoch 3
average train loss = 0.002549    	average train batch reward = 0.776
validation accuracy = 0.193		average validation NDCG = 0.756

========
Currently the best setups are [(1.0000000000000001e-05, 0.25, 0.5), (1.0000000000000001e-05, 0.25, 0.0), (1.0000000000000001e-05, 0.5, 0.5)], which got scores of [0.77085619907019942, 0.7562992660949488, 0.7559219334285]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.001547    	average train batch reward = 0.758
validation accuracy = 0.140		average validation NDCG = 0.712

epoch 2
average train loss = 0.002633    	average train batch reward = 0.771
validation accuracy = 0.195		average validation NDCG = 0.736

epoch 3
average train loss = 0.001650    	average train batch reward = 0.780
validation accuracy = 0.243		average validation NDCG = 0.755

========
Currently the best setups are [(1.0000000000000001e-05, 0.25, 0.5), (1.0000000000000001e-05, 0.25, 0.0), (1.0000000000000001e-05, 0.5, 0.5)], which got scores of [0.77085619907019942, 0.7562992660949488, 0.7559219334285]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.001655    	average train batch reward = 0.739
validation accuracy = 0.132		average validation NDCG = 0.689

epoch 2
average train loss = -0.001341    	average train batch reward = 0.753
validation accuracy = 0.151		average validation NDCG = 0.713

epoch 3
average train loss = 0.002952    	average train batch reward = 0.766
validation accuracy = 0.176		average validation NDCG = 0.740

========
Currently the best setups are [(1.0000000000000001e-05, 0.25, 0.5), (1.0000000000000001e-05, 0.25, 0.0), (1.0000000000000001e-05, 0.5, 0.5)], which got scores of [0.77085619907019942, 0.7562992660949488, 0.7559219334285]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.002476    	average train batch reward = 0.743
validation accuracy = 0.123		average validation NDCG = 0.693

epoch 2
average train loss = 0.002212    	average train batch reward = 0.749
validation accuracy = 0.151		average validation NDCG = 0.712

epoch 3
average train loss = 0.001653    	average train batch reward = 0.753
validation accuracy = 0.193		average validation NDCG = 0.731

========
Currently the best setups are [(1.0000000000000001e-05, 0.25, 0.5), (1.0000000000000001e-05, 0.25, 0.0), (1.0000000000000001e-05, 0.5, 0.5)], which got scores of [0.77085619907019942, 0.7562992660949488, 0.7559219334285]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.002923    	average train batch reward = 0.754
validation accuracy = 0.208		average validation NDCG = 0.724

epoch 2
average train loss = 0.006672    	average train batch reward = 0.759
validation accuracy = 0.240		average validation NDCG = 0.748

epoch 3
average train loss = 0.004408    	average train batch reward = 0.765
validation accuracy = 0.271		average validation NDCG = 0.767

========
Currently the best setups are [(1.0000000000000001e-05, 0.25, 0.5), (1.0000000000000001e-05, 0.75, 0.2), (1.0000000000000001e-05, 0.25, 0.0)], which got scores of [0.77085619907019942, 0.76741086420669835, 0.7562992660949488]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.002381    	average train batch reward = 0.751
validation accuracy = 0.124		average validation NDCG = 0.713

epoch 2
average train loss = 0.004585    	average train batch reward = 0.758
validation accuracy = 0.151		average validation NDCG = 0.736

epoch 3
average train loss = 0.002995    	average train batch reward = 0.763
validation accuracy = 0.186		average validation NDCG = 0.757

========
Currently the best setups are [(1.0000000000000001e-05, 0.25, 0.5), (1.0000000000000001e-05, 0.75, 0.2), (1.0000000000000001e-05, 0.75, 0.5)], which got scores of [0.77085619907019942, 0.76741086420669835, 0.75711454856629401]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.002328    	average train batch reward = 0.740
validation accuracy = 0.085		average validation NDCG = 0.680

epoch 2
average train loss = 0.000803    	average train batch reward = 0.746
validation accuracy = 0.101		average validation NDCG = 0.702

epoch 3
average train loss = 0.002755    	average train batch reward = 0.752
validation accuracy = 0.111		average validation NDCG = 0.728

========
Currently the best setups are [(1.0000000000000001e-05, 0.25, 0.5), (1.0000000000000001e-05, 0.75, 0.2), (1.0000000000000001e-05, 0.75, 0.5)], which got scores of [0.77085619907019942, 0.76741086420669835, 0.75711454856629401]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000010
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.001405    	average train batch reward = 0.747
validation accuracy = 0.126		average validation NDCG = 0.707

epoch 2
average train loss = 0.004447    	average train batch reward = 0.755
validation accuracy = 0.150		average validation NDCG = 0.726

epoch 3
average train loss = 0.001073    	average train batch reward = 0.757
validation accuracy = 0.175		average validation NDCG = 0.745

========
Currently the best setups are [(1.0000000000000001e-05, 0.25, 0.5), (1.0000000000000001e-05, 0.75, 0.2), (1.0000000000000001e-05, 0.75, 0.5)], which got scores of [0.77085619907019942, 0.76741086420669835, 0.75711454856629401]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.006307    	average train batch reward = 0.826
validation accuracy = 0.279		average validation NDCG = 0.846

epoch 2
average train loss = 0.006111    	average train batch reward = 0.885
validation accuracy = 0.345		average validation NDCG = 0.903

epoch 3
average train loss = 0.007603    	average train batch reward = 0.906
validation accuracy = 0.336		average validation NDCG = 0.925

========
Currently the best setups are [(0.0001, 0.1, 0.0), (1.0000000000000001e-05, 0.25, 0.5), (1.0000000000000001e-05, 0.75, 0.5)], which got scores of [0.92501428293936316, 0.77085619907019942, 0.75711454856629401]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.004101    	average train batch reward = 0.782
validation accuracy = 0.368		average validation NDCG = 0.800

epoch 2
average train loss = 0.010424    	average train batch reward = 0.859
validation accuracy = 0.488		average validation NDCG = 0.851

epoch 3
average train loss = 0.009221    	average train batch reward = 0.877
validation accuracy = 0.554		average validation NDCG = 0.864

========
Currently the best setups are [(0.0001, 0.1, 0.0), (0.0001, 0.1, 0.2), (1.0000000000000001e-05, 0.25, 0.5)], which got scores of [0.92501428293936316, 0.86407437694352895, 0.77085619907019942]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.005135    	average train batch reward = 0.842
validation accuracy = 0.430		average validation NDCG = 0.867

epoch 2
average train loss = 0.007264    	average train batch reward = 0.908
validation accuracy = 0.608		average validation NDCG = 0.910

epoch 3
average train loss = 0.003366    	average train batch reward = 0.923
validation accuracy = 0.568		average validation NDCG = 0.927

========
Currently the best setups are [(0.0001, 0.1, 0.5), (0.0001, 0.1, 0.0), (1.0000000000000001e-05, 0.25, 0.5)], which got scores of [0.92748134044280872, 0.92501428293936316, 0.77085619907019942]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.003338    	average train batch reward = 0.793
validation accuracy = 0.302		average validation NDCG = 0.832

epoch 2
average train loss = 0.006164    	average train batch reward = 0.857
validation accuracy = 0.384		average validation NDCG = 0.869

epoch 3
average train loss = 0.006636    	average train batch reward = 0.872
validation accuracy = 0.463		average validation NDCG = 0.901

========
Currently the best setups are [(0.0001, 0.1, 0.5), (0.0001, 0.1, 0.0), (0.0001, 0.1, 1.0)], which got scores of [0.92748134044280872, 0.92501428293936316, 0.90124400962930962]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.004152    	average train batch reward = 0.811
validation accuracy = 0.345		average validation NDCG = 0.864

epoch 2
average train loss = 0.006962    	average train batch reward = 0.900
validation accuracy = 0.472		average validation NDCG = 0.926

epoch 3
average train loss = 0.006097    	average train batch reward = 0.923
validation accuracy = 0.507		average validation NDCG = 0.948

========
Currently the best setups are [(0.0001, 0.1, 1.5), (0.0001, 0.1, 0.5), (0.0001, 0.1, 1.0)], which got scores of [0.94755796328316644, 0.92748134044280872, 0.90124400962930962]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.004919    	average train batch reward = 0.778
validation accuracy = 0.390		average validation NDCG = 0.818

epoch 2
average train loss = 0.006274    	average train batch reward = 0.859
validation accuracy = 0.557		average validation NDCG = 0.915

epoch 3
average train loss = 0.005116    	average train batch reward = 0.890
validation accuracy = 0.589		average validation NDCG = 0.944

========
Currently the best setups are [(0.0001, 0.1, 1.5), (0.0001, 0.25, 0.0), (0.0001, 0.1, 0.5)], which got scores of [0.94755796328316644, 0.9437784552088605, 0.92748134044280872]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.003932    	average train batch reward = 0.804
validation accuracy = 0.424		average validation NDCG = 0.854

epoch 2
average train loss = 0.006864    	average train batch reward = 0.862
validation accuracy = 0.506		average validation NDCG = 0.895

epoch 3
average train loss = 0.005272    	average train batch reward = 0.881
validation accuracy = 0.540		average validation NDCG = 0.917

========
Currently the best setups are [(0.0001, 0.1, 1.5), (0.0001, 0.25, 0.0), (0.0001, 0.1, 0.5)], which got scores of [0.94755796328316644, 0.9437784552088605, 0.92748134044280872]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.005847    	average train batch reward = 0.808
validation accuracy = 0.280		average validation NDCG = 0.849

epoch 2
average train loss = 0.006439    	average train batch reward = 0.867
validation accuracy = 0.515		average validation NDCG = 0.907

epoch 3
average train loss = 0.006455    	average train batch reward = 0.890
validation accuracy = 0.620		average validation NDCG = 0.939

========
Currently the best setups are [(0.0001, 0.1, 1.5), (0.0001, 0.25, 0.0), (0.0001, 0.25, 0.5)], which got scores of [0.94755796328316644, 0.9437784552088605, 0.93930802190515283]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.005637    	average train batch reward = 0.802
validation accuracy = 0.390		average validation NDCG = 0.824

epoch 2
average train loss = 0.006737    	average train batch reward = 0.854
validation accuracy = 0.476		average validation NDCG = 0.879

epoch 3
average train loss = 0.005479    	average train batch reward = 0.872
validation accuracy = 0.531		average validation NDCG = 0.916

========
Currently the best setups are [(0.0001, 0.1, 1.5), (0.0001, 0.25, 0.0), (0.0001, 0.25, 0.5)], which got scores of [0.94755796328316644, 0.9437784552088605, 0.93930802190515283]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.004258    	average train batch reward = 0.808
validation accuracy = 0.406		average validation NDCG = 0.872

epoch 2
average train loss = 0.007729    	average train batch reward = 0.879
validation accuracy = 0.524		average validation NDCG = 0.932

epoch 3
average train loss = 0.005653    	average train batch reward = 0.897
validation accuracy = 0.576		average validation NDCG = 0.950

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.25, 0.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.93930802190515283]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.003133    	average train batch reward = 0.762
validation accuracy = 0.359		average validation NDCG = 0.794

epoch 2
average train loss = 0.008150    	average train batch reward = 0.811
validation accuracy = 0.451		average validation NDCG = 0.862

epoch 3
average train loss = 0.007828    	average train batch reward = 0.827
validation accuracy = 0.537		average validation NDCG = 0.905

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.25, 0.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.93930802190515283]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.005886    	average train batch reward = 0.785
validation accuracy = 0.434		average validation NDCG = 0.858

epoch 2
average train loss = 0.005738    	average train batch reward = 0.826
validation accuracy = 0.554		average validation NDCG = 0.913

epoch 3
average train loss = 0.007033    	average train batch reward = 0.843
validation accuracy = 0.610		average validation NDCG = 0.942

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 0.2)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.9419227472164422]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.002579    	average train batch reward = 0.776
validation accuracy = 0.368		average validation NDCG = 0.808

epoch 2
average train loss = 0.004935    	average train batch reward = 0.807
validation accuracy = 0.445		average validation NDCG = 0.846

epoch 3
average train loss = 0.007922    	average train batch reward = 0.815
validation accuracy = 0.470		average validation NDCG = 0.863

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 0.2)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.9419227472164422]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.004235    	average train batch reward = 0.778
validation accuracy = 0.373		average validation NDCG = 0.831

epoch 2
average train loss = 0.006847    	average train batch reward = 0.812
validation accuracy = 0.516		average validation NDCG = 0.883

epoch 3
average train loss = 0.006634    	average train batch reward = 0.828
validation accuracy = 0.583		average validation NDCG = 0.902

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 0.2)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.9419227472164422]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.004169    	average train batch reward = 0.789
validation accuracy = 0.403		average validation NDCG = 0.877

epoch 2
average train loss = 0.007086    	average train batch reward = 0.837
validation accuracy = 0.530		average validation NDCG = 0.920

epoch 3
average train loss = 0.006201    	average train batch reward = 0.845
validation accuracy = 0.601		average validation NDCG = 0.945

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.003907    	average train batch reward = 0.754
validation accuracy = 0.276		average validation NDCG = 0.802

epoch 2
average train loss = 0.008100    	average train batch reward = 0.779
validation accuracy = 0.473		average validation NDCG = 0.901

epoch 3
average train loss = 0.009999    	average train batch reward = 0.793
validation accuracy = 0.501		average validation NDCG = 0.933

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.001719    	average train batch reward = 0.765
validation accuracy = 0.262		average validation NDCG = 0.844

epoch 2
average train loss = 0.006834    	average train batch reward = 0.784
validation accuracy = 0.366		average validation NDCG = 0.900

epoch 3
average train loss = 0.006663    	average train batch reward = 0.790
validation accuracy = 0.481		average validation NDCG = 0.930

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.006437    	average train batch reward = 0.759
validation accuracy = 0.356		average validation NDCG = 0.834

epoch 2
average train loss = 0.003701    	average train batch reward = 0.780
validation accuracy = 0.454		average validation NDCG = 0.889

epoch 3
average train loss = 0.004851    	average train batch reward = 0.787
validation accuracy = 0.481		average validation NDCG = 0.909

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.001881    	average train batch reward = 0.759
validation accuracy = 0.371		average validation NDCG = 0.806

epoch 2
average train loss = 0.005603    	average train batch reward = 0.775
validation accuracy = 0.452		average validation NDCG = 0.861

epoch 3
average train loss = 0.004978    	average train batch reward = 0.782
validation accuracy = 0.477		average validation NDCG = 0.887

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.000100
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.004174    	average train batch reward = 0.762
validation accuracy = 0.398		average validation NDCG = 0.839

epoch 2
average train loss = 0.002594    	average train batch reward = 0.780
validation accuracy = 0.503		average validation NDCG = 0.882

epoch 3
average train loss = 0.009808    	average train batch reward = 0.785
validation accuracy = 0.521		average validation NDCG = 0.917

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.012803    	average train batch reward = 0.846
validation accuracy = 0.413		average validation NDCG = 0.855

epoch 2
average train loss = 0.006419    	average train batch reward = 0.878
validation accuracy = 0.435		average validation NDCG = 0.871

epoch 3
average train loss = 0.003362    	average train batch reward = 0.878
validation accuracy = 0.473		average validation NDCG = 0.871

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.006924    	average train batch reward = 0.850
validation accuracy = 0.371		average validation NDCG = 0.864

epoch 2
average train loss = 0.005551    	average train batch reward = 0.874
validation accuracy = 0.348		average validation NDCG = 0.864

epoch 3
average train loss = 0.004514    	average train batch reward = 0.869
validation accuracy = 0.419		average validation NDCG = 0.871

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.005555    	average train batch reward = 0.881
validation accuracy = 0.353		average validation NDCG = 0.913

epoch 2
average train loss = 0.002672    	average train batch reward = 0.910
validation accuracy = 0.388		average validation NDCG = 0.914

epoch 3
average train loss = 0.004342    	average train batch reward = 0.912
validation accuracy = 0.482		average validation NDCG = 0.919

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.003391    	average train batch reward = 0.882
validation accuracy = 0.411		average validation NDCG = 0.928

epoch 2
average train loss = -0.006565    	average train batch reward = 0.914
validation accuracy = 0.449		average validation NDCG = 0.922

epoch 3
average train loss = 0.005875    	average train batch reward = 0.921
validation accuracy = 0.514		average validation NDCG = 0.931

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.004829    	average train batch reward = 0.855
validation accuracy = 0.488		average validation NDCG = 0.875

epoch 2
average train loss = 0.002317    	average train batch reward = 0.885
validation accuracy = 0.289		average validation NDCG = 0.880

epoch 3
average train loss = 0.003829    	average train batch reward = 0.896
validation accuracy = 0.308		average validation NDCG = 0.890

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.006212    	average train batch reward = 0.861
validation accuracy = 0.471		average validation NDCG = 0.896

epoch 2
average train loss = 0.007793    	average train batch reward = 0.887
validation accuracy = 0.521		average validation NDCG = 0.930

epoch 3
average train loss = 0.003964    	average train batch reward = 0.894
validation accuracy = 0.576		average validation NDCG = 0.931

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.005610    	average train batch reward = 0.830
validation accuracy = 0.388		average validation NDCG = 0.862

epoch 2
average train loss = 0.003293    	average train batch reward = 0.865
validation accuracy = 0.379		average validation NDCG = 0.891

epoch 3
average train loss = 0.012707    	average train batch reward = 0.870
validation accuracy = 0.580		average validation NDCG = 0.895

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.005003    	average train batch reward = 0.828
validation accuracy = 0.482		average validation NDCG = 0.889

epoch 2
average train loss = 0.009330    	average train batch reward = 0.866
validation accuracy = 0.469		average validation NDCG = 0.893

epoch 3
average train loss = 0.007285    	average train batch reward = 0.873
validation accuracy = 0.511		average validation NDCG = 0.905

========
Currently the best setups are [(0.0001, 0.25, 1.5), (0.0001, 0.1, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95005606156232358, 0.94755796328316644, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.006788    	average train batch reward = 0.863
validation accuracy = 0.564		average validation NDCG = 0.930

epoch 2
average train loss = 0.001631    	average train batch reward = 0.900
validation accuracy = 0.596		average validation NDCG = 0.959

epoch 3
average train loss = 0.003523    	average train batch reward = 0.902
validation accuracy = 0.556		average validation NDCG = 0.951

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.0001, 0.25, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95927061248473611, 0.95005606156232358, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.006665    	average train batch reward = 0.855
validation accuracy = 0.517		average validation NDCG = 0.919

epoch 2
average train loss = 0.007973    	average train batch reward = 0.888
validation accuracy = 0.462		average validation NDCG = 0.929

epoch 3
average train loss = 0.003845    	average train batch reward = 0.892
validation accuracy = 0.419		average validation NDCG = 0.933

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.0001, 0.25, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95927061248473611, 0.95005606156232358, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.010479    	average train batch reward = 0.810
validation accuracy = 0.440		average validation NDCG = 0.909

epoch 2
average train loss = 0.005834    	average train batch reward = 0.836
validation accuracy = 0.529		average validation NDCG = 0.918

epoch 3
average train loss = 0.012142    	average train batch reward = 0.840
validation accuracy = 0.536		average validation NDCG = 0.928

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.0001, 0.25, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95927061248473611, 0.95005606156232358, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.001142    	average train batch reward = 0.816
validation accuracy = 0.534		average validation NDCG = 0.918

epoch 2
average train loss = 0.003622    	average train batch reward = 0.836
validation accuracy = 0.423		average validation NDCG = 0.916

epoch 3
average train loss = 0.005693    	average train batch reward = 0.838
validation accuracy = 0.520		average validation NDCG = 0.932

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.0001, 0.25, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95927061248473611, 0.95005606156232358, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.002224    	average train batch reward = 0.811
validation accuracy = 0.495		average validation NDCG = 0.898

epoch 2
average train loss = 0.003857    	average train batch reward = 0.834
validation accuracy = 0.581		average validation NDCG = 0.922

epoch 3
average train loss = 0.008052    	average train batch reward = 0.839
validation accuracy = 0.525		average validation NDCG = 0.919

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.0001, 0.25, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95927061248473611, 0.95005606156232358, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.005941    	average train batch reward = 0.816
validation accuracy = 0.444		average validation NDCG = 0.912

epoch 2
average train loss = 0.008315    	average train batch reward = 0.837
validation accuracy = 0.417		average validation NDCG = 0.906

epoch 3
average train loss = 0.004985    	average train batch reward = 0.836
validation accuracy = 0.560		average validation NDCG = 0.918

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.0001, 0.25, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95927061248473611, 0.95005606156232358, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.007940    	average train batch reward = 0.804
validation accuracy = 0.482		average validation NDCG = 0.877

epoch 2
average train loss = 0.008604    	average train batch reward = 0.830
validation accuracy = 0.512		average validation NDCG = 0.911

epoch 3
average train loss = 0.002466    	average train batch reward = 0.841
validation accuracy = 0.460		average validation NDCG = 0.923

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.0001, 0.25, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95927061248473611, 0.95005606156232358, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.000807    	average train batch reward = 0.769
validation accuracy = 0.229		average validation NDCG = 0.845

epoch 2
average train loss = 0.009161    	average train batch reward = 0.779
validation accuracy = 0.329		average validation NDCG = 0.859

epoch 3
average train loss = 0.005230    	average train batch reward = 0.780
validation accuracy = 0.399		average validation NDCG = 0.859

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.0001, 0.25, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95927061248473611, 0.95005606156232358, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.006749    	average train batch reward = 0.766
validation accuracy = 0.412		average validation NDCG = 0.844

epoch 2
average train loss = 0.010633    	average train batch reward = 0.775
validation accuracy = 0.377		average validation NDCG = 0.856

epoch 3
average train loss = 0.003611    	average train batch reward = 0.779
validation accuracy = 0.453		average validation NDCG = 0.863

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.0001, 0.25, 1.5), (0.0001, 0.5, 1.5)], which got scores of [0.95927061248473611, 0.95005606156232358, 0.94516930859425996]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.002860    	average train batch reward = 0.777
validation accuracy = 0.414		average validation NDCG = 0.922

epoch 2
average train loss = 0.009677    	average train batch reward = 0.794
validation accuracy = 0.470		average validation NDCG = 0.939

epoch 3
average train loss = 0.004697    	average train batch reward = 0.796
validation accuracy = 0.549		average validation NDCG = 0.953

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.005217    	average train batch reward = 0.766
validation accuracy = 0.213		average validation NDCG = 0.868

epoch 2
average train loss = 0.006383    	average train batch reward = 0.783
validation accuracy = 0.257		average validation NDCG = 0.897

epoch 3
average train loss = 0.005832    	average train batch reward = 0.786
validation accuracy = 0.520		average validation NDCG = 0.893

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.001000
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.007061    	average train batch reward = 0.772
validation accuracy = 0.385		average validation NDCG = 0.890

epoch 2
average train loss = 0.004272    	average train batch reward = 0.787
validation accuracy = 0.535		average validation NDCG = 0.907

epoch 3
average train loss = 0.011083    	average train batch reward = 0.790
validation accuracy = 0.563		average validation NDCG = 0.920

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.009061    	average train batch reward = 0.771
validation accuracy = 0.176		average validation NDCG = 0.712

epoch 2
average train loss = 0.001328    	average train batch reward = 0.779
validation accuracy = 0.269		average validation NDCG = 0.741

epoch 3
average train loss = 0.033764    	average train batch reward = 0.779
validation accuracy = 0.177		average validation NDCG = 0.724

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.008907    	average train batch reward = 0.799
validation accuracy = 0.095		average validation NDCG = 0.748

epoch 2
average train loss = -0.014274    	average train batch reward = 0.784
validation accuracy = 0.145		average validation NDCG = 0.718

epoch 3
average train loss = 0.014473    	average train batch reward = 0.767
validation accuracy = 0.133		average validation NDCG = 0.693

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.004974    	average train batch reward = 0.779
validation accuracy = 0.216		average validation NDCG = 0.718

epoch 2
average train loss = 0.014884    	average train batch reward = 0.782
validation accuracy = 0.150		average validation NDCG = 0.699

epoch 3
average train loss = -0.012439    	average train batch reward = 0.762
validation accuracy = 0.138		average validation NDCG = 0.679

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.003258    	average train batch reward = 0.792
validation accuracy = 0.273		average validation NDCG = 0.733

epoch 2
average train loss = 0.005773    	average train batch reward = 0.796
validation accuracy = 0.216		average validation NDCG = 0.727

epoch 3
average train loss = 0.000537    	average train batch reward = 0.762
validation accuracy = 0.095		average validation NDCG = 0.699

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.013248    	average train batch reward = 0.786
validation accuracy = 0.135		average validation NDCG = 0.735

epoch 2
average train loss = 0.004497    	average train batch reward = 0.783
validation accuracy = 0.103		average validation NDCG = 0.727

epoch 3
average train loss = -0.000046    	average train batch reward = 0.766
validation accuracy = 0.119		average validation NDCG = 0.715

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.010042    	average train batch reward = 0.766
validation accuracy = 0.152		average validation NDCG = 0.696

epoch 2
average train loss = 0.003328    	average train batch reward = 0.754
validation accuracy = 0.136		average validation NDCG = 0.685

epoch 3
average train loss = -0.001859    	average train batch reward = 0.762
validation accuracy = 0.110		average validation NDCG = 0.702

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.002473    	average train batch reward = 0.760
validation accuracy = 0.177		average validation NDCG = 0.691

epoch 2
average train loss = 0.017233    	average train batch reward = 0.778
validation accuracy = 0.087		average validation NDCG = 0.738

epoch 3
average train loss = -0.009565    	average train batch reward = 0.777
validation accuracy = 0.109		average validation NDCG = 0.729

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.009408    	average train batch reward = 0.787
validation accuracy = 0.243		average validation NDCG = 0.742

epoch 2
average train loss = -0.003376    	average train batch reward = 0.789
validation accuracy = 0.214		average validation NDCG = 0.750

epoch 3
average train loss = 0.005034    	average train batch reward = 0.802
validation accuracy = 0.201		average validation NDCG = 0.781

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.008204    	average train batch reward = 0.752
validation accuracy = 0.140		average validation NDCG = 0.688

epoch 2
average train loss = -0.005298    	average train batch reward = 0.760
validation accuracy = 0.170		average validation NDCG = 0.703

epoch 3
average train loss = -0.011166    	average train batch reward = 0.763
validation accuracy = 0.134		average validation NDCG = 0.699

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.002424    	average train batch reward = 0.756
validation accuracy = 0.202		average validation NDCG = 0.716

epoch 2
average train loss = 0.026718    	average train batch reward = 0.780
validation accuracy = 0.142		average validation NDCG = 0.736

epoch 3
average train loss = -0.004655    	average train batch reward = 0.772
validation accuracy = 0.180		average validation NDCG = 0.728

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.006755    	average train batch reward = 0.783
validation accuracy = 0.159		average validation NDCG = 0.780

epoch 2
average train loss = 0.016597    	average train batch reward = 0.774
validation accuracy = 0.106		average validation NDCG = 0.700

epoch 3
average train loss = -0.019365    	average train batch reward = 0.765
validation accuracy = 0.175		average validation NDCG = 0.739

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.010159    	average train batch reward = 0.774
validation accuracy = 0.138		average validation NDCG = 0.743

epoch 2
average train loss = 0.032198    	average train batch reward = 0.773
validation accuracy = 0.129		average validation NDCG = 0.724

epoch 3
average train loss = 0.013759    	average train batch reward = 0.757
validation accuracy = 0.106		average validation NDCG = 0.698

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.011486    	average train batch reward = 0.765
validation accuracy = 0.153		average validation NDCG = 0.723

epoch 2
average train loss = -0.015407    	average train batch reward = 0.768
validation accuracy = 0.087		average validation NDCG = 0.729

epoch 3
average train loss = -0.010947    	average train batch reward = 0.765
validation accuracy = 0.089		average validation NDCG = 0.725

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.006985    	average train batch reward = 0.783
validation accuracy = 0.176		average validation NDCG = 0.779

epoch 2
average train loss = 0.016805    	average train batch reward = 0.781
validation accuracy = 0.178		average validation NDCG = 0.744

epoch 3
average train loss = 0.013341    	average train batch reward = 0.773
validation accuracy = 0.206		average validation NDCG = 0.727

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.004089    	average train batch reward = 0.753
validation accuracy = 0.117		average validation NDCG = 0.720

epoch 2
average train loss = -0.007037    	average train batch reward = 0.772
validation accuracy = 0.147		average validation NDCG = 0.770

epoch 3
average train loss = -0.012952    	average train batch reward = 0.780
validation accuracy = 0.269		average validation NDCG = 0.737

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.003132    	average train batch reward = 0.754
validation accuracy = 0.137		average validation NDCG = 0.732

epoch 2
average train loss = -0.026585    	average train batch reward = 0.748
validation accuracy = 0.117		average validation NDCG = 0.688

epoch 3
average train loss = -0.002825    	average train batch reward = 0.747
validation accuracy = 0.099		average validation NDCG = 0.714

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.016685    	average train batch reward = 0.762
validation accuracy = 0.281		average validation NDCG = 0.800

epoch 2
average train loss = 0.029293    	average train batch reward = 0.764
validation accuracy = 0.180		average validation NDCG = 0.779

epoch 3
average train loss = 0.013020    	average train batch reward = 0.765
validation accuracy = 0.380		average validation NDCG = 0.788

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.006866    	average train batch reward = 0.762
validation accuracy = 0.198		average validation NDCG = 0.761

epoch 2
average train loss = -0.019257    	average train batch reward = 0.759
validation accuracy = 0.150		average validation NDCG = 0.741

epoch 3
average train loss = 0.015391    	average train batch reward = 0.758
validation accuracy = 0.116		average validation NDCG = 0.711

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.008402    	average train batch reward = 0.754
validation accuracy = 0.285		average validation NDCG = 0.789

epoch 2
average train loss = -0.007146    	average train batch reward = 0.757
validation accuracy = 0.100		average validation NDCG = 0.729

epoch 3
average train loss = 0.007043    	average train batch reward = 0.748
validation accuracy = 0.097		average validation NDCG = 0.699

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.010000
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.011380    	average train batch reward = 0.752
validation accuracy = 0.137		average validation NDCG = 0.723

epoch 2
average train loss = 0.003405    	average train batch reward = 0.750
validation accuracy = 0.152		average validation NDCG = 0.698

epoch 3
average train loss = 0.001063    	average train batch reward = 0.748
validation accuracy = 0.179		average validation NDCG = 0.710

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.006009    	average train batch reward = 0.757
validation accuracy = 0.150		average validation NDCG = 0.698

epoch 2
average train loss = -0.000001    	average train batch reward = 0.759
validation accuracy = 0.092		average validation NDCG = 0.701

epoch 3
average train loss = 0.038702    	average train batch reward = 0.759
validation accuracy = 0.092		average validation NDCG = 0.701

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.000639    	average train batch reward = 0.745
validation accuracy = 0.119		average validation NDCG = 0.686

epoch 2
average train loss = 0.053040    	average train batch reward = 0.747
validation accuracy = 0.096		average validation NDCG = 0.664

epoch 3
average train loss = 0.021328    	average train batch reward = 0.744
validation accuracy = 0.148		average validation NDCG = 0.688

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.013416    	average train batch reward = 0.769
validation accuracy = 0.099		average validation NDCG = 0.685

epoch 2
average train loss = -0.000000    	average train batch reward = 0.754
validation accuracy = 0.096		average validation NDCG = 0.684

epoch 3
average train loss = -0.000000    	average train batch reward = 0.753
validation accuracy = 0.100		average validation NDCG = 0.686

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.000852    	average train batch reward = 0.745
validation accuracy = 0.092		average validation NDCG = 0.675

epoch 2
average train loss = 0.000314    	average train batch reward = 0.747
validation accuracy = 0.092		average validation NDCG = 0.676

epoch 3
average train loss = -0.000004    	average train batch reward = 0.745
validation accuracy = 0.115		average validation NDCG = 0.666

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.000968    	average train batch reward = 0.749
validation accuracy = 0.155		average validation NDCG = 0.683

epoch 2
average train loss = 0.000001    	average train batch reward = 0.748
validation accuracy = 0.100		average validation NDCG = 0.682

epoch 3
average train loss = -0.000002    	average train batch reward = 0.753
validation accuracy = 0.110		average validation NDCG = 0.678

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.013747    	average train batch reward = 0.764
validation accuracy = 0.107		average validation NDCG = 0.700

epoch 2
average train loss = -0.009555    	average train batch reward = 0.759
validation accuracy = 0.129		average validation NDCG = 0.704

epoch 3
average train loss = -0.000006    	average train batch reward = 0.760
validation accuracy = 0.102		average validation NDCG = 0.708

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.026005    	average train batch reward = 0.759
validation accuracy = 0.110		average validation NDCG = 0.690

epoch 2
average train loss = -0.058211    	average train batch reward = 0.742
validation accuracy = 0.106		average validation NDCG = 0.660

epoch 3
average train loss = 0.000000    	average train batch reward = 0.736
validation accuracy = 0.106		average validation NDCG = 0.661

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.038978    	average train batch reward = 0.759
validation accuracy = 0.099		average validation NDCG = 0.676

epoch 2
average train loss = -0.000063    	average train batch reward = 0.747
validation accuracy = 0.130		average validation NDCG = 0.679

epoch 3
average train loss = -0.000005    	average train batch reward = 0.747
validation accuracy = 0.127		average validation NDCG = 0.700

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.159470    	average train batch reward = 0.775
validation accuracy = 0.065		average validation NDCG = 0.722

epoch 2
average train loss = 0.000149    	average train batch reward = 0.759
validation accuracy = 0.061		average validation NDCG = 0.703

epoch 3
average train loss = -0.000004    	average train batch reward = 0.755
validation accuracy = 0.098		average validation NDCG = 0.695

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.250000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.000019    	average train batch reward = 0.731
validation accuracy = 0.098		average validation NDCG = 0.658

epoch 2
average train loss = 0.000001    	average train batch reward = 0.735
validation accuracy = 0.099		average validation NDCG = 0.664

epoch 3
average train loss = -0.000000    	average train batch reward = 0.739
validation accuracy = 0.099		average validation NDCG = 0.663

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.000645    	average train batch reward = 0.746
validation accuracy = 0.098		average validation NDCG = 0.678

epoch 2
average train loss = -0.000049    	average train batch reward = 0.747
validation accuracy = 0.098		average validation NDCG = 0.676

epoch 3
average train loss = -0.000003    	average train batch reward = 0.746
validation accuracy = 0.098		average validation NDCG = 0.676

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.001192    	average train batch reward = 0.741
validation accuracy = 0.085		average validation NDCG = 0.665

epoch 2
average train loss = 0.010042    	average train batch reward = 0.737
validation accuracy = 0.088		average validation NDCG = 0.664

epoch 3
average train loss = -0.000002    	average train batch reward = 0.735
validation accuracy = 0.113		average validation NDCG = 0.659

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.004479    	average train batch reward = 0.753
validation accuracy = 0.107		average validation NDCG = 0.697

epoch 2
average train loss = -0.000000    	average train batch reward = 0.752
validation accuracy = 0.098		average validation NDCG = 0.690

epoch 3
average train loss = 0.000000    	average train batch reward = 0.748
validation accuracy = 0.098		average validation NDCG = 0.687

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.000737    	average train batch reward = 0.743
validation accuracy = 0.111		average validation NDCG = 0.680

epoch 2
average train loss = -0.074359    	average train batch reward = 0.744
validation accuracy = 0.115		average validation NDCG = 0.685

epoch 3
average train loss = -0.000000    	average train batch reward = 0.742
validation accuracy = 0.115		average validation NDCG = 0.684

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.024889    	average train batch reward = 0.751
validation accuracy = 0.110		average validation NDCG = 0.699

epoch 2
average train loss = 0.000004    	average train batch reward = 0.751
validation accuracy = 0.113		average validation NDCG = 0.681

epoch 3
average train loss = 0.025921    	average train batch reward = 0.750
validation accuracy = 0.162		average validation NDCG = 0.691

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.001933    	average train batch reward = 0.746
validation accuracy = 0.084		average validation NDCG = 0.692

epoch 2
average train loss = 0.001446    	average train batch reward = 0.745
validation accuracy = 0.096		average validation NDCG = 0.701

epoch 3
average train loss = 0.000006    	average train batch reward = 0.750
validation accuracy = 0.085		average validation NDCG = 0.688

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.200000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.037164    	average train batch reward = 0.748
validation accuracy = 0.104		average validation NDCG = 0.705

epoch 2
average train loss = -0.000930    	average train batch reward = 0.747
validation accuracy = 0.135		average validation NDCG = 0.701

epoch 3
average train loss = 0.000002    	average train batch reward = 0.748
validation accuracy = 0.130		average validation NDCG = 0.709

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 0.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.000206    	average train batch reward = 0.747
validation accuracy = 0.142		average validation NDCG = 0.680

epoch 2
average train loss = -0.188580    	average train batch reward = 0.742
validation accuracy = 0.098		average validation NDCG = 0.664

epoch 3
average train loss = -0.000000    	average train batch reward = 0.739
validation accuracy = 0.098		average validation NDCG = 0.664

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.000000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = -0.002773    	average train batch reward = 0.745
validation accuracy = 0.099		average validation NDCG = 0.705

epoch 2
average train loss = -0.146337    	average train batch reward = 0.749
validation accuracy = 0.099		average validation NDCG = 0.700

epoch 3
average train loss = -0.000005    	average train batch reward = 0.747
validation accuracy = 0.062		average validation NDCG = 0.700

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
Hyperparameters:
k = 3
Batch size = 512
Num epochs = 3
Learning rate = 0.100000
Epsilon = 0.750000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x2af583b09320>
Reward function = <function ndcg_full at 0x2af583b09398>
Greedy action = <function sample at 0x2af57c90c9b0>
Reg strength = 1.500000

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

epoch 1
average train loss = 0.017930    	average train batch reward = 0.745
validation accuracy = 0.119		average validation NDCG = 0.699

epoch 2
average train loss = 0.000002    	average train batch reward = 0.743
validation accuracy = 0.136		average validation NDCG = 0.690

epoch 3
average train loss = 0.192291    	average train batch reward = 0.746
validation accuracy = 0.128		average validation NDCG = 0.698

========
Currently the best setups are [(0.001, 0.25, 1.0), (0.001, 0.75, 0.5), (0.0001, 0.25, 1.5)], which got scores of [0.95927061248473611, 0.95256028745530674, 0.95005606156232358]
========
2017-07-03 09:22:27
