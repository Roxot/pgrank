Started at 2017-07-14 00:32:11
Finding best parameters for k = 5
Num epochs = 5
Averaging over 10 runs
Tuning the parameter: learning_rate

If not tuned the following parameter values are used:
Learning rate = 0.000100
Epsilon = 0.000000
Exploration type = None
Weight regularization strength = 0.0
Baseline = 0.0
=========
Hyperparameters:
k = 5
Batch size = 64
Num epochs = 5
Learning rate = 0.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125765f0>
Reward function = <function ndcg_full at 0x112576668>
Greedy action = <function sample at 0x10a55bc08>
Explore action = <explorers.explore.Uniform instance at 0x1132ca560>
Baseline = 0.0
Weight regularization strength = 0.0
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.096		average validation NDCG = 0.689

epoch 1
average train loss = -0.190607    	average train batch reward = 0.656
validation accuracy = 0.096		average validation NDCG = 0.690

epoch 2
average train loss = -0.201932    	average train batch reward = 0.656
validation accuracy = 0.097		average validation NDCG = 0.690

epoch 3
average train loss = -0.197883    	average train batch reward = 0.655
validation accuracy = 0.098		average validation NDCG = 0.690

epoch 4
average train loss = -0.197525    	average train batch reward = 0.656
validation accuracy = 0.099		average validation NDCG = 0.691

epoch 5
average train loss = -0.201658    	average train batch reward = 0.656
validation accuracy = 0.099		average validation NDCG = 0.691

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.065		average validation NDCG = 0.667

epoch 1
average train loss = -0.173530    	average train batch reward = 0.636
validation accuracy = 0.066		average validation NDCG = 0.667

epoch 2
average train loss = -0.181799    	average train batch reward = 0.635
validation accuracy = 0.066		average validation NDCG = 0.667

epoch 3
average train loss = -0.177110    	average train batch reward = 0.636
validation accuracy = 0.066		average validation NDCG = 0.667

epoch 4
average train loss = -0.180522    	average train batch reward = 0.636
validation accuracy = 0.066		average validation NDCG = 0.668

epoch 5
average train loss = -0.187661    	average train batch reward = 0.638
validation accuracy = 0.065		average validation NDCG = 0.668

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.105		average validation NDCG = 0.674

epoch 1
average train loss = -0.182641    	average train batch reward = 0.644
validation accuracy = 0.105		average validation NDCG = 0.674

epoch 2
average train loss = -0.192134    	average train batch reward = 0.644
validation accuracy = 0.106		average validation NDCG = 0.674

epoch 3
average train loss = -0.183232    	average train batch reward = 0.644
validation accuracy = 0.107		average validation NDCG = 0.675

epoch 4
average train loss = -0.179916    	average train batch reward = 0.645
validation accuracy = 0.108		average validation NDCG = 0.675

epoch 5
average train loss = -0.193630    	average train batch reward = 0.644
validation accuracy = 0.108		average validation NDCG = 0.675

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.062		average validation NDCG = 0.669

epoch 1
average train loss = -0.193458    	average train batch reward = 0.635
validation accuracy = 0.062		average validation NDCG = 0.670

epoch 2
average train loss = -0.187782    	average train batch reward = 0.635
validation accuracy = 0.062		average validation NDCG = 0.670

epoch 3
average train loss = -0.185139    	average train batch reward = 0.633
validation accuracy = 0.063		average validation NDCG = 0.670

epoch 4
average train loss = -0.180993    	average train batch reward = 0.634
validation accuracy = 0.063		average validation NDCG = 0.670

epoch 5
average train loss = -0.181753    	average train batch reward = 0.635
validation accuracy = 0.063		average validation NDCG = 0.670

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.099		average validation NDCG = 0.667

epoch 1
average train loss = -0.182948    	average train batch reward = 0.644
validation accuracy = 0.099		average validation NDCG = 0.668

epoch 2
average train loss = -0.181397    	average train batch reward = 0.645
validation accuracy = 0.100		average validation NDCG = 0.668

epoch 3
average train loss = -0.176107    	average train batch reward = 0.647
validation accuracy = 0.100		average validation NDCG = 0.668

epoch 4
average train loss = -0.184602    	average train batch reward = 0.645
validation accuracy = 0.100		average validation NDCG = 0.668

epoch 5
average train loss = -0.196752    	average train batch reward = 0.646
validation accuracy = 0.101		average validation NDCG = 0.669

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.070		average validation NDCG = 0.674

epoch 1
average train loss = -0.177660    	average train batch reward = 0.647
validation accuracy = 0.070		average validation NDCG = 0.674

epoch 2
average train loss = -0.185181    	average train batch reward = 0.646
validation accuracy = 0.070		average validation NDCG = 0.674

epoch 3
average train loss = -0.185146    	average train batch reward = 0.647
validation accuracy = 0.070		average validation NDCG = 0.675

epoch 4
average train loss = -0.192863    	average train batch reward = 0.648
validation accuracy = 0.071		average validation NDCG = 0.675

epoch 5
average train loss = -0.183607    	average train batch reward = 0.647
validation accuracy = 0.071		average validation NDCG = 0.675

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.155		average validation NDCG = 0.683

epoch 1
average train loss = -0.183247    	average train batch reward = 0.653
validation accuracy = 0.156		average validation NDCG = 0.683

epoch 2
average train loss = -0.186007    	average train batch reward = 0.652
validation accuracy = 0.157		average validation NDCG = 0.683

epoch 3
average train loss = -0.184305    	average train batch reward = 0.654
validation accuracy = 0.158		average validation NDCG = 0.684

epoch 4
average train loss = -0.189521    	average train batch reward = 0.654
validation accuracy = 0.158		average validation NDCG = 0.684

epoch 5
average train loss = -0.193401    	average train batch reward = 0.655
validation accuracy = 0.159		average validation NDCG = 0.684

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.139		average validation NDCG = 0.669

epoch 1
average train loss = -0.192150    	average train batch reward = 0.641
validation accuracy = 0.140		average validation NDCG = 0.670

epoch 2
average train loss = -0.204676    	average train batch reward = 0.641
validation accuracy = 0.140		average validation NDCG = 0.670

epoch 3
average train loss = -0.192766    	average train batch reward = 0.640
validation accuracy = 0.141		average validation NDCG = 0.670

epoch 4
average train loss = -0.197254    	average train batch reward = 0.640
validation accuracy = 0.141		average validation NDCG = 0.670

epoch 5
average train loss = -0.191697    	average train batch reward = 0.641
validation accuracy = 0.141		average validation NDCG = 0.671

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.117		average validation NDCG = 0.688

epoch 1
average train loss = -0.200255    	average train batch reward = 0.660
validation accuracy = 0.118		average validation NDCG = 0.688

epoch 2
average train loss = -0.206258    	average train batch reward = 0.660
validation accuracy = 0.119		average validation NDCG = 0.689

epoch 3
average train loss = -0.208552    	average train batch reward = 0.660
validation accuracy = 0.121		average validation NDCG = 0.689

epoch 4
average train loss = -0.204226    	average train batch reward = 0.662
validation accuracy = 0.123		average validation NDCG = 0.690

epoch 5
average train loss = -0.208733    	average train batch reward = 0.661
validation accuracy = 0.123		average validation NDCG = 0.690

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.128		average validation NDCG = 0.680

epoch 1
average train loss = -0.194580    	average train batch reward = 0.647
validation accuracy = 0.129		average validation NDCG = 0.680

epoch 2
average train loss = -0.198514    	average train batch reward = 0.644
validation accuracy = 0.129		average validation NDCG = 0.680

epoch 3
average train loss = -0.204140    	average train batch reward = 0.648
validation accuracy = 0.130		average validation NDCG = 0.681

epoch 4
average train loss = -0.201084    	average train batch reward = 0.648
validation accuracy = 0.130		average validation NDCG = 0.681

epoch 5
average train loss = -0.197904    	average train batch reward = 0.647
validation accuracy = 0.131		average validation NDCG = 0.681

Current setup 1e-07 explored, avg = 0.677544, std = 0.008319, min = 0.667871, max = 0.691258
========
Currently the best setups are [9.9999999999999995e-08, (), ()], which got average scores of [0.67754408121111953, -1, -1]
========
Hyperparameters:
k = 5
Batch size = 64
Num epochs = 5
Learning rate = 0.000001
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125765f0>
Reward function = <function ndcg_full at 0x112576668>
Greedy action = <function sample at 0x10a55bc08>
Explore action = <explorers.explore.Uniform instance at 0x119d89710>
Baseline = 0.0
Weight regularization strength = 0.0
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.075		average validation NDCG = 0.654

epoch 1
average train loss = -0.166484    	average train batch reward = 0.625
validation accuracy = 0.076		average validation NDCG = 0.656

epoch 2
average train loss = -0.174407    	average train batch reward = 0.627
validation accuracy = 0.078		average validation NDCG = 0.658

epoch 3
average train loss = -0.183574    	average train batch reward = 0.629
validation accuracy = 0.080		average validation NDCG = 0.661

epoch 4
average train loss = -0.194840    	average train batch reward = 0.629
validation accuracy = 0.082		average validation NDCG = 0.665

epoch 5
average train loss = -0.194537    	average train batch reward = 0.632
validation accuracy = 0.085		average validation NDCG = 0.668

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.068		average validation NDCG = 0.644

epoch 1
average train loss = -0.169897    	average train batch reward = 0.617
validation accuracy = 0.070		average validation NDCG = 0.645

epoch 2
average train loss = -0.187388    	average train batch reward = 0.619
validation accuracy = 0.072		average validation NDCG = 0.646

epoch 3
average train loss = -0.182339    	average train batch reward = 0.619
validation accuracy = 0.074		average validation NDCG = 0.647

epoch 4
average train loss = -0.191844    	average train batch reward = 0.620
validation accuracy = 0.076		average validation NDCG = 0.648

epoch 5
average train loss = -0.190138    	average train batch reward = 0.620
validation accuracy = 0.078		average validation NDCG = 0.650

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.106		average validation NDCG = 0.671

epoch 1
average train loss = -0.192907    	average train batch reward = 0.649
validation accuracy = 0.110		average validation NDCG = 0.673

epoch 2
average train loss = -0.199687    	average train batch reward = 0.651
validation accuracy = 0.114		average validation NDCG = 0.676

epoch 3
average train loss = -0.198234    	average train batch reward = 0.652
validation accuracy = 0.118		average validation NDCG = 0.679

epoch 4
average train loss = -0.208895    	average train batch reward = 0.656
validation accuracy = 0.124		average validation NDCG = 0.681

epoch 5
average train loss = -0.208644    	average train batch reward = 0.658
validation accuracy = 0.130		average validation NDCG = 0.684

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.118		average validation NDCG = 0.656

epoch 1
average train loss = -0.171602    	average train batch reward = 0.629
validation accuracy = 0.121		average validation NDCG = 0.659

epoch 2
average train loss = -0.185130    	average train batch reward = 0.631
validation accuracy = 0.125		average validation NDCG = 0.662

epoch 3
average train loss = -0.189907    	average train batch reward = 0.633
validation accuracy = 0.129		average validation NDCG = 0.665

epoch 4
average train loss = -0.196479    	average train batch reward = 0.634
validation accuracy = 0.132		average validation NDCG = 0.668

epoch 5
average train loss = -0.203955    	average train batch reward = 0.637
validation accuracy = 0.134		average validation NDCG = 0.670

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.099		average validation NDCG = 0.668

epoch 1
average train loss = -0.166126    	average train batch reward = 0.642
validation accuracy = 0.104		average validation NDCG = 0.670

epoch 2
average train loss = -0.172358    	average train batch reward = 0.645
validation accuracy = 0.113		average validation NDCG = 0.674

epoch 3
average train loss = -0.185710    	average train batch reward = 0.647
validation accuracy = 0.120		average validation NDCG = 0.676

epoch 4
average train loss = -0.190657    	average train batch reward = 0.649
validation accuracy = 0.125		average validation NDCG = 0.680

epoch 5
average train loss = -0.195862    	average train batch reward = 0.651
validation accuracy = 0.129		average validation NDCG = 0.684

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.103		average validation NDCG = 0.673

epoch 1
average train loss = -0.212603    	average train batch reward = 0.643
validation accuracy = 0.109		average validation NDCG = 0.676

epoch 2
average train loss = -0.215909    	average train batch reward = 0.647
validation accuracy = 0.114		average validation NDCG = 0.680

epoch 3
average train loss = -0.224134    	average train batch reward = 0.648
validation accuracy = 0.119		average validation NDCG = 0.683

epoch 4
average train loss = -0.227626    	average train batch reward = 0.648
validation accuracy = 0.125		average validation NDCG = 0.687

epoch 5
average train loss = -0.238682    	average train batch reward = 0.653
validation accuracy = 0.134		average validation NDCG = 0.690

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.118		average validation NDCG = 0.691

epoch 1
average train loss = -0.193942    	average train batch reward = 0.655
validation accuracy = 0.125		average validation NDCG = 0.694

epoch 2
average train loss = -0.203777    	average train batch reward = 0.658
validation accuracy = 0.131		average validation NDCG = 0.697

epoch 3
average train loss = -0.210516    	average train batch reward = 0.658
validation accuracy = 0.138		average validation NDCG = 0.701

epoch 4
average train loss = -0.231807    	average train batch reward = 0.664
validation accuracy = 0.146		average validation NDCG = 0.704

epoch 5
average train loss = -0.236239    	average train batch reward = 0.667
validation accuracy = 0.156		average validation NDCG = 0.707

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.080		average validation NDCG = 0.675

epoch 1
average train loss = -0.182515    	average train batch reward = 0.643
validation accuracy = 0.082		average validation NDCG = 0.678

epoch 2
average train loss = -0.204055    	average train batch reward = 0.646
validation accuracy = 0.086		average validation NDCG = 0.682

epoch 3
average train loss = -0.200041    	average train batch reward = 0.647
validation accuracy = 0.091		average validation NDCG = 0.686

epoch 4
average train loss = -0.215888    	average train batch reward = 0.651
validation accuracy = 0.097		average validation NDCG = 0.689

epoch 5
average train loss = -0.220155    	average train batch reward = 0.654
validation accuracy = 0.106		average validation NDCG = 0.694

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.096		average validation NDCG = 0.659

epoch 1
average train loss = -0.205313    	average train batch reward = 0.629
validation accuracy = 0.100		average validation NDCG = 0.661

epoch 2
average train loss = -0.217809    	average train batch reward = 0.630
validation accuracy = 0.102		average validation NDCG = 0.663

epoch 3
average train loss = -0.221873    	average train batch reward = 0.630
validation accuracy = 0.107		average validation NDCG = 0.666

epoch 4
average train loss = -0.226859    	average train batch reward = 0.633
validation accuracy = 0.109		average validation NDCG = 0.669

epoch 5
average train loss = -0.229549    	average train batch reward = 0.636
validation accuracy = 0.113		average validation NDCG = 0.672

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.069		average validation NDCG = 0.650

epoch 1
average train loss = -0.188470    	average train batch reward = 0.619
validation accuracy = 0.070		average validation NDCG = 0.651

epoch 2
average train loss = -0.193750    	average train batch reward = 0.620
validation accuracy = 0.072		average validation NDCG = 0.652

epoch 3
average train loss = -0.192947    	average train batch reward = 0.621
validation accuracy = 0.074		average validation NDCG = 0.654

epoch 4
average train loss = -0.202129    	average train batch reward = 0.619
validation accuracy = 0.075		average validation NDCG = 0.655

epoch 5
average train loss = -0.209978    	average train batch reward = 0.620
validation accuracy = 0.077		average validation NDCG = 0.657

Current setup 1e-06 explored, avg = 0.677577, std = 0.016703, min = 0.649555, max = 0.707080
========
Currently the best setups are [9.9999999999999995e-07, 9.9999999999999995e-08, ()], which got average scores of [0.67757681181000262, 0.67754408121111953, -1]
========
Hyperparameters:
k = 5
Batch size = 64
Num epochs = 5
Learning rate = 0.000010
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125765f0>
Reward function = <function ndcg_full at 0x112576668>
Greedy action = <function sample at 0x10a55bc08>
Explore action = <explorers.explore.Uniform instance at 0x11f545a28>
Baseline = 0.0
Weight regularization strength = 0.0
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.094		average validation NDCG = 0.661

epoch 1
average train loss = -0.201472    	average train batch reward = 0.642
validation accuracy = 0.148		average validation NDCG = 0.685

epoch 2
average train loss = -0.281389    	average train batch reward = 0.666
validation accuracy = 0.222		average validation NDCG = 0.721

epoch 3
average train loss = -0.435200    	average train batch reward = 0.687
validation accuracy = 0.299		average validation NDCG = 0.736

epoch 4
average train loss = -0.601045    	average train batch reward = 0.704
validation accuracy = 0.338		average validation NDCG = 0.745

epoch 5
average train loss = -0.755410    	average train batch reward = 0.715
validation accuracy = 0.357		average validation NDCG = 0.751

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.120		average validation NDCG = 0.680

epoch 1
average train loss = -0.231943    	average train batch reward = 0.668
validation accuracy = 0.179		average validation NDCG = 0.721

epoch 2
average train loss = -0.359336    	average train batch reward = 0.707
validation accuracy = 0.256		average validation NDCG = 0.770

epoch 3
average train loss = -0.534648    	average train batch reward = 0.744
validation accuracy = 0.341		average validation NDCG = 0.797

epoch 4
average train loss = -0.693617    	average train batch reward = 0.771
validation accuracy = 0.411		average validation NDCG = 0.815

epoch 5
average train loss = -0.861321    	average train batch reward = 0.789
validation accuracy = 0.447		average validation NDCG = 0.827

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.152		average validation NDCG = 0.704

epoch 1
average train loss = -0.258788    	average train batch reward = 0.687
validation accuracy = 0.257		average validation NDCG = 0.762

epoch 2
average train loss = -0.432571    	average train batch reward = 0.734
validation accuracy = 0.343		average validation NDCG = 0.803

epoch 3
average train loss = -0.630806    	average train batch reward = 0.764
validation accuracy = 0.395		average validation NDCG = 0.818

epoch 4
average train loss = -0.791274    	average train batch reward = 0.781
validation accuracy = 0.423		average validation NDCG = 0.828

epoch 5
average train loss = -0.930658    	average train batch reward = 0.792
validation accuracy = 0.441		average validation NDCG = 0.831

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.061		average validation NDCG = 0.657

epoch 1
average train loss = -0.203802    	average train batch reward = 0.633
validation accuracy = 0.069		average validation NDCG = 0.673

epoch 2
average train loss = -0.289981    	average train batch reward = 0.654
validation accuracy = 0.128		average validation NDCG = 0.708

epoch 3
average train loss = -0.428094    	average train batch reward = 0.681
validation accuracy = 0.204		average validation NDCG = 0.735

epoch 4
average train loss = -0.570356    	average train batch reward = 0.702
validation accuracy = 0.254		average validation NDCG = 0.757

epoch 5
average train loss = -0.704281    	average train batch reward = 0.716
validation accuracy = 0.287		average validation NDCG = 0.774

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.113		average validation NDCG = 0.670

epoch 1
average train loss = -0.219960    	average train batch reward = 0.644
validation accuracy = 0.153		average validation NDCG = 0.695

epoch 2
average train loss = -0.308395    	average train batch reward = 0.665
validation accuracy = 0.194		average validation NDCG = 0.719

epoch 3
average train loss = -0.427645    	average train batch reward = 0.687
validation accuracy = 0.242		average validation NDCG = 0.737

epoch 4
average train loss = -0.582554    	average train batch reward = 0.707
validation accuracy = 0.285		average validation NDCG = 0.750

epoch 5
average train loss = -0.742465    	average train batch reward = 0.722
validation accuracy = 0.331		average validation NDCG = 0.759

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.079		average validation NDCG = 0.661

epoch 1
average train loss = -0.202099    	average train batch reward = 0.630
validation accuracy = 0.092		average validation NDCG = 0.670

epoch 2
average train loss = -0.286120    	average train batch reward = 0.639
validation accuracy = 0.115		average validation NDCG = 0.689

epoch 3
average train loss = -0.391331    	average train batch reward = 0.651
validation accuracy = 0.144		average validation NDCG = 0.711

epoch 4
average train loss = -0.496309    	average train batch reward = 0.666
validation accuracy = 0.180		average validation NDCG = 0.723

epoch 5
average train loss = -0.655369    	average train batch reward = 0.682
validation accuracy = 0.216		average validation NDCG = 0.737

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.085		average validation NDCG = 0.669

epoch 1
average train loss = -0.235984    	average train batch reward = 0.644
validation accuracy = 0.151		average validation NDCG = 0.701

epoch 2
average train loss = -0.346278    	average train batch reward = 0.663
validation accuracy = 0.221		average validation NDCG = 0.720

epoch 3
average train loss = -0.503638    	average train batch reward = 0.679
validation accuracy = 0.266		average validation NDCG = 0.735

epoch 4
average train loss = -0.685002    	average train batch reward = 0.698
validation accuracy = 0.296		average validation NDCG = 0.751

epoch 5
average train loss = -0.788954    	average train batch reward = 0.711
validation accuracy = 0.322		average validation NDCG = 0.761

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.080		average validation NDCG = 0.655

epoch 1
average train loss = -0.206915    	average train batch reward = 0.635
validation accuracy = 0.106		average validation NDCG = 0.679

epoch 2
average train loss = -0.296005    	average train batch reward = 0.653
validation accuracy = 0.179		average validation NDCG = 0.709

epoch 3
average train loss = -0.431935    	average train batch reward = 0.676
validation accuracy = 0.248		average validation NDCG = 0.731

epoch 4
average train loss = -0.598141    	average train batch reward = 0.698
validation accuracy = 0.290		average validation NDCG = 0.751

epoch 5
average train loss = -0.719919    	average train batch reward = 0.715
validation accuracy = 0.317		average validation NDCG = 0.760

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.096		average validation NDCG = 0.675

epoch 1
average train loss = -0.215413    	average train batch reward = 0.655
validation accuracy = 0.141		average validation NDCG = 0.710

epoch 2
average train loss = -0.317796    	average train batch reward = 0.688
validation accuracy = 0.228		average validation NDCG = 0.753

epoch 3
average train loss = -0.497858    	average train batch reward = 0.725
validation accuracy = 0.341		average validation NDCG = 0.787

epoch 4
average train loss = -0.685695    	average train batch reward = 0.757
validation accuracy = 0.428		average validation NDCG = 0.813

epoch 5
average train loss = -0.846817    	average train batch reward = 0.780
validation accuracy = 0.463		average validation NDCG = 0.828

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.102		average validation NDCG = 0.661

epoch 1
average train loss = -0.208157    	average train batch reward = 0.639
validation accuracy = 0.127		average validation NDCG = 0.688

epoch 2
average train loss = -0.291680    	average train batch reward = 0.660
validation accuracy = 0.176		average validation NDCG = 0.724

epoch 3
average train loss = -0.411150    	average train batch reward = 0.686
validation accuracy = 0.220		average validation NDCG = 0.747

epoch 4
average train loss = -0.552448    	average train batch reward = 0.709
validation accuracy = 0.261		average validation NDCG = 0.760

epoch 5
average train loss = -0.699514    	average train batch reward = 0.727
validation accuracy = 0.291		average validation NDCG = 0.769

Current setup 1e-05 explored, avg = 0.779763, std = 0.033375, min = 0.737448, max = 0.831450
========
Currently the best setups are [1.0000000000000001e-05, 9.9999999999999995e-07, 9.9999999999999995e-08], which got average scores of [0.77976293655166873, 0.67757681181000262, 0.67754408121111953]
========
Hyperparameters:
k = 5
Batch size = 64
Num epochs = 5
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125765f0>
Reward function = <function ndcg_full at 0x112576668>
Greedy action = <function sample at 0x10a55bc08>
Explore action = <explorers.explore.Uniform instance at 0x11dec2290>
Baseline = 0.0
Weight regularization strength = 0.0
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.109		average validation NDCG = 0.662

epoch 1
average train loss = -0.831505    	average train batch reward = 0.714
validation accuracy = 0.332		average validation NDCG = 0.760

epoch 2
average train loss = -1.964531    	average train batch reward = 0.726
validation accuracy = 0.351		average validation NDCG = 0.759

epoch 3
average train loss = -2.793614    	average train batch reward = 0.729
validation accuracy = 0.359		average validation NDCG = 0.754

epoch 4
average train loss = -3.838201    	average train batch reward = 0.726
validation accuracy = 0.347		average validation NDCG = 0.750

epoch 5
average train loss = -5.053185    	average train batch reward = 0.726
validation accuracy = 0.351		average validation NDCG = 0.751

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.099		average validation NDCG = 0.675

epoch 1
average train loss = -0.824820    	average train batch reward = 0.754
validation accuracy = 0.480		average validation NDCG = 0.841

epoch 2
average train loss = -2.038935    	average train batch reward = 0.834
validation accuracy = 0.545		average validation NDCG = 0.854

epoch 3
average train loss = -3.133653    	average train batch reward = 0.843
validation accuracy = 0.555		average validation NDCG = 0.836

epoch 4
average train loss = -4.416504    	average train batch reward = 0.838
validation accuracy = 0.543		average validation NDCG = 0.822

epoch 5
average train loss = -5.229419    	average train batch reward = 0.833
validation accuracy = 0.534		average validation NDCG = 0.817

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.104		average validation NDCG = 0.654

epoch 1
average train loss = -0.765173    	average train batch reward = 0.680
validation accuracy = 0.342		average validation NDCG = 0.737

epoch 2
average train loss = -1.991185    	average train batch reward = 0.703
validation accuracy = 0.361		average validation NDCG = 0.725

epoch 3
average train loss = -3.128776    	average train batch reward = 0.701
validation accuracy = 0.359		average validation NDCG = 0.716

epoch 4
average train loss = -4.298970    	average train batch reward = 0.702
validation accuracy = 0.351		average validation NDCG = 0.715

epoch 5
average train loss = -5.855213    	average train batch reward = 0.699
validation accuracy = 0.345		average validation NDCG = 0.713

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.112		average validation NDCG = 0.678

epoch 1
average train loss = -0.687584    	average train batch reward = 0.674
validation accuracy = 0.301		average validation NDCG = 0.758

epoch 2
average train loss = -1.592389    	average train batch reward = 0.687
validation accuracy = 0.335		average validation NDCG = 0.762

epoch 3
average train loss = -2.374682    	average train batch reward = 0.686
validation accuracy = 0.344		average validation NDCG = 0.761

epoch 4
average train loss = -3.219601    	average train batch reward = 0.686
validation accuracy = 0.348		average validation NDCG = 0.755

epoch 5
average train loss = -4.066378    	average train batch reward = 0.685
validation accuracy = 0.345		average validation NDCG = 0.754

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.094		average validation NDCG = 0.670

epoch 1
average train loss = -0.613647    	average train batch reward = 0.657
validation accuracy = 0.283		average validation NDCG = 0.738

epoch 2
average train loss = -1.633681    	average train batch reward = 0.686
validation accuracy = 0.325		average validation NDCG = 0.755

epoch 3
average train loss = -2.565025    	average train batch reward = 0.691
validation accuracy = 0.344		average validation NDCG = 0.751

epoch 4
average train loss = -3.428344    	average train batch reward = 0.695
validation accuracy = 0.344		average validation NDCG = 0.742

epoch 5
average train loss = -4.336458    	average train batch reward = 0.698
validation accuracy = 0.340		average validation NDCG = 0.737

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.113		average validation NDCG = 0.695

epoch 1
average train loss = -0.977260    	average train batch reward = 0.787
validation accuracy = 0.521		average validation NDCG = 0.843

epoch 2
average train loss = -2.278177    	average train batch reward = 0.846
validation accuracy = 0.541		average validation NDCG = 0.842

epoch 3
average train loss = -3.278910    	average train batch reward = 0.846
validation accuracy = 0.538		average validation NDCG = 0.831

epoch 4
average train loss = -4.509559    	average train batch reward = 0.840
validation accuracy = 0.529		average validation NDCG = 0.823

epoch 5
average train loss = -5.697998    	average train batch reward = 0.835
validation accuracy = 0.503		average validation NDCG = 0.812

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.120		average validation NDCG = 0.685

epoch 1
average train loss = -0.891964    	average train batch reward = 0.752
validation accuracy = 0.481		average validation NDCG = 0.832

epoch 2
average train loss = -1.975562    	average train batch reward = 0.815
validation accuracy = 0.523		average validation NDCG = 0.834

epoch 3
average train loss = -3.117649    	average train batch reward = 0.826
validation accuracy = 0.543		average validation NDCG = 0.824

epoch 4
average train loss = -4.559426    	average train batch reward = 0.833
validation accuracy = 0.542		average validation NDCG = 0.820

epoch 5
average train loss = -6.259171    	average train batch reward = 0.829
validation accuracy = 0.527		average validation NDCG = 0.806

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.065		average validation NDCG = 0.656

epoch 1
average train loss = -0.701453    	average train batch reward = 0.666
validation accuracy = 0.295		average validation NDCG = 0.736

epoch 2
average train loss = -1.607779    	average train batch reward = 0.707
validation accuracy = 0.351		average validation NDCG = 0.748

epoch 3
average train loss = -2.586763    	average train batch reward = 0.706
validation accuracy = 0.352		average validation NDCG = 0.743

epoch 4
average train loss = -3.675377    	average train batch reward = 0.706
validation accuracy = 0.363		average validation NDCG = 0.744

epoch 5
average train loss = -4.884060    	average train batch reward = 0.706
validation accuracy = 0.346		average validation NDCG = 0.741

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.103		average validation NDCG = 0.663

epoch 1
average train loss = -0.864890    	average train batch reward = 0.726
validation accuracy = 0.417		average validation NDCG = 0.784

epoch 2
average train loss = -1.943317    	average train batch reward = 0.755
validation accuracy = 0.467		average validation NDCG = 0.775

epoch 3
average train loss = -3.095760    	average train batch reward = 0.751
validation accuracy = 0.464		average validation NDCG = 0.770

epoch 4
average train loss = -4.134566    	average train batch reward = 0.740
validation accuracy = 0.452		average validation NDCG = 0.763

epoch 5
average train loss = -5.229201    	average train batch reward = 0.733
validation accuracy = 0.430		average validation NDCG = 0.753

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.087		average validation NDCG = 0.653

epoch 1
average train loss = -0.778926    	average train batch reward = 0.687
validation accuracy = 0.308		average validation NDCG = 0.757

epoch 2
average train loss = -1.814744    	average train batch reward = 0.731
validation accuracy = 0.384		average validation NDCG = 0.764

epoch 3
average train loss = -2.816085    	average train batch reward = 0.729
validation accuracy = 0.406		average validation NDCG = 0.754

epoch 4
average train loss = -3.888529    	average train batch reward = 0.724
validation accuracy = 0.404		average validation NDCG = 0.754

epoch 5
average train loss = -5.523354    	average train batch reward = 0.721
validation accuracy = 0.393		average validation NDCG = 0.749

Current setup 0.0001 explored, avg = 0.784191, std = 0.040777, min = 0.737128, max = 0.853987
========
Currently the best setups are [0.0001, 1.0000000000000001e-05, 9.9999999999999995e-07], which got average scores of [0.78419109943043774, 0.77976293655166873, 0.67757681181000262]
========
Hyperparameters:
k = 5
Batch size = 64
Num epochs = 5
Learning rate = 0.001000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125765f0>
Reward function = <function ndcg_full at 0x112576668>
Greedy action = <function sample at 0x10a55bc08>
Explore action = <explorers.explore.Uniform instance at 0x127120098>
Baseline = 0.0
Weight regularization strength = 0.0
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.072		average validation NDCG = 0.663

epoch 1
average train loss = -5.576818    	average train batch reward = 0.719
validation accuracy = 0.338		average validation NDCG = 0.739

epoch 2
average train loss = -18.117773    	average train batch reward = 0.720
validation accuracy = 0.299		average validation NDCG = 0.746

epoch 3
average train loss = -27.541796    	average train batch reward = 0.722
validation accuracy = 0.293		average validation NDCG = 0.748

epoch 4
average train loss = -39.271160    	average train batch reward = 0.722
validation accuracy = 0.233		average validation NDCG = 0.744

epoch 5
average train loss = -44.259781    	average train batch reward = 0.720
validation accuracy = 0.215		average validation NDCG = 0.748

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.049		average validation NDCG = 0.650

epoch 1
average train loss = -6.021659    	average train batch reward = 0.724
validation accuracy = 0.234		average validation NDCG = 0.723

epoch 2
average train loss = -18.542206    	average train batch reward = 0.708
validation accuracy = 0.192		average validation NDCG = 0.719

epoch 3
average train loss = -29.482140    	average train batch reward = 0.701
validation accuracy = 0.210		average validation NDCG = 0.718

epoch 4
average train loss = -41.329758    	average train batch reward = 0.701
validation accuracy = 0.204		average validation NDCG = 0.717

epoch 5
average train loss = -53.470276    	average train batch reward = 0.700
validation accuracy = 0.210		average validation NDCG = 0.719

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.129		average validation NDCG = 0.658

epoch 1
average train loss = -4.607672    	average train batch reward = 0.663
validation accuracy = 0.202		average validation NDCG = 0.693

epoch 2
average train loss = -18.255001    	average train batch reward = 0.640
validation accuracy = 0.097		average validation NDCG = 0.675

epoch 3
average train loss = -30.775030    	average train batch reward = 0.636
validation accuracy = 0.100		average validation NDCG = 0.672

epoch 4
average train loss = -39.403427    	average train batch reward = 0.638
validation accuracy = 0.056		average validation NDCG = 0.681

epoch 5
average train loss = -52.174595    	average train batch reward = 0.641
validation accuracy = 0.080		average validation NDCG = 0.680

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.153		average validation NDCG = 0.684

epoch 1
average train loss = -6.301305    	average train batch reward = 0.761
validation accuracy = 0.355		average validation NDCG = 0.744

epoch 2
average train loss = -18.284945    	average train batch reward = 0.720
validation accuracy = 0.339		average validation NDCG = 0.725

epoch 3
average train loss = -29.470110    	average train batch reward = 0.708
validation accuracy = 0.236		average validation NDCG = 0.720

epoch 4
average train loss = -39.967045    	average train batch reward = 0.699
validation accuracy = 0.211		average validation NDCG = 0.720

epoch 5
average train loss = -46.348888    	average train batch reward = 0.703
validation accuracy = 0.182		average validation NDCG = 0.720

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.073		average validation NDCG = 0.672

epoch 1
average train loss = -5.436814    	average train batch reward = 0.738
validation accuracy = 0.338		average validation NDCG = 0.752

epoch 2
average train loss = -16.664881    	average train batch reward = 0.734
validation accuracy = 0.315		average validation NDCG = 0.748

epoch 3
average train loss = -24.263187    	average train batch reward = 0.739
validation accuracy = 0.303		average validation NDCG = 0.756

epoch 4
average train loss = -33.637012    	average train batch reward = 0.740
validation accuracy = 0.278		average validation NDCG = 0.771

epoch 5
average train loss = -39.913414    	average train batch reward = 0.747
validation accuracy = 0.283		average validation NDCG = 0.762

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.105		average validation NDCG = 0.664

epoch 1
average train loss = -6.116992    	average train batch reward = 0.696
validation accuracy = 0.256		average validation NDCG = 0.715

epoch 2
average train loss = -16.305157    	average train batch reward = 0.702
validation accuracy = 0.237		average validation NDCG = 0.713

epoch 3
average train loss = -27.968216    	average train batch reward = 0.702
validation accuracy = 0.218		average validation NDCG = 0.726

epoch 4
average train loss = -37.817631    	average train batch reward = 0.704
validation accuracy = 0.158		average validation NDCG = 0.726

epoch 5
average train loss = -47.835491    	average train batch reward = 0.705
validation accuracy = 0.162		average validation NDCG = 0.724

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.085		average validation NDCG = 0.671

epoch 1
average train loss = -5.820169    	average train batch reward = 0.737
validation accuracy = 0.427		average validation NDCG = 0.753

epoch 2
average train loss = -19.214333    	average train batch reward = 0.732
validation accuracy = 0.335		average validation NDCG = 0.735

epoch 3
average train loss = -29.872444    	average train batch reward = 0.722
validation accuracy = 0.209		average validation NDCG = 0.730

epoch 4
average train loss = -42.754456    	average train batch reward = 0.714
validation accuracy = 0.205		average validation NDCG = 0.725

epoch 5
average train loss = -53.215401    	average train batch reward = 0.711
validation accuracy = 0.204		average validation NDCG = 0.727

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.096		average validation NDCG = 0.676

epoch 1
average train loss = -5.662835    	average train batch reward = 0.754
validation accuracy = 0.384		average validation NDCG = 0.745

epoch 2
average train loss = -18.151451    	average train batch reward = 0.745
validation accuracy = 0.356		average validation NDCG = 0.750

epoch 3
average train loss = -28.013348    	average train batch reward = 0.732
validation accuracy = 0.236		average validation NDCG = 0.736

epoch 4
average train loss = -40.236530    	average train batch reward = 0.718
validation accuracy = 0.144		average validation NDCG = 0.726

epoch 5
average train loss = -51.493931    	average train batch reward = 0.711
validation accuracy = 0.143		average validation NDCG = 0.725

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.109		average validation NDCG = 0.680

epoch 1
average train loss = -4.441327    	average train batch reward = 0.607
validation accuracy = 0.230		average validation NDCG = 0.677

epoch 2
average train loss = -17.791561    	average train batch reward = 0.641
validation accuracy = 0.125		average validation NDCG = 0.690

epoch 3
average train loss = -29.802273    	average train batch reward = 0.661
validation accuracy = 0.196		average validation NDCG = 0.707

epoch 4
average train loss = -37.133450    	average train batch reward = 0.686
validation accuracy = 0.205		average validation NDCG = 0.710

epoch 5
average train loss = -47.561363    	average train batch reward = 0.682
validation accuracy = 0.158		average validation NDCG = 0.713

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.082		average validation NDCG = 0.675

epoch 1
average train loss = -5.176963    	average train batch reward = 0.707
validation accuracy = 0.244		average validation NDCG = 0.738

epoch 2
average train loss = -18.721148    	average train batch reward = 0.737
validation accuracy = 0.244		average validation NDCG = 0.752

epoch 3
average train loss = -29.538204    	average train batch reward = 0.732
validation accuracy = 0.252		average validation NDCG = 0.748

epoch 4
average train loss = -38.979034    	average train batch reward = 0.731
validation accuracy = 0.224		average validation NDCG = 0.751

epoch 5
average train loss = -49.242893    	average train batch reward = 0.728
validation accuracy = 0.203		average validation NDCG = 0.739

Current setup 0.001 explored, avg = 0.737271, std = 0.021945, min = 0.692650, max = 0.770669
========
Currently the best setups are [0.0001, 1.0000000000000001e-05, 0.001], which got average scores of [0.78419109943043774, 0.77976293655166873, 0.73727119866775226]
========
Hyperparameters:
k = 5
Batch size = 64
Num epochs = 5
Learning rate = 0.010000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125765f0>
Reward function = <function ndcg_full at 0x112576668>
Greedy action = <function sample at 0x10a55bc08>
Explore action = <explorers.explore.Uniform instance at 0x12484f440>
Baseline = 0.0
Weight regularization strength = 0.0
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.119		average validation NDCG = 0.700

epoch 1
average train loss = -57.903980    	average train batch reward = 0.680
validation accuracy = 0.137		average validation NDCG = 0.728

epoch 2
average train loss = -170.233749    	average train batch reward = 0.705
validation accuracy = 0.182		average validation NDCG = 0.726

epoch 3
average train loss = -290.900085    	average train batch reward = 0.709
validation accuracy = 0.186		average validation NDCG = 0.727

epoch 4
average train loss = -364.801361    	average train batch reward = 0.714
validation accuracy = 0.171		average validation NDCG = 0.730

epoch 5
average train loss = -476.798157    	average train batch reward = 0.719
validation accuracy = 0.168		average validation NDCG = 0.735

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.076		average validation NDCG = 0.660

epoch 1
average train loss = -58.121418    	average train batch reward = 0.705
validation accuracy = 0.201		average validation NDCG = 0.729

epoch 2
average train loss = -165.234650    	average train batch reward = 0.712
validation accuracy = 0.181		average validation NDCG = 0.729

epoch 3
average train loss = -271.231171    	average train batch reward = 0.714
validation accuracy = 0.180		average validation NDCG = 0.731

epoch 4
average train loss = -359.666687    	average train batch reward = 0.718
validation accuracy = 0.204		average validation NDCG = 0.727

epoch 5
average train loss = -458.907043    	average train batch reward = 0.704
validation accuracy = 0.204		average validation NDCG = 0.723

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.125		average validation NDCG = 0.679

epoch 1
average train loss = -57.906334    	average train batch reward = 0.668
validation accuracy = 0.116		average validation NDCG = 0.685

epoch 2
average train loss = -169.318985    	average train batch reward = 0.656
validation accuracy = 0.199		average validation NDCG = 0.684

epoch 3
average train loss = -265.632477    	average train batch reward = 0.659
validation accuracy = 0.217		average validation NDCG = 0.694

epoch 4
average train loss = -344.529053    	average train batch reward = 0.673
validation accuracy = 0.179		average validation NDCG = 0.701

epoch 5
average train loss = -427.941742    	average train batch reward = 0.678
validation accuracy = 0.212		average validation NDCG = 0.702

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.094		average validation NDCG = 0.673

epoch 1
average train loss = -54.465889    	average train batch reward = 0.711
validation accuracy = 0.165		average validation NDCG = 0.718

epoch 2
average train loss = -150.117355    	average train batch reward = 0.698
validation accuracy = 0.213		average validation NDCG = 0.718

epoch 3
average train loss = -255.026398    	average train batch reward = 0.702
validation accuracy = 0.204		average validation NDCG = 0.721

epoch 4
average train loss = -337.674133    	average train batch reward = 0.703
validation accuracy = 0.209		average validation NDCG = 0.723

epoch 5
average train loss = -441.403809    	average train batch reward = 0.705
validation accuracy = 0.199		average validation NDCG = 0.722

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.099		average validation NDCG = 0.694

epoch 1
average train loss = -63.290279    	average train batch reward = 0.709
validation accuracy = 0.211		average validation NDCG = 0.719

epoch 2
average train loss = -175.052460    	average train batch reward = 0.703
validation accuracy = 0.203		average validation NDCG = 0.716

epoch 3
average train loss = -288.342804    	average train batch reward = 0.693
validation accuracy = 0.198		average validation NDCG = 0.713

epoch 4
average train loss = -371.121124    	average train batch reward = 0.692
validation accuracy = 0.192		average validation NDCG = 0.716

epoch 5
average train loss = -496.018555    	average train batch reward = 0.691
validation accuracy = 0.198		average validation NDCG = 0.718

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.126		average validation NDCG = 0.679

epoch 1
average train loss = -60.849369    	average train batch reward = 0.680
validation accuracy = 0.196		average validation NDCG = 0.711

epoch 2
average train loss = -157.568024    	average train batch reward = 0.703
validation accuracy = 0.154		average validation NDCG = 0.725

epoch 3
average train loss = -263.987518    	average train batch reward = 0.713
validation accuracy = 0.132		average validation NDCG = 0.719

epoch 4
average train loss = -366.664429    	average train batch reward = 0.701
validation accuracy = 0.166		average validation NDCG = 0.722

epoch 5
average train loss = -453.128296    	average train batch reward = 0.702
validation accuracy = 0.135		average validation NDCG = 0.721

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.098		average validation NDCG = 0.687

epoch 1
average train loss = -56.831738    	average train batch reward = 0.720
validation accuracy = 0.184		average validation NDCG = 0.727

epoch 2
average train loss = -167.965881    	average train batch reward = 0.713
validation accuracy = 0.199		average validation NDCG = 0.725

epoch 3
average train loss = -267.979034    	average train batch reward = 0.708
validation accuracy = 0.203		average validation NDCG = 0.728

epoch 4
average train loss = -350.084503    	average train batch reward = 0.714
validation accuracy = 0.219		average validation NDCG = 0.727

epoch 5
average train loss = -458.622284    	average train batch reward = 0.715
validation accuracy = 0.186		average validation NDCG = 0.726

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.101		average validation NDCG = 0.682

epoch 1
average train loss = -46.084885    	average train batch reward = 0.696
validation accuracy = 0.117		average validation NDCG = 0.706

epoch 2
average train loss = -143.096741    	average train batch reward = 0.682
validation accuracy = 0.152		average validation NDCG = 0.701

epoch 3
average train loss = -256.842041    	average train batch reward = 0.673
validation accuracy = 0.179		average validation NDCG = 0.702

epoch 4
average train loss = -346.986633    	average train batch reward = 0.685
validation accuracy = 0.174		average validation NDCG = 0.705

epoch 5
average train loss = -419.543182    	average train batch reward = 0.682
validation accuracy = 0.181		average validation NDCG = 0.701

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.089		average validation NDCG = 0.668

epoch 1
average train loss = -54.333614    	average train batch reward = 0.695
validation accuracy = 0.207		average validation NDCG = 0.733

epoch 2
average train loss = -144.316376    	average train batch reward = 0.697
validation accuracy = 0.178		average validation NDCG = 0.727

epoch 3
average train loss = -234.102280    	average train batch reward = 0.690
validation accuracy = 0.148		average validation NDCG = 0.717

epoch 4
average train loss = -332.527222    	average train batch reward = 0.681
validation accuracy = 0.118		average validation NDCG = 0.708

epoch 5
average train loss = -454.470428    	average train batch reward = 0.680
validation accuracy = 0.132		average validation NDCG = 0.707

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.100		average validation NDCG = 0.671

epoch 1
average train loss = -57.586491    	average train batch reward = 0.672
validation accuracy = 0.080		average validation NDCG = 0.706

epoch 2
average train loss = -167.316376    	average train batch reward = 0.688
validation accuracy = 0.108		average validation NDCG = 0.717

epoch 3
average train loss = -237.871735    	average train batch reward = 0.688
validation accuracy = 0.199		average validation NDCG = 0.712

epoch 4
average train loss = -350.851410    	average train batch reward = 0.690
validation accuracy = 0.146		average validation NDCG = 0.717

epoch 5
average train loss = -439.228119    	average train batch reward = 0.694
validation accuracy = 0.132		average validation NDCG = 0.714

Current setup 0.01 explored, avg = 0.721816, std = 0.010405, min = 0.702387, max = 0.734509
========
Currently the best setups are [0.0001, 1.0000000000000001e-05, 0.001], which got average scores of [0.78419109943043774, 0.77976293655166873, 0.73727119866775226]
========
Hyperparameters:
k = 5
Batch size = 64
Num epochs = 5
Learning rate = 0.100000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125765f0>
Reward function = <function ndcg_full at 0x112576668>
Greedy action = <function sample at 0x10a55bc08>
Explore action = <explorers.explore.Uniform instance at 0x12e478368>
Baseline = 0.0
Weight regularization strength = 0.0
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.084		average validation NDCG = 0.670

epoch 1
average train loss = -453.501251    	average train batch reward = 0.643
validation accuracy = 0.159		average validation NDCG = 0.707

epoch 2
average train loss = -1442.479004    	average train batch reward = 0.693
validation accuracy = 0.184		average validation NDCG = 0.719

epoch 3
average train loss = -2502.071289    	average train batch reward = 0.704
validation accuracy = 0.153		average validation NDCG = 0.726

epoch 4
average train loss = -3565.822998    	average train batch reward = 0.707
validation accuracy = 0.160		average validation NDCG = 0.728

epoch 5
average train loss = -4452.197754    	average train batch reward = 0.703
validation accuracy = 0.171		average validation NDCG = 0.720

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.114		average validation NDCG = 0.672

epoch 1
average train loss = -706.472229    	average train batch reward = 0.679
validation accuracy = 0.090		average validation NDCG = 0.704

epoch 2
average train loss = -1803.554565    	average train batch reward = 0.672
validation accuracy = 0.100		average validation NDCG = 0.700

epoch 3
average train loss = -2866.291992    	average train batch reward = 0.673
validation accuracy = 0.099		average validation NDCG = 0.709

epoch 4
average train loss = -3867.554932    	average train batch reward = 0.680
validation accuracy = 0.099		average validation NDCG = 0.712

epoch 5
average train loss = -5008.347168    	average train batch reward = 0.686
validation accuracy = 0.100		average validation NDCG = 0.712

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.097		average validation NDCG = 0.663

epoch 1
average train loss = -451.415070    	average train batch reward = 0.683
validation accuracy = 0.154		average validation NDCG = 0.706

epoch 2
average train loss = -1492.680786    	average train batch reward = 0.680
validation accuracy = 0.088		average validation NDCG = 0.711

epoch 3
average train loss = -2589.629639    	average train batch reward = 0.678
validation accuracy = 0.158		average validation NDCG = 0.708

epoch 4
average train loss = -3652.718994    	average train batch reward = 0.683
validation accuracy = 0.147		average validation NDCG = 0.709

epoch 5
average train loss = -4784.012695    	average train batch reward = 0.677
validation accuracy = 0.170		average validation NDCG = 0.704

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.122		average validation NDCG = 0.689

epoch 1
average train loss = -484.802490    	average train batch reward = 0.671
validation accuracy = 0.140		average validation NDCG = 0.713

epoch 2
average train loss = -1495.583496    	average train batch reward = 0.695
validation accuracy = 0.166		average validation NDCG = 0.713

epoch 3
average train loss = -2419.160400    	average train batch reward = 0.689
validation accuracy = 0.147		average validation NDCG = 0.703

epoch 4
average train loss = -3276.530273    	average train batch reward = 0.686
validation accuracy = 0.134		average validation NDCG = 0.711

epoch 5
average train loss = -3895.517822    	average train batch reward = 0.682
validation accuracy = 0.148		average validation NDCG = 0.714

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.115		average validation NDCG = 0.692

epoch 1
average train loss = -466.902283    	average train batch reward = 0.690
validation accuracy = 0.092		average validation NDCG = 0.707

epoch 2
average train loss = -1489.700684    	average train batch reward = 0.680
validation accuracy = 0.188		average validation NDCG = 0.714

epoch 3
average train loss = -2476.865723    	average train batch reward = 0.684
validation accuracy = 0.159		average validation NDCG = 0.713

epoch 4
average train loss = -3508.745117    	average train batch reward = 0.690
validation accuracy = 0.203		average validation NDCG = 0.709

epoch 5
average train loss = -4506.375977    	average train batch reward = 0.676
validation accuracy = 0.191		average validation NDCG = 0.711

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.069		average validation NDCG = 0.666

epoch 1
average train loss = -457.241974    	average train batch reward = 0.713
validation accuracy = 0.157		average validation NDCG = 0.726

epoch 2
average train loss = -1398.180786    	average train batch reward = 0.710
validation accuracy = 0.175		average validation NDCG = 0.724

epoch 3
average train loss = -2435.020020    	average train batch reward = 0.709
validation accuracy = 0.209		average validation NDCG = 0.721

epoch 4
average train loss = -3171.966064    	average train batch reward = 0.715
validation accuracy = 0.219		average validation NDCG = 0.730

epoch 5
average train loss = -4520.315430    	average train batch reward = 0.720
validation accuracy = 0.150		average validation NDCG = 0.729

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.069		average validation NDCG = 0.658

epoch 1
average train loss = -372.692322    	average train batch reward = 0.667
validation accuracy = 0.227		average validation NDCG = 0.717

epoch 2
average train loss = -1304.167236    	average train batch reward = 0.695
validation accuracy = 0.213		average validation NDCG = 0.726

epoch 3
average train loss = -2198.195068    	average train batch reward = 0.705
validation accuracy = 0.175		average validation NDCG = 0.725

epoch 4
average train loss = -3038.281738    	average train batch reward = 0.699
validation accuracy = 0.145		average validation NDCG = 0.724

epoch 5
average train loss = -3897.966797    	average train batch reward = 0.699
validation accuracy = 0.130		average validation NDCG = 0.725

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.085		average validation NDCG = 0.661

epoch 1
average train loss = -475.777710    	average train batch reward = 0.659
validation accuracy = 0.139		average validation NDCG = 0.720

epoch 2
average train loss = -1554.990356    	average train batch reward = 0.684
validation accuracy = 0.157		average validation NDCG = 0.718

epoch 3
average train loss = -2416.453369    	average train batch reward = 0.699
validation accuracy = 0.181		average validation NDCG = 0.727

epoch 4
average train loss = -3415.394531    	average train batch reward = 0.696
validation accuracy = 0.174		average validation NDCG = 0.714

epoch 5
average train loss = -4257.188477    	average train batch reward = 0.694
validation accuracy = 0.154		average validation NDCG = 0.719

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.139		average validation NDCG = 0.688

epoch 1
average train loss = -563.502136    	average train batch reward = 0.640
validation accuracy = 0.114		average validation NDCG = 0.699

epoch 2
average train loss = -1594.291016    	average train batch reward = 0.673
validation accuracy = 0.131		average validation NDCG = 0.715

epoch 3
average train loss = -2698.476318    	average train batch reward = 0.689
validation accuracy = 0.103		average validation NDCG = 0.718

epoch 4
average train loss = -3433.663330    	average train batch reward = 0.694
validation accuracy = 0.134		average validation NDCG = 0.719

epoch 5
average train loss = -4237.767578    	average train batch reward = 0.694
validation accuracy = 0.152		average validation NDCG = 0.716

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.119		average validation NDCG = 0.684

epoch 1
average train loss = -389.996124    	average train batch reward = 0.710
validation accuracy = 0.275		average validation NDCG = 0.745

epoch 2
average train loss = -1398.373779    	average train batch reward = 0.722
validation accuracy = 0.251		average validation NDCG = 0.744

epoch 3
average train loss = -2096.214111    	average train batch reward = 0.726
validation accuracy = 0.233		average validation NDCG = 0.747

epoch 4
average train loss = -2939.667969    	average train batch reward = 0.728
validation accuracy = 0.248		average validation NDCG = 0.751

epoch 5
average train loss = -3674.581299    	average train batch reward = 0.727
validation accuracy = 0.231		average validation NDCG = 0.742

Current setup 0.1 explored, avg = 0.723082, std = 0.011643, min = 0.711084, max = 0.751276
========
Currently the best setups are [0.0001, 1.0000000000000001e-05, 0.001], which got average scores of [0.78419109943043774, 0.77976293655166873, 0.73727119866775226]
========
Hyperparameters:
k = 5
Batch size = 64
Num epochs = 5
Learning rate = 1.000000
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125765f0>
Reward function = <function ndcg_full at 0x112576668>
Greedy action = <function sample at 0x10a55bc08>
Explore action = <explorers.explore.Uniform instance at 0x131deb830>
Baseline = 0.0
Weight regularization strength = 0.0
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.077		average validation NDCG = 0.664

epoch 1
average train loss = -2719.888428    	average train batch reward = 0.741
validation accuracy = 0.210		average validation NDCG = 0.761

epoch 2
average train loss = -7984.957520    	average train batch reward = 0.724
validation accuracy = 0.209		average validation NDCG = 0.749

epoch 3
average train loss = -14487.381836    	average train batch reward = 0.722
validation accuracy = 0.143		average validation NDCG = 0.746

epoch 4
average train loss = -19594.175781    	average train batch reward = 0.721
validation accuracy = 0.144		average validation NDCG = 0.738

epoch 5
average train loss = -23838.847656    	average train batch reward = 0.717
validation accuracy = 0.121		average validation NDCG = 0.733

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.092		average validation NDCG = 0.671

epoch 1
average train loss = -3018.687988    	average train batch reward = 0.710
validation accuracy = 0.160		average validation NDCG = 0.719

epoch 2
average train loss = -9386.883789    	average train batch reward = 0.701
validation accuracy = 0.188		average validation NDCG = 0.718

epoch 3
average train loss = -16024.652344    	average train batch reward = 0.709
validation accuracy = 0.142		average validation NDCG = 0.724

epoch 4
average train loss = -21990.841797    	average train batch reward = 0.711
validation accuracy = 0.135		average validation NDCG = 0.727

epoch 5
average train loss = -28497.486328    	average train batch reward = 0.712
validation accuracy = 0.137		average validation NDCG = 0.727

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.106		average validation NDCG = 0.691

epoch 1
average train loss = -2930.785889    	average train batch reward = 0.690
validation accuracy = 0.078		average validation NDCG = 0.721

epoch 2
average train loss = -8995.489258    	average train batch reward = 0.693
validation accuracy = 0.103		average validation NDCG = 0.721

epoch 3
average train loss = -15880.726562    	average train batch reward = 0.699
validation accuracy = 0.180		average validation NDCG = 0.726

epoch 4
average train loss = -22008.515625    	average train batch reward = 0.705
validation accuracy = 0.183		average validation NDCG = 0.725

epoch 5
average train loss = -27679.964844    	average train batch reward = 0.708
validation accuracy = 0.175		average validation NDCG = 0.728

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.112		average validation NDCG = 0.688

epoch 1
average train loss = -3624.443848    	average train batch reward = 0.659
validation accuracy = 0.199		average validation NDCG = 0.699

epoch 2
average train loss = -10552.671875    	average train batch reward = 0.682
validation accuracy = 0.159		average validation NDCG = 0.711

epoch 3
average train loss = -17583.251953    	average train batch reward = 0.701
validation accuracy = 0.186		average validation NDCG = 0.723

epoch 4
average train loss = -24044.509766    	average train batch reward = 0.703
validation accuracy = 0.166		average validation NDCG = 0.718

epoch 5
average train loss = -28541.927734    	average train batch reward = 0.699
validation accuracy = 0.178		average validation NDCG = 0.718

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.080		average validation NDCG = 0.668

epoch 1
average train loss = -2900.560059    	average train batch reward = 0.659
validation accuracy = 0.115		average validation NDCG = 0.699

epoch 2
average train loss = -9840.871094    	average train batch reward = 0.686
validation accuracy = 0.110		average validation NDCG = 0.707

epoch 3
average train loss = -16623.035156    	average train batch reward = 0.678
validation accuracy = 0.116		average validation NDCG = 0.698

epoch 4
average train loss = -23575.080078    	average train batch reward = 0.678
validation accuracy = 0.135		average validation NDCG = 0.695

epoch 5
average train loss = -27230.050781    	average train batch reward = 0.673
validation accuracy = 0.123		average validation NDCG = 0.697

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.076		average validation NDCG = 0.650

epoch 1
average train loss = -2921.449463    	average train batch reward = 0.659
validation accuracy = 0.211		average validation NDCG = 0.710

epoch 2
average train loss = -9470.295898    	average train batch reward = 0.674
validation accuracy = 0.191		average validation NDCG = 0.704

epoch 3
average train loss = -15903.840820    	average train batch reward = 0.657
validation accuracy = 0.173		average validation NDCG = 0.688

epoch 4
average train loss = -23448.509766    	average train batch reward = 0.662
validation accuracy = 0.129		average validation NDCG = 0.699

epoch 5
average train loss = -28386.972656    	average train batch reward = 0.657
validation accuracy = 0.128		average validation NDCG = 0.680

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.106		average validation NDCG = 0.687

epoch 1
average train loss = -2815.303711    	average train batch reward = 0.743
validation accuracy = 0.183		average validation NDCG = 0.757

epoch 2
average train loss = -8811.811523    	average train batch reward = 0.732
validation accuracy = 0.140		average validation NDCG = 0.730

epoch 3
average train loss = -14178.706055    	average train batch reward = 0.715
validation accuracy = 0.101		average validation NDCG = 0.728

epoch 4
average train loss = -20469.150391    	average train batch reward = 0.713
validation accuracy = 0.102		average validation NDCG = 0.729

epoch 5
average train loss = -27464.478516    	average train batch reward = 0.711
validation accuracy = 0.118		average validation NDCG = 0.729

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.075		average validation NDCG = 0.662

epoch 1
average train loss = -3704.293701    	average train batch reward = 0.663
validation accuracy = 0.120		average validation NDCG = 0.711

epoch 2
average train loss = -11304.678711    	average train batch reward = 0.684
validation accuracy = 0.116		average validation NDCG = 0.710

epoch 3
average train loss = -18835.716797    	average train batch reward = 0.678
validation accuracy = 0.154		average validation NDCG = 0.708

epoch 4
average train loss = -26795.130859    	average train batch reward = 0.682
validation accuracy = 0.126		average validation NDCG = 0.713

epoch 5
average train loss = -32479.781250    	average train batch reward = 0.680
validation accuracy = 0.102		average validation NDCG = 0.708

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.096		average validation NDCG = 0.658

epoch 1
average train loss = -3223.686279    	average train batch reward = 0.691
validation accuracy = 0.184		average validation NDCG = 0.710

epoch 2
average train loss = -10310.843750    	average train batch reward = 0.693
validation accuracy = 0.207		average validation NDCG = 0.716

epoch 3
average train loss = -17687.214844    	average train batch reward = 0.692
validation accuracy = 0.195		average validation NDCG = 0.708

epoch 4
average train loss = -22228.976562    	average train batch reward = 0.695
validation accuracy = 0.177		average validation NDCG = 0.723

epoch 5
average train loss = -29029.457031    	average train batch reward = 0.705
validation accuracy = 0.221		average validation NDCG = 0.724

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.103		average validation NDCG = 0.684

epoch 1
average train loss = -2974.101807    	average train batch reward = 0.671
validation accuracy = 0.128		average validation NDCG = 0.715

epoch 2
average train loss = -10038.325195    	average train batch reward = 0.695
validation accuracy = 0.145		average validation NDCG = 0.717

epoch 3
average train loss = -15130.184570    	average train batch reward = 0.698
validation accuracy = 0.136		average validation NDCG = 0.723

epoch 4
average train loss = -22487.238281    	average train batch reward = 0.700
validation accuracy = 0.179		average validation NDCG = 0.720

epoch 5
average train loss = -28029.521484    	average train batch reward = 0.697
validation accuracy = 0.174		average validation NDCG = 0.719

Current setup 1.0 explored, avg = 0.727294, std = 0.017269, min = 0.707199, max = 0.760576
========
Currently the best setups are [0.0001, 1.0000000000000001e-05, 0.001], which got average scores of [0.78419109943043774, 0.77976293655166873, 0.73727119866775226]
========
Done at 2017-07-14 06:47:40
