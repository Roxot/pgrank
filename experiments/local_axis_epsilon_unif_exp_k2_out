Started at 2017-07-14 10:42:06
Finding best parameters for k = 2
Num epochs = 5
Averaging over 10 runs
Tuning the parameter: epsilon

If not tuned the following parameter values are used:
Learning rate = 0.000100
Epsilon = 0.000000
Exploration type = uniform
Weight regularization strength = 0.0001
Baseline = 0.9
=========
Hyperparameters:
k = 2
Batch size = 64
Num epochs = 5
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125705f0>
Reward function = <function ndcg_full at 0x112570668>
Greedy action = <function sample at 0x104d25c08>
Explore action = <explorers.explore.Uniform instance at 0x1131ca5a8>
Baseline = 0.9
Weight regularization strength = 0.0001
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.123		average validation NDCG = 0.676

epoch 1
average train loss = -0.385665    	average train batch reward = 0.971
validation accuracy = 0.810		average validation NDCG = 0.978

epoch 2
average train loss = -0.857046    	average train batch reward = 0.990
validation accuracy = 0.823		average validation NDCG = 0.979

epoch 3
average train loss = -1.363430    	average train batch reward = 0.990
validation accuracy = 0.829		average validation NDCG = 0.979

epoch 4
average train loss = -1.884043    	average train batch reward = 0.991
validation accuracy = 0.829		average validation NDCG = 0.978

epoch 5
average train loss = -2.464582    	average train batch reward = 0.990
validation accuracy = 0.827		average validation NDCG = 0.977

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.096		average validation NDCG = 0.671

epoch 1
average train loss = -0.397689    	average train batch reward = 0.973
validation accuracy = 0.805		average validation NDCG = 0.977

epoch 2
average train loss = -0.878465    	average train batch reward = 0.990
validation accuracy = 0.820		average validation NDCG = 0.979

epoch 3
average train loss = -1.364887    	average train batch reward = 0.991
validation accuracy = 0.822		average validation NDCG = 0.979

epoch 4
average train loss = -1.933807    	average train batch reward = 0.991
validation accuracy = 0.819		average validation NDCG = 0.978

epoch 5
average train loss = -2.501867    	average train batch reward = 0.990
validation accuracy = 0.825		average validation NDCG = 0.977

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.063		average validation NDCG = 0.657

epoch 1
average train loss = -0.390130    	average train batch reward = 0.971
validation accuracy = 0.815		average validation NDCG = 0.979

epoch 2
average train loss = -0.858375    	average train batch reward = 0.990
validation accuracy = 0.820		average validation NDCG = 0.980

epoch 3
average train loss = -1.363326    	average train batch reward = 0.991
validation accuracy = 0.821		average validation NDCG = 0.980

epoch 4
average train loss = -1.899655    	average train batch reward = 0.991
validation accuracy = 0.819		average validation NDCG = 0.979

epoch 5
average train loss = -2.475354    	average train batch reward = 0.990
validation accuracy = 0.820		average validation NDCG = 0.978

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.119		average validation NDCG = 0.674

epoch 1
average train loss = -0.394955    	average train batch reward = 0.973
validation accuracy = 0.823		average validation NDCG = 0.979

epoch 2
average train loss = -0.879097    	average train batch reward = 0.990
validation accuracy = 0.835		average validation NDCG = 0.980

epoch 3
average train loss = -1.380980    	average train batch reward = 0.991
validation accuracy = 0.831		average validation NDCG = 0.979

epoch 4
average train loss = -1.925249    	average train batch reward = 0.990
validation accuracy = 0.830		average validation NDCG = 0.979

epoch 5
average train loss = -2.501891    	average train batch reward = 0.990
validation accuracy = 0.826		average validation NDCG = 0.978

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.066		average validation NDCG = 0.666

epoch 1
average train loss = -0.394398    	average train batch reward = 0.972
validation accuracy = 0.814		average validation NDCG = 0.978

epoch 2
average train loss = -0.857739    	average train batch reward = 0.990
validation accuracy = 0.827		average validation NDCG = 0.980

epoch 3
average train loss = -1.373293    	average train batch reward = 0.991
validation accuracy = 0.825		average validation NDCG = 0.980

epoch 4
average train loss = -1.931359    	average train batch reward = 0.991
validation accuracy = 0.820		average validation NDCG = 0.979

epoch 5
average train loss = -2.465366    	average train batch reward = 0.990
validation accuracy = 0.823		average validation NDCG = 0.979

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.145		average validation NDCG = 0.717

epoch 1
average train loss = -0.410640    	average train batch reward = 0.973
validation accuracy = 0.814		average validation NDCG = 0.976

epoch 2
average train loss = -0.873816    	average train batch reward = 0.989
validation accuracy = 0.829		average validation NDCG = 0.979

epoch 3
average train loss = -1.400633    	average train batch reward = 0.991
validation accuracy = 0.831		average validation NDCG = 0.979

epoch 4
average train loss = -1.939228    	average train batch reward = 0.991
validation accuracy = 0.828		average validation NDCG = 0.979

epoch 5
average train loss = -2.539351    	average train batch reward = 0.990
validation accuracy = 0.826		average validation NDCG = 0.977

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.100		average validation NDCG = 0.670

epoch 1
average train loss = -0.394266    	average train batch reward = 0.971
validation accuracy = 0.831		average validation NDCG = 0.976

epoch 2
average train loss = -0.854386    	average train batch reward = 0.989
validation accuracy = 0.849		average validation NDCG = 0.978

epoch 3
average train loss = -1.382944    	average train batch reward = 0.990
validation accuracy = 0.847		average validation NDCG = 0.978

epoch 4
average train loss = -1.910722    	average train batch reward = 0.990
validation accuracy = 0.844		average validation NDCG = 0.977

epoch 5
average train loss = -2.485845    	average train batch reward = 0.990
validation accuracy = 0.842		average validation NDCG = 0.977

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.086		average validation NDCG = 0.682

epoch 1
average train loss = -0.408177    	average train batch reward = 0.974
validation accuracy = 0.808		average validation NDCG = 0.978

epoch 2
average train loss = -0.888674    	average train batch reward = 0.990
validation accuracy = 0.815		average validation NDCG = 0.981

epoch 3
average train loss = -1.382442    	average train batch reward = 0.991
validation accuracy = 0.815		average validation NDCG = 0.981

epoch 4
average train loss = -1.929454    	average train batch reward = 0.991
validation accuracy = 0.807		average validation NDCG = 0.980

epoch 5
average train loss = -2.528818    	average train batch reward = 0.991
validation accuracy = 0.801		average validation NDCG = 0.979

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.078		average validation NDCG = 0.652

epoch 1
average train loss = -0.391166    	average train batch reward = 0.971
validation accuracy = 0.812		average validation NDCG = 0.979

epoch 2
average train loss = -0.865373    	average train batch reward = 0.990
validation accuracy = 0.824		average validation NDCG = 0.980

epoch 3
average train loss = -1.364824    	average train batch reward = 0.990
validation accuracy = 0.821		average validation NDCG = 0.980

epoch 4
average train loss = -1.931994    	average train batch reward = 0.991
validation accuracy = 0.818		average validation NDCG = 0.979

epoch 5
average train loss = -2.460498    	average train batch reward = 0.990
validation accuracy = 0.816		average validation NDCG = 0.978

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.090		average validation NDCG = 0.655

epoch 1
average train loss = -0.381082    	average train batch reward = 0.970
validation accuracy = 0.817		average validation NDCG = 0.976

epoch 2
average train loss = -0.861098    	average train batch reward = 0.990
validation accuracy = 0.832		average validation NDCG = 0.979

epoch 3
average train loss = -1.372492    	average train batch reward = 0.991
validation accuracy = 0.831		average validation NDCG = 0.979

epoch 4
average train loss = -1.902840    	average train batch reward = 0.991
validation accuracy = 0.828		average validation NDCG = 0.978

epoch 5
average train loss = -2.483194    	average train batch reward = 0.990
validation accuracy = 0.821		average validation NDCG = 0.977

Current setup 0.0 explored, avg = 0.979695, std = 0.000812, min = 0.978140, max = 0.981093
========
Currently the best setups are [0.0, (), ()], which got average scores of [0.97969473659181094, -1, -1]
========
Hyperparameters:
k = 2
Batch size = 64
Num epochs = 5
Learning rate = 0.000100
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125705f0>
Reward function = <function ndcg_full at 0x112570668>
Greedy action = <function sample at 0x104d25c08>
Explore action = <explorers.explore.Uniform instance at 0x1195dc4d0>
Baseline = 0.9
Weight regularization strength = 0.0001
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.101		average validation NDCG = 0.679

epoch 1
average train loss = -0.036965    	average train batch reward = 0.959
validation accuracy = 0.885		average validation NDCG = 0.988

epoch 2
average train loss = -0.021407    	average train batch reward = 0.976
validation accuracy = 0.899		average validation NDCG = 0.991

epoch 3
average train loss = -0.016994    	average train batch reward = 0.978
validation accuracy = 0.906		average validation NDCG = 0.992

epoch 4
average train loss = -0.015143    	average train batch reward = 0.979
validation accuracy = 0.913		average validation NDCG = 0.993

epoch 5
average train loss = -0.013596    	average train batch reward = 0.979
validation accuracy = 0.912		average validation NDCG = 0.993

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.128		average validation NDCG = 0.686

epoch 1
average train loss = -0.036834    	average train batch reward = 0.958
validation accuracy = 0.885		average validation NDCG = 0.988

epoch 2
average train loss = -0.021851    	average train batch reward = 0.975
validation accuracy = 0.903		average validation NDCG = 0.991

epoch 3
average train loss = -0.016932    	average train batch reward = 0.978
validation accuracy = 0.908		average validation NDCG = 0.992

epoch 4
average train loss = -0.014921    	average train batch reward = 0.979
validation accuracy = 0.915		average validation NDCG = 0.992

epoch 5
average train loss = -0.013803    	average train batch reward = 0.980
validation accuracy = 0.912		average validation NDCG = 0.993

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.077		average validation NDCG = 0.662

epoch 1
average train loss = -0.037532    	average train batch reward = 0.958
validation accuracy = 0.882		average validation NDCG = 0.987

epoch 2
average train loss = -0.021344    	average train batch reward = 0.976
validation accuracy = 0.904		average validation NDCG = 0.991

epoch 3
average train loss = -0.016706    	average train batch reward = 0.978
validation accuracy = 0.910		average validation NDCG = 0.992

epoch 4
average train loss = -0.014745    	average train batch reward = 0.979
validation accuracy = 0.912		average validation NDCG = 0.993

epoch 5
average train loss = -0.014020    	average train batch reward = 0.980
validation accuracy = 0.913		average validation NDCG = 0.993

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.181		average validation NDCG = 0.694

epoch 1
average train loss = -0.037084    	average train batch reward = 0.959
validation accuracy = 0.886		average validation NDCG = 0.987

epoch 2
average train loss = -0.021365    	average train batch reward = 0.976
validation accuracy = 0.902		average validation NDCG = 0.991

epoch 3
average train loss = -0.017230    	average train batch reward = 0.978
validation accuracy = 0.911		average validation NDCG = 0.992

epoch 4
average train loss = -0.014823    	average train batch reward = 0.979
validation accuracy = 0.912		average validation NDCG = 0.993

epoch 5
average train loss = -0.013724    	average train batch reward = 0.979
validation accuracy = 0.912		average validation NDCG = 0.993

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.099		average validation NDCG = 0.668

epoch 1
average train loss = -0.038075    	average train batch reward = 0.957
validation accuracy = 0.879		average validation NDCG = 0.987

epoch 2
average train loss = -0.021753    	average train batch reward = 0.976
validation accuracy = 0.900		average validation NDCG = 0.990

epoch 3
average train loss = -0.017028    	average train batch reward = 0.978
validation accuracy = 0.907		average validation NDCG = 0.992

epoch 4
average train loss = -0.014880    	average train batch reward = 0.980
validation accuracy = 0.911		average validation NDCG = 0.993

epoch 5
average train loss = -0.013671    	average train batch reward = 0.979
validation accuracy = 0.908		average validation NDCG = 0.993

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.113		average validation NDCG = 0.679

epoch 1
average train loss = -0.037981    	average train batch reward = 0.958
validation accuracy = 0.869		average validation NDCG = 0.987

epoch 2
average train loss = -0.022104    	average train batch reward = 0.976
validation accuracy = 0.887		average validation NDCG = 0.991

epoch 3
average train loss = -0.016798    	average train batch reward = 0.978
validation accuracy = 0.899		average validation NDCG = 0.992

epoch 4
average train loss = -0.015209    	average train batch reward = 0.978
validation accuracy = 0.910		average validation NDCG = 0.993

epoch 5
average train loss = -0.013710    	average train batch reward = 0.979
validation accuracy = 0.910		average validation NDCG = 0.993

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.095		average validation NDCG = 0.665

epoch 1
average train loss = -0.037713    	average train batch reward = 0.958
validation accuracy = 0.868		average validation NDCG = 0.987

epoch 2
average train loss = -0.021596    	average train batch reward = 0.976
validation accuracy = 0.894		average validation NDCG = 0.990

epoch 3
average train loss = -0.017321    	average train batch reward = 0.978
validation accuracy = 0.907		average validation NDCG = 0.992

epoch 4
average train loss = -0.014711    	average train batch reward = 0.979
validation accuracy = 0.908		average validation NDCG = 0.993

epoch 5
average train loss = -0.013897    	average train batch reward = 0.980
validation accuracy = 0.916		average validation NDCG = 0.993

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.100		average validation NDCG = 0.655

epoch 1
average train loss = -0.036973    	average train batch reward = 0.957
validation accuracy = 0.876		average validation NDCG = 0.987

epoch 2
average train loss = -0.021400    	average train batch reward = 0.976
validation accuracy = 0.901		average validation NDCG = 0.991

epoch 3
average train loss = -0.017011    	average train batch reward = 0.977
validation accuracy = 0.906		average validation NDCG = 0.992

epoch 4
average train loss = -0.015049    	average train batch reward = 0.979
validation accuracy = 0.911		average validation NDCG = 0.992

epoch 5
average train loss = -0.013633    	average train batch reward = 0.980
validation accuracy = 0.913		average validation NDCG = 0.993

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.134		average validation NDCG = 0.698

epoch 1
average train loss = -0.036923    	average train batch reward = 0.960
validation accuracy = 0.871		average validation NDCG = 0.988

epoch 2
average train loss = -0.021202    	average train batch reward = 0.975
validation accuracy = 0.893		average validation NDCG = 0.991

epoch 3
average train loss = -0.016867    	average train batch reward = 0.978
validation accuracy = 0.897		average validation NDCG = 0.992

epoch 4
average train loss = -0.014856    	average train batch reward = 0.979
validation accuracy = 0.902		average validation NDCG = 0.993

epoch 5
average train loss = -0.013753    	average train batch reward = 0.980
validation accuracy = 0.903		average validation NDCG = 0.993

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.130		average validation NDCG = 0.680

epoch 1
average train loss = -0.036986    	average train batch reward = 0.959
validation accuracy = 0.877		average validation NDCG = 0.988

epoch 2
average train loss = -0.020873    	average train batch reward = 0.976
validation accuracy = 0.894		average validation NDCG = 0.991

epoch 3
average train loss = -0.016764    	average train batch reward = 0.978
validation accuracy = 0.906		average validation NDCG = 0.992

epoch 4
average train loss = -0.014603    	average train batch reward = 0.979
validation accuracy = 0.910		average validation NDCG = 0.993

epoch 5
average train loss = -0.013738    	average train batch reward = 0.980
validation accuracy = 0.910		average validation NDCG = 0.993

Current setup 0.1 explored, avg = 0.993079, std = 0.000192, min = 0.992788, max = 0.993393
========
Currently the best setups are [0.1, 0.0, ()], which got average scores of [0.99307944092644662, 0.97969473659181094, -1]
========
Hyperparameters:
k = 2
Batch size = 64
Num epochs = 5
Learning rate = 0.000100
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125705f0>
Reward function = <function ndcg_full at 0x112570668>
Greedy action = <function sample at 0x104d25c08>
Explore action = <explorers.explore.Uniform instance at 0x1214f3a28>
Baseline = 0.9
Weight regularization strength = 0.0001
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.091		average validation NDCG = 0.653

epoch 1
average train loss = -0.024365    	average train batch reward = 0.901
validation accuracy = 0.887		average validation NDCG = 0.988

epoch 2
average train loss = -0.013923    	average train batch reward = 0.913
validation accuracy = 0.903		average validation NDCG = 0.991

epoch 3
average train loss = -0.011578    	average train batch reward = 0.913
validation accuracy = 0.911		average validation NDCG = 0.993

epoch 4
average train loss = -0.010745    	average train batch reward = 0.914
validation accuracy = 0.917		average validation NDCG = 0.993

epoch 5
average train loss = -0.010584    	average train batch reward = 0.914
validation accuracy = 0.915		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.074		average validation NDCG = 0.660

epoch 1
average train loss = -0.023862    	average train batch reward = 0.902
validation accuracy = 0.873		average validation NDCG = 0.988

epoch 2
average train loss = -0.014014    	average train batch reward = 0.911
validation accuracy = 0.899		average validation NDCG = 0.991

epoch 3
average train loss = -0.011551    	average train batch reward = 0.913
validation accuracy = 0.911		average validation NDCG = 0.993

epoch 4
average train loss = -0.010804    	average train batch reward = 0.914
validation accuracy = 0.911		average validation NDCG = 0.993

epoch 5
average train loss = -0.010529    	average train batch reward = 0.914
validation accuracy = 0.907		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.051		average validation NDCG = 0.648

epoch 1
average train loss = -0.023016    	average train batch reward = 0.902
validation accuracy = 0.870		average validation NDCG = 0.988

epoch 2
average train loss = -0.013801    	average train batch reward = 0.911
validation accuracy = 0.901		average validation NDCG = 0.991

epoch 3
average train loss = -0.011641    	average train batch reward = 0.914
validation accuracy = 0.909		average validation NDCG = 0.992

epoch 4
average train loss = -0.010700    	average train batch reward = 0.915
validation accuracy = 0.912		average validation NDCG = 0.993

epoch 5
average train loss = -0.010561    	average train batch reward = 0.914
validation accuracy = 0.908		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.109		average validation NDCG = 0.673

epoch 1
average train loss = -0.023427    	average train batch reward = 0.903
validation accuracy = 0.856		average validation NDCG = 0.988

epoch 2
average train loss = -0.013914    	average train batch reward = 0.912
validation accuracy = 0.882		average validation NDCG = 0.991

epoch 3
average train loss = -0.011331    	average train batch reward = 0.914
validation accuracy = 0.894		average validation NDCG = 0.993

epoch 4
average train loss = -0.010840    	average train batch reward = 0.915
validation accuracy = 0.895		average validation NDCG = 0.993

epoch 5
average train loss = -0.010724    	average train batch reward = 0.916
validation accuracy = 0.898		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.068		average validation NDCG = 0.655

epoch 1
average train loss = -0.023605    	average train batch reward = 0.902
validation accuracy = 0.880		average validation NDCG = 0.989

epoch 2
average train loss = -0.013911    	average train batch reward = 0.911
validation accuracy = 0.901		average validation NDCG = 0.991

epoch 3
average train loss = -0.011543    	average train batch reward = 0.914
validation accuracy = 0.909		average validation NDCG = 0.992

epoch 4
average train loss = -0.010846    	average train batch reward = 0.914
validation accuracy = 0.909		average validation NDCG = 0.993

epoch 5
average train loss = -0.010554    	average train batch reward = 0.914
validation accuracy = 0.908		average validation NDCG = 0.993

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.071		average validation NDCG = 0.663

epoch 1
average train loss = -0.024162    	average train batch reward = 0.902
validation accuracy = 0.878		average validation NDCG = 0.988

epoch 2
average train loss = -0.013805    	average train batch reward = 0.911
validation accuracy = 0.897		average validation NDCG = 0.992

epoch 3
average train loss = -0.011557    	average train batch reward = 0.915
validation accuracy = 0.903		average validation NDCG = 0.992

epoch 4
average train loss = -0.010868    	average train batch reward = 0.914
validation accuracy = 0.904		average validation NDCG = 0.993

epoch 5
average train loss = -0.010684    	average train batch reward = 0.914
validation accuracy = 0.904		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.078		average validation NDCG = 0.675

epoch 1
average train loss = -0.023556    	average train batch reward = 0.902
validation accuracy = 0.881		average validation NDCG = 0.988

epoch 2
average train loss = -0.013650    	average train batch reward = 0.912
validation accuracy = 0.905		average validation NDCG = 0.992

epoch 3
average train loss = -0.011441    	average train batch reward = 0.914
validation accuracy = 0.916		average validation NDCG = 0.993

epoch 4
average train loss = -0.010881    	average train batch reward = 0.914
validation accuracy = 0.917		average validation NDCG = 0.993

epoch 5
average train loss = -0.010617    	average train batch reward = 0.915
validation accuracy = 0.918		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.094		average validation NDCG = 0.677

epoch 1
average train loss = -0.022651    	average train batch reward = 0.903
validation accuracy = 0.880		average validation NDCG = 0.988

epoch 2
average train loss = -0.013542    	average train batch reward = 0.913
validation accuracy = 0.900		average validation NDCG = 0.992

epoch 3
average train loss = -0.011481    	average train batch reward = 0.914
validation accuracy = 0.902		average validation NDCG = 0.992

epoch 4
average train loss = -0.010711    	average train batch reward = 0.915
validation accuracy = 0.904		average validation NDCG = 0.993

epoch 5
average train loss = -0.010515    	average train batch reward = 0.915
validation accuracy = 0.902		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.079		average validation NDCG = 0.643

epoch 1
average train loss = -0.023344    	average train batch reward = 0.900
validation accuracy = 0.884		average validation NDCG = 0.988

epoch 2
average train loss = -0.013785    	average train batch reward = 0.914
validation accuracy = 0.903		average validation NDCG = 0.992

epoch 3
average train loss = -0.011649    	average train batch reward = 0.913
validation accuracy = 0.909		average validation NDCG = 0.992

epoch 4
average train loss = -0.010892    	average train batch reward = 0.914
validation accuracy = 0.907		average validation NDCG = 0.993

epoch 5
average train loss = -0.010598    	average train batch reward = 0.915
validation accuracy = 0.908		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.103		average validation NDCG = 0.680

epoch 1
average train loss = -0.023445    	average train batch reward = 0.903
validation accuracy = 0.890		average validation NDCG = 0.989

epoch 2
average train loss = -0.013795    	average train batch reward = 0.912
validation accuracy = 0.905		average validation NDCG = 0.991

epoch 3
average train loss = -0.011656    	average train batch reward = 0.913
validation accuracy = 0.912		average validation NDCG = 0.993

epoch 4
average train loss = -0.010857    	average train batch reward = 0.915
validation accuracy = 0.913		average validation NDCG = 0.993

epoch 5
average train loss = -0.010578    	average train batch reward = 0.916
validation accuracy = 0.911		average validation NDCG = 0.993

Current setup 0.5 explored, avg = 0.993629, std = 0.000182, min = 0.993293, max = 0.993914
========
Currently the best setups are [0.5, 0.1, 0.0], which got average scores of [0.99362925553139048, 0.99307944092644662, 0.97969473659181094]
========
Hyperparameters:
k = 2
Batch size = 64
Num epochs = 5
Learning rate = 0.000100
Epsilon = 0.900000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125705f0>
Reward function = <function ndcg_full at 0x112570668>
Greedy action = <function sample at 0x104d25c08>
Explore action = <explorers.explore.Uniform instance at 0x12427bdd0>
Baseline = 0.9
Weight regularization strength = 0.0001
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.120		average validation NDCG = 0.683

epoch 1
average train loss = -0.023094    	average train batch reward = 0.847
validation accuracy = 0.874		average validation NDCG = 0.988

epoch 2
average train loss = -0.013570    	average train batch reward = 0.850
validation accuracy = 0.894		average validation NDCG = 0.991

epoch 3
average train loss = -0.012013    	average train batch reward = 0.849
validation accuracy = 0.903		average validation NDCG = 0.993

epoch 4
average train loss = -0.011280    	average train batch reward = 0.851
validation accuracy = 0.901		average validation NDCG = 0.993

epoch 5
average train loss = -0.011746    	average train batch reward = 0.849
validation accuracy = 0.896		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.121		average validation NDCG = 0.688

epoch 1
average train loss = -0.023064    	average train batch reward = 0.848
validation accuracy = 0.874		average validation NDCG = 0.989

epoch 2
average train loss = -0.013613    	average train batch reward = 0.849
validation accuracy = 0.892		average validation NDCG = 0.991

epoch 3
average train loss = -0.011927    	average train batch reward = 0.850
validation accuracy = 0.900		average validation NDCG = 0.993

epoch 4
average train loss = -0.011360    	average train batch reward = 0.851
validation accuracy = 0.901		average validation NDCG = 0.993

epoch 5
average train loss = -0.011697    	average train batch reward = 0.850
validation accuracy = 0.894		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.153		average validation NDCG = 0.690

epoch 1
average train loss = -0.023130    	average train batch reward = 0.848
validation accuracy = 0.884		average validation NDCG = 0.988

epoch 2
average train loss = -0.013448    	average train batch reward = 0.850
validation accuracy = 0.905		average validation NDCG = 0.991

epoch 3
average train loss = -0.011672    	average train batch reward = 0.850
validation accuracy = 0.909		average validation NDCG = 0.993

epoch 4
average train loss = -0.011383    	average train batch reward = 0.850
validation accuracy = 0.912		average validation NDCG = 0.993

epoch 5
average train loss = -0.011600    	average train batch reward = 0.849
validation accuracy = 0.908		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.084		average validation NDCG = 0.648

epoch 1
average train loss = -0.023708    	average train batch reward = 0.847
validation accuracy = 0.873		average validation NDCG = 0.989

epoch 2
average train loss = -0.013917    	average train batch reward = 0.849
validation accuracy = 0.895		average validation NDCG = 0.992

epoch 3
average train loss = -0.011845    	average train batch reward = 0.851
validation accuracy = 0.901		average validation NDCG = 0.993

epoch 4
average train loss = -0.011265    	average train batch reward = 0.850
validation accuracy = 0.901		average validation NDCG = 0.994

epoch 5
average train loss = -0.011565    	average train batch reward = 0.851
validation accuracy = 0.896		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.106		average validation NDCG = 0.682

epoch 1
average train loss = -0.023305    	average train batch reward = 0.849
validation accuracy = 0.890		average validation NDCG = 0.989

epoch 2
average train loss = -0.013405    	average train batch reward = 0.850
validation accuracy = 0.911		average validation NDCG = 0.992

epoch 3
average train loss = -0.011889    	average train batch reward = 0.851
validation accuracy = 0.918		average validation NDCG = 0.993

epoch 4
average train loss = -0.011356    	average train batch reward = 0.850
validation accuracy = 0.922		average validation NDCG = 0.993

epoch 5
average train loss = -0.011585    	average train batch reward = 0.849
validation accuracy = 0.918		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.075		average validation NDCG = 0.651

epoch 1
average train loss = -0.023676    	average train batch reward = 0.848
validation accuracy = 0.893		average validation NDCG = 0.988

epoch 2
average train loss = -0.013871    	average train batch reward = 0.850
validation accuracy = 0.911		average validation NDCG = 0.992

epoch 3
average train loss = -0.011918    	average train batch reward = 0.850
validation accuracy = 0.915		average validation NDCG = 0.993

epoch 4
average train loss = -0.011331    	average train batch reward = 0.850
validation accuracy = 0.919		average validation NDCG = 0.993

epoch 5
average train loss = -0.011419    	average train batch reward = 0.850
validation accuracy = 0.917		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.092		average validation NDCG = 0.670

epoch 1
average train loss = -0.023778    	average train batch reward = 0.849
validation accuracy = 0.882		average validation NDCG = 0.988

epoch 2
average train loss = -0.014073    	average train batch reward = 0.850
validation accuracy = 0.899		average validation NDCG = 0.991

epoch 3
average train loss = -0.011888    	average train batch reward = 0.851
validation accuracy = 0.907		average validation NDCG = 0.993

epoch 4
average train loss = -0.011519    	average train batch reward = 0.850
validation accuracy = 0.907		average validation NDCG = 0.994

epoch 5
average train loss = -0.011373    	average train batch reward = 0.851
validation accuracy = 0.906		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.070		average validation NDCG = 0.660

epoch 1
average train loss = -0.023500    	average train batch reward = 0.847
validation accuracy = 0.875		average validation NDCG = 0.989

epoch 2
average train loss = -0.013644    	average train batch reward = 0.851
validation accuracy = 0.902		average validation NDCG = 0.992

epoch 3
average train loss = -0.011596    	average train batch reward = 0.851
validation accuracy = 0.909		average validation NDCG = 0.993

epoch 4
average train loss = -0.011325    	average train batch reward = 0.850
validation accuracy = 0.912		average validation NDCG = 0.994

epoch 5
average train loss = -0.011339    	average train batch reward = 0.850
validation accuracy = 0.909		average validation NDCG = 0.994

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.049		average validation NDCG = 0.655

epoch 1
average train loss = -0.023439    	average train batch reward = 0.848
validation accuracy = 0.880		average validation NDCG = 0.988

epoch 2
average train loss = -0.013912    	average train batch reward = 0.850
validation accuracy = 0.903		average validation NDCG = 0.991

epoch 3
average train loss = -0.011786    	average train batch reward = 0.851
validation accuracy = 0.908		average validation NDCG = 0.993

epoch 4
average train loss = -0.011290    	average train batch reward = 0.848
validation accuracy = 0.913		average validation NDCG = 0.993

epoch 5
average train loss = -0.011338    	average train batch reward = 0.852
validation accuracy = 0.911		average validation NDCG = 0.993

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.100		average validation NDCG = 0.682

epoch 1
average train loss = -0.023107    	average train batch reward = 0.847
validation accuracy = 0.874		average validation NDCG = 0.988

epoch 2
average train loss = -0.013299    	average train batch reward = 0.850
validation accuracy = 0.898		average validation NDCG = 0.992

epoch 3
average train loss = -0.011912    	average train batch reward = 0.849
validation accuracy = 0.906		average validation NDCG = 0.992

epoch 4
average train loss = -0.011277    	average train batch reward = 0.850
validation accuracy = 0.909		average validation NDCG = 0.994

epoch 5
average train loss = -0.011588    	average train batch reward = 0.852
validation accuracy = 0.908		average validation NDCG = 0.994

Current setup 0.9 explored, avg = 0.993703, std = 0.000255, min = 0.993367, max = 0.994204
========
Currently the best setups are [0.9, 0.5, 0.1], which got average scores of [0.99370258092121122, 0.99362925553139048, 0.99307944092644662]
========
Done at 2017-07-14 15:59:22
