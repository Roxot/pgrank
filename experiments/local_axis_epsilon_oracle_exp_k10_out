Started at 2017-07-16 10:41:14
Finding best parameters for k = 10
Num epochs = 5
Averaging over 10 runs
Tuning the parameter: epsilon

If not tuned the following parameter values are used:
Learning rate = 0.000100
Epsilon = 0.000000
Exploration type = oracle
Weight regularization strength = 0.0001
Baseline = 0.7
=========
Hyperparameters:
k = 10
Batch size = 64
Num epochs = 5
Learning rate = 0.000100
Epsilon = 0.000000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125765f0>
Reward function = <function ndcg_full at 0x112576668>
Greedy action = <function sample at 0x10a59bc08>
Explore action = <explorers.explore.Oracle instance at 0x1132d05a8>
Baseline = 0.7
Weight regularization strength = 0.0001
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.080		average validation NDCG = 0.660

epoch 1
average train loss = 0.052891    	average train batch reward = 0.573
validation accuracy = 0.296		average validation NDCG = 0.787

epoch 2
average train loss = -0.014772    	average train batch reward = 0.671
validation accuracy = 0.389		average validation NDCG = 0.857

epoch 3
average train loss = -0.165465    	average train batch reward = 0.731
validation accuracy = 0.385		average validation NDCG = 0.865

epoch 4
average train loss = -0.252651    	average train batch reward = 0.755
validation accuracy = 0.390		average validation NDCG = 0.875

epoch 5
average train loss = -0.367615    	average train batch reward = 0.769
validation accuracy = 0.390		average validation NDCG = 0.884

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.083		average validation NDCG = 0.676

epoch 1
average train loss = 0.052420    	average train batch reward = 0.590
validation accuracy = 0.323		average validation NDCG = 0.813

epoch 2
average train loss = -0.003182    	average train batch reward = 0.670
validation accuracy = 0.405		average validation NDCG = 0.858

epoch 3
average train loss = -0.079901    	average train batch reward = 0.715
validation accuracy = 0.432		average validation NDCG = 0.886

epoch 4
average train loss = -0.176908    	average train batch reward = 0.757
validation accuracy = 0.504		average validation NDCG = 0.904

epoch 5
average train loss = -0.276502    	average train batch reward = 0.793
validation accuracy = 0.514		average validation NDCG = 0.904

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.071		average validation NDCG = 0.675

epoch 1
average train loss = 0.055502    	average train batch reward = 0.592
validation accuracy = 0.308		average validation NDCG = 0.793

epoch 2
average train loss = -0.026146    	average train batch reward = 0.671
validation accuracy = 0.326		average validation NDCG = 0.833

epoch 3
average train loss = -0.115160    	average train batch reward = 0.714
validation accuracy = 0.328		average validation NDCG = 0.867

epoch 4
average train loss = -0.239790    	average train batch reward = 0.728
validation accuracy = 0.316		average validation NDCG = 0.869

epoch 5
average train loss = -0.272837    	average train batch reward = 0.732
validation accuracy = 0.307		average validation NDCG = 0.891

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.089		average validation NDCG = 0.669

epoch 1
average train loss = 0.064293    	average train batch reward = 0.593
validation accuracy = 0.382		average validation NDCG = 0.816

epoch 2
average train loss = -0.022125    	average train batch reward = 0.691
validation accuracy = 0.383		average validation NDCG = 0.871

epoch 3
average train loss = -0.176581    	average train batch reward = 0.744
validation accuracy = 0.402		average validation NDCG = 0.899

epoch 4
average train loss = -0.306295    	average train batch reward = 0.771
validation accuracy = 0.397		average validation NDCG = 0.904

epoch 5
average train loss = -0.399324    	average train batch reward = 0.787
validation accuracy = 0.393		average validation NDCG = 0.909

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.145		average validation NDCG = 0.677

epoch 1
average train loss = 0.069010    	average train batch reward = 0.591
validation accuracy = 0.338		average validation NDCG = 0.782

epoch 2
average train loss = -0.005708    	average train batch reward = 0.675
validation accuracy = 0.457		average validation NDCG = 0.866

epoch 3
average train loss = -0.137452    	average train batch reward = 0.761
validation accuracy = 0.501		average validation NDCG = 0.896

epoch 4
average train loss = -0.232556    	average train batch reward = 0.781
validation accuracy = 0.478		average validation NDCG = 0.887

epoch 5
average train loss = -0.357759    	average train batch reward = 0.777
validation accuracy = 0.442		average validation NDCG = 0.873

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.103		average validation NDCG = 0.663

epoch 1
average train loss = 0.085121    	average train batch reward = 0.569
validation accuracy = 0.197		average validation NDCG = 0.756

epoch 2
average train loss = 0.020622    	average train batch reward = 0.639
validation accuracy = 0.385		average validation NDCG = 0.857

epoch 3
average train loss = -0.073141    	average train batch reward = 0.735
validation accuracy = 0.507		average validation NDCG = 0.896

epoch 4
average train loss = -0.215037    	average train batch reward = 0.784
validation accuracy = 0.510		average validation NDCG = 0.888

epoch 5
average train loss = -0.389935    	average train batch reward = 0.791
validation accuracy = 0.497		average validation NDCG = 0.887

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.122		average validation NDCG = 0.670

epoch 1
average train loss = 0.079118    	average train batch reward = 0.590
validation accuracy = 0.336		average validation NDCG = 0.822

epoch 2
average train loss = -0.026844    	average train batch reward = 0.680
validation accuracy = 0.342		average validation NDCG = 0.874

epoch 3
average train loss = -0.154996    	average train batch reward = 0.740
validation accuracy = 0.374		average validation NDCG = 0.906

epoch 4
average train loss = -0.328873    	average train batch reward = 0.771
validation accuracy = 0.400		average validation NDCG = 0.908

epoch 5
average train loss = -0.339621    	average train batch reward = 0.777
validation accuracy = 0.401		average validation NDCG = 0.900

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.111		average validation NDCG = 0.680

epoch 1
average train loss = 0.084110    	average train batch reward = 0.588
validation accuracy = 0.265		average validation NDCG = 0.789

epoch 2
average train loss = -0.020534    	average train batch reward = 0.665
validation accuracy = 0.406		average validation NDCG = 0.867

epoch 3
average train loss = -0.115252    	average train batch reward = 0.735
validation accuracy = 0.467		average validation NDCG = 0.903

epoch 4
average train loss = -0.229187    	average train batch reward = 0.769
validation accuracy = 0.439		average validation NDCG = 0.892

epoch 5
average train loss = -0.329593    	average train batch reward = 0.775
validation accuracy = 0.432		average validation NDCG = 0.890

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.123		average validation NDCG = 0.685

epoch 1
average train loss = 0.084270    	average train batch reward = 0.601
validation accuracy = 0.364		average validation NDCG = 0.823

epoch 2
average train loss = -0.050287    	average train batch reward = 0.696
validation accuracy = 0.393		average validation NDCG = 0.877

epoch 3
average train loss = -0.192176    	average train batch reward = 0.753
validation accuracy = 0.399		average validation NDCG = 0.889

epoch 4
average train loss = -0.278281    	average train batch reward = 0.782
validation accuracy = 0.422		average validation NDCG = 0.882

epoch 5
average train loss = -0.378731    	average train batch reward = 0.795
validation accuracy = 0.431		average validation NDCG = 0.890

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.089		average validation NDCG = 0.678

epoch 1
average train loss = 0.091209    	average train batch reward = 0.603
validation accuracy = 0.381		average validation NDCG = 0.820

epoch 2
average train loss = -0.054075    	average train batch reward = 0.701
validation accuracy = 0.356		average validation NDCG = 0.867

epoch 3
average train loss = -0.129194    	average train batch reward = 0.737
validation accuracy = 0.342		average validation NDCG = 0.872

epoch 4
average train loss = -0.251828    	average train batch reward = 0.767
validation accuracy = 0.350		average validation NDCG = 0.886

epoch 5
average train loss = -0.403883    	average train batch reward = 0.783
validation accuracy = 0.344		average validation NDCG = 0.881

Current setup 0.0 explored, avg = 0.896750, std = 0.008400, min = 0.884210, max = 0.909483
========
Currently the best setups are [0.0, (), ()], which got average scores of [0.89674961995440905, -1, -1]
========
Hyperparameters:
k = 10
Batch size = 64
Num epochs = 5
Learning rate = 0.000100
Epsilon = 0.100000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125765f0>
Reward function = <function ndcg_full at 0x112576668>
Greedy action = <function sample at 0x10a59bc08>
Explore action = <explorers.explore.Oracle instance at 0x1228080e0>
Baseline = 0.7
Weight regularization strength = 0.0001
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.050		average validation NDCG = 0.639

epoch 1
average train loss = 0.184881    	average train batch reward = 0.601
validation accuracy = 0.186		average validation NDCG = 0.732

epoch 2
average train loss = 0.078929    	average train batch reward = 0.649
validation accuracy = 0.364		average validation NDCG = 0.811

epoch 3
average train loss = 0.058334    	average train batch reward = 0.688
validation accuracy = 0.463		average validation NDCG = 0.865

epoch 4
average train loss = 0.042611    	average train batch reward = 0.724
validation accuracy = 0.537		average validation NDCG = 0.889

epoch 5
average train loss = 0.032395    	average train batch reward = 0.737
validation accuracy = 0.475		average validation NDCG = 0.860

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.081		average validation NDCG = 0.649

epoch 1
average train loss = 0.183960    	average train batch reward = 0.604
validation accuracy = 0.231		average validation NDCG = 0.777

epoch 2
average train loss = 0.069126    	average train batch reward = 0.665
validation accuracy = 0.364		average validation NDCG = 0.828

epoch 3
average train loss = 0.039972    	average train batch reward = 0.706
validation accuracy = 0.432		average validation NDCG = 0.862

epoch 4
average train loss = 0.026907    	average train batch reward = 0.742
validation accuracy = 0.440		average validation NDCG = 0.883

epoch 5
average train loss = 0.019474    	average train batch reward = 0.760
validation accuracy = 0.440		average validation NDCG = 0.888

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.065		average validation NDCG = 0.652

epoch 1
average train loss = 0.179621    	average train batch reward = 0.613
validation accuracy = 0.236		average validation NDCG = 0.766

epoch 2
average train loss = 0.071496    	average train batch reward = 0.666
validation accuracy = 0.364		average validation NDCG = 0.853

epoch 3
average train loss = 0.048316    	average train batch reward = 0.713
validation accuracy = 0.493		average validation NDCG = 0.880

epoch 4
average train loss = 0.024507    	average train batch reward = 0.736
validation accuracy = 0.475		average validation NDCG = 0.873

epoch 5
average train loss = 0.010502    	average train batch reward = 0.765
validation accuracy = 0.503		average validation NDCG = 0.903

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.055		average validation NDCG = 0.647

epoch 1
average train loss = 0.190672    	average train batch reward = 0.616
validation accuracy = 0.290		average validation NDCG = 0.794

epoch 2
average train loss = 0.066562    	average train batch reward = 0.675
validation accuracy = 0.434		average validation NDCG = 0.860

epoch 3
average train loss = 0.040238    	average train batch reward = 0.728
validation accuracy = 0.496		average validation NDCG = 0.882

epoch 4
average train loss = 0.025958    	average train batch reward = 0.743
validation accuracy = 0.545		average validation NDCG = 0.890

epoch 5
average train loss = 0.015963    	average train batch reward = 0.769
validation accuracy = 0.580		average validation NDCG = 0.902

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.132		average validation NDCG = 0.693

epoch 1
average train loss = 0.193243    	average train batch reward = 0.623
validation accuracy = 0.245		average validation NDCG = 0.774

epoch 2
average train loss = 0.094775    	average train batch reward = 0.652
validation accuracy = 0.316		average validation NDCG = 0.804

epoch 3
average train loss = 0.061193    	average train batch reward = 0.678
validation accuracy = 0.433		average validation NDCG = 0.852

epoch 4
average train loss = 0.039303    	average train batch reward = 0.707
validation accuracy = 0.474		average validation NDCG = 0.875

epoch 5
average train loss = 0.014747    	average train batch reward = 0.761
validation accuracy = 0.551		average validation NDCG = 0.900

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.107		average validation NDCG = 0.673

epoch 1
average train loss = 0.197476    	average train batch reward = 0.631
validation accuracy = 0.229		average validation NDCG = 0.759

epoch 2
average train loss = 0.078959    	average train batch reward = 0.669
validation accuracy = 0.422		average validation NDCG = 0.849

epoch 3
average train loss = 0.056934    	average train batch reward = 0.707
validation accuracy = 0.490		average validation NDCG = 0.862

epoch 4
average train loss = 0.031414    	average train batch reward = 0.742
validation accuracy = 0.616		average validation NDCG = 0.907

epoch 5
average train loss = 0.017117    	average train batch reward = 0.768
validation accuracy = 0.587		average validation NDCG = 0.896

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.056		average validation NDCG = 0.657

epoch 1
average train loss = 0.198906    	average train batch reward = 0.623
validation accuracy = 0.282		average validation NDCG = 0.786

epoch 2
average train loss = 0.056204    	average train batch reward = 0.696
validation accuracy = 0.406		average validation NDCG = 0.841

epoch 3
average train loss = 0.034165    	average train batch reward = 0.737
validation accuracy = 0.437		average validation NDCG = 0.872

epoch 4
average train loss = 0.009670    	average train batch reward = 0.761
validation accuracy = 0.472		average validation NDCG = 0.889

epoch 5
average train loss = 0.025361    	average train batch reward = 0.775
validation accuracy = 0.476		average validation NDCG = 0.898

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.067		average validation NDCG = 0.659

epoch 1
average train loss = 0.217136    	average train batch reward = 0.616
validation accuracy = 0.239		average validation NDCG = 0.801

epoch 2
average train loss = 0.072868    	average train batch reward = 0.668
validation accuracy = 0.354		average validation NDCG = 0.836

epoch 3
average train loss = 0.050419    	average train batch reward = 0.701
validation accuracy = 0.472		average validation NDCG = 0.876

epoch 4
average train loss = 0.029270    	average train batch reward = 0.740
validation accuracy = 0.529		average validation NDCG = 0.889

epoch 5
average train loss = 0.012224    	average train batch reward = 0.775
validation accuracy = 0.571		average validation NDCG = 0.909

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.103		average validation NDCG = 0.654

epoch 1
average train loss = 0.220542    	average train batch reward = 0.612
validation accuracy = 0.223		average validation NDCG = 0.741

epoch 2
average train loss = 0.078808    	average train batch reward = 0.656
validation accuracy = 0.412		average validation NDCG = 0.831

epoch 3
average train loss = 0.056245    	average train batch reward = 0.695
validation accuracy = 0.414		average validation NDCG = 0.824

epoch 4
average train loss = 0.049520    	average train batch reward = 0.708
validation accuracy = 0.474		average validation NDCG = 0.857

epoch 5
average train loss = 0.025486    	average train batch reward = 0.739
validation accuracy = 0.589		average validation NDCG = 0.894

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.099		average validation NDCG = 0.685

epoch 1
average train loss = 0.231861    	average train batch reward = 0.615
validation accuracy = 0.209		average validation NDCG = 0.763

epoch 2
average train loss = 0.072352    	average train batch reward = 0.667
validation accuracy = 0.349		average validation NDCG = 0.830

epoch 3
average train loss = 0.033611    	average train batch reward = 0.710
validation accuracy = 0.482		average validation NDCG = 0.878

epoch 4
average train loss = 0.034103    	average train batch reward = 0.747
validation accuracy = 0.498		average validation NDCG = 0.882

epoch 5
average train loss = 0.021732    	average train batch reward = 0.754
validation accuracy = 0.482		average validation NDCG = 0.880

Current setup 0.1 explored, avg = 0.897060, std = 0.008406, min = 0.881730, max = 0.909469
========
Currently the best setups are [0.1, 0.0, ()], which got average scores of [0.89705962934119743, 0.89674961995440905, -1]
========
Hyperparameters:
k = 10
Batch size = 64
Num epochs = 5
Learning rate = 0.000100
Epsilon = 0.500000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125765f0>
Reward function = <function ndcg_full at 0x112576668>
Greedy action = <function sample at 0x10a59bc08>
Explore action = <explorers.explore.Oracle instance at 0x1431de290>
Baseline = 0.7
Weight regularization strength = 0.0001
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.096		average validation NDCG = 0.676

epoch 1
average train loss = 0.228631    	average train batch reward = 0.791
validation accuracy = 0.236		average validation NDCG = 0.777

epoch 2
average train loss = 0.076674    	average train batch reward = 0.822
validation accuracy = 0.349		average validation NDCG = 0.825

epoch 3
average train loss = 0.070622    	average train batch reward = 0.839
validation accuracy = 0.384		average validation NDCG = 0.865

epoch 4
average train loss = 0.044483    	average train batch reward = 0.858
validation accuracy = 0.438		average validation NDCG = 0.899

epoch 5
average train loss = 0.032435    	average train batch reward = 0.866
validation accuracy = 0.506		average validation NDCG = 0.909

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.115		average validation NDCG = 0.666

epoch 1
average train loss = 0.244852    	average train batch reward = 0.788
validation accuracy = 0.200		average validation NDCG = 0.740

epoch 2
average train loss = 0.105253    	average train batch reward = 0.805
validation accuracy = 0.285		average validation NDCG = 0.786

epoch 3
average train loss = 0.081237    	average train batch reward = 0.816
validation accuracy = 0.344		average validation NDCG = 0.827

epoch 4
average train loss = 0.041909    	average train batch reward = 0.839
validation accuracy = 0.530		average validation NDCG = 0.887

epoch 5
average train loss = 0.031841    	average train batch reward = 0.860
validation accuracy = 0.557		average validation NDCG = 0.910

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.054		average validation NDCG = 0.654

epoch 1
average train loss = 0.278376    	average train batch reward = 0.776
validation accuracy = 0.176		average validation NDCG = 0.747

epoch 2
average train loss = 0.092603    	average train batch reward = 0.808
validation accuracy = 0.348		average validation NDCG = 0.831

epoch 3
average train loss = 0.056356    	average train batch reward = 0.831
validation accuracy = 0.433		average validation NDCG = 0.847

epoch 4
average train loss = 0.047122    	average train batch reward = 0.845
validation accuracy = 0.513		average validation NDCG = 0.872

epoch 5
average train loss = 0.047792    	average train batch reward = 0.862
validation accuracy = 0.577		average validation NDCG = 0.903

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.076		average validation NDCG = 0.655

epoch 1
average train loss = 0.251185    	average train batch reward = 0.780
validation accuracy = 0.185		average validation NDCG = 0.731

epoch 2
average train loss = 0.088822    	average train batch reward = 0.809
validation accuracy = 0.432		average validation NDCG = 0.829

epoch 3
average train loss = 0.067149    	average train batch reward = 0.833
validation accuracy = 0.482		average validation NDCG = 0.849

epoch 4
average train loss = 0.056374    	average train batch reward = 0.845
validation accuracy = 0.497		average validation NDCG = 0.868

epoch 5
average train loss = 0.047268    	average train batch reward = 0.847
validation accuracy = 0.546		average validation NDCG = 0.888

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.045		average validation NDCG = 0.648

epoch 1
average train loss = 0.273109    	average train batch reward = 0.780
validation accuracy = 0.209		average validation NDCG = 0.751

epoch 2
average train loss = 0.082850    	average train batch reward = 0.811
validation accuracy = 0.322		average validation NDCG = 0.817

epoch 3
average train loss = 0.065556    	average train batch reward = 0.835
validation accuracy = 0.420		average validation NDCG = 0.873

epoch 4
average train loss = 0.032680    	average train batch reward = 0.858
validation accuracy = 0.487		average validation NDCG = 0.888

epoch 5
average train loss = 0.044283    	average train batch reward = 0.867
validation accuracy = 0.494		average validation NDCG = 0.883

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.104		average validation NDCG = 0.688

epoch 1
average train loss = 0.261537    	average train batch reward = 0.787
validation accuracy = 0.217		average validation NDCG = 0.766

epoch 2
average train loss = 0.100192    	average train batch reward = 0.806
validation accuracy = 0.295		average validation NDCG = 0.805

epoch 3
average train loss = 0.070404    	average train batch reward = 0.825
validation accuracy = 0.403		average validation NDCG = 0.860

epoch 4
average train loss = 0.061994    	average train batch reward = 0.839
validation accuracy = 0.481		average validation NDCG = 0.874

epoch 5
average train loss = 0.059348    	average train batch reward = 0.845
validation accuracy = 0.526		average validation NDCG = 0.899

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.136		average validation NDCG = 0.705

epoch 1
average train loss = 0.259843    	average train batch reward = 0.797
validation accuracy = 0.279		average validation NDCG = 0.775

epoch 2
average train loss = 0.083705    	average train batch reward = 0.821
validation accuracy = 0.423		average validation NDCG = 0.836

epoch 3
average train loss = 0.035222    	average train batch reward = 0.847
validation accuracy = 0.501		average validation NDCG = 0.866

epoch 4
average train loss = 0.031347    	average train batch reward = 0.871
validation accuracy = 0.570		average validation NDCG = 0.907

epoch 5
average train loss = 0.029012    	average train batch reward = 0.883
validation accuracy = 0.588		average validation NDCG = 0.919

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.101		average validation NDCG = 0.680

epoch 1
average train loss = 0.283945    	average train batch reward = 0.788
validation accuracy = 0.198		average validation NDCG = 0.748

epoch 2
average train loss = 0.105399    	average train batch reward = 0.808
validation accuracy = 0.302		average validation NDCG = 0.803

epoch 3
average train loss = 0.074946    	average train batch reward = 0.826
validation accuracy = 0.400		average validation NDCG = 0.841

epoch 4
average train loss = 0.061788    	average train batch reward = 0.833
validation accuracy = 0.455		average validation NDCG = 0.858

epoch 5
average train loss = 0.067139    	average train batch reward = 0.843
validation accuracy = 0.486		average validation NDCG = 0.852

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.072		average validation NDCG = 0.659

epoch 1
average train loss = 0.287413    	average train batch reward = 0.780
validation accuracy = 0.237		average validation NDCG = 0.754

epoch 2
average train loss = 0.096960    	average train batch reward = 0.810
validation accuracy = 0.333		average validation NDCG = 0.810

epoch 3
average train loss = 0.069121    	average train batch reward = 0.832
validation accuracy = 0.402		average validation NDCG = 0.862

epoch 4
average train loss = 0.052134    	average train batch reward = 0.847
validation accuracy = 0.416		average validation NDCG = 0.858

epoch 5
average train loss = 0.040794    	average train batch reward = 0.856
validation accuracy = 0.487		average validation NDCG = 0.873

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.104		average validation NDCG = 0.695

epoch 1
average train loss = 0.288034    	average train batch reward = 0.786
validation accuracy = 0.178		average validation NDCG = 0.748

epoch 2
average train loss = 0.105269    	average train batch reward = 0.807
validation accuracy = 0.261		average validation NDCG = 0.794

epoch 3
average train loss = 0.079556    	average train batch reward = 0.819
validation accuracy = 0.352		average validation NDCG = 0.846

epoch 4
average train loss = 0.031001    	average train batch reward = 0.842
validation accuracy = 0.516		average validation NDCG = 0.882

epoch 5
average train loss = 0.044978    	average train batch reward = 0.864
validation accuracy = 0.590		average validation NDCG = 0.921

Current setup 0.5 explored, avg = 0.896902, std = 0.019209, min = 0.857948, max = 0.920574
========
Currently the best setups are [0.1, 0.5, 0.0], which got average scores of [0.89705962934119743, 0.8969023379801081, 0.89674961995440905]
========
Hyperparameters:
k = 10
Batch size = 64
Num epochs = 5
Learning rate = 0.000100
Epsilon = 0.900000
Hidden layer dimension = 256
Query function = <function random_from_docs at 0x1125765f0>
Reward function = <function ndcg_full at 0x112576668>
Greedy action = <function sample at 0x10a59bc08>
Explore action = <explorers.explore.Oracle instance at 0x172bd6ef0>
Baseline = 0.7
Weight regularization strength = 0.0001
Sample weight lower bound = 0.01
Sample weight upper bound = 5.0
Gradient clipping norm = 5.0
Batch normalization = True

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.132		average validation NDCG = 0.682

epoch 1
average train loss = 0.216066    	average train batch reward = 0.958
validation accuracy = 0.295		average validation NDCG = 0.783

epoch 2
average train loss = 0.038062    	average train batch reward = 0.966
validation accuracy = 0.463		average validation NDCG = 0.867

epoch 3
average train loss = 0.028010    	average train batch reward = 0.973
validation accuracy = 0.567		average validation NDCG = 0.907

epoch 4
average train loss = 0.031154    	average train batch reward = 0.977
validation accuracy = 0.668		average validation NDCG = 0.940

epoch 5
average train loss = 0.029001    	average train batch reward = 0.979
validation accuracy = 0.697		average validation NDCG = 0.953

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.102		average validation NDCG = 0.665

epoch 1
average train loss = 0.209591    	average train batch reward = 0.959
validation accuracy = 0.284		average validation NDCG = 0.802

epoch 2
average train loss = 0.040580    	average train batch reward = 0.969
validation accuracy = 0.471		average validation NDCG = 0.886

epoch 3
average train loss = 0.042628    	average train batch reward = 0.974
validation accuracy = 0.567		average validation NDCG = 0.905

epoch 4
average train loss = 0.032155    	average train batch reward = 0.977
validation accuracy = 0.582		average validation NDCG = 0.938

epoch 5
average train loss = 0.040722    	average train batch reward = 0.979
validation accuracy = 0.612		average validation NDCG = 0.945

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.141		average validation NDCG = 0.677

epoch 1
average train loss = 0.223056    	average train batch reward = 0.959
validation accuracy = 0.287		average validation NDCG = 0.810

epoch 2
average train loss = 0.038741    	average train batch reward = 0.968
validation accuracy = 0.457		average validation NDCG = 0.876

epoch 3
average train loss = 0.031239    	average train batch reward = 0.973
validation accuracy = 0.579		average validation NDCG = 0.921

epoch 4
average train loss = 0.029631    	average train batch reward = 0.977
validation accuracy = 0.648		average validation NDCG = 0.943

epoch 5
average train loss = 0.037650    	average train batch reward = 0.979
validation accuracy = 0.660		average validation NDCG = 0.950

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.113		average validation NDCG = 0.676

epoch 1
average train loss = 0.226837    	average train batch reward = 0.960
validation accuracy = 0.352		average validation NDCG = 0.812

epoch 2
average train loss = 0.040604    	average train batch reward = 0.968
validation accuracy = 0.475		average validation NDCG = 0.868

epoch 3
average train loss = 0.030894    	average train batch reward = 0.974
validation accuracy = 0.603		average validation NDCG = 0.914

epoch 4
average train loss = 0.036026    	average train batch reward = 0.976
validation accuracy = 0.648		average validation NDCG = 0.941

epoch 5
average train loss = 0.039129    	average train batch reward = 0.979
validation accuracy = 0.672		average validation NDCG = 0.955

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.081		average validation NDCG = 0.659

epoch 1
average train loss = 0.235526    	average train batch reward = 0.959
validation accuracy = 0.285		average validation NDCG = 0.788

epoch 2
average train loss = 0.021531    	average train batch reward = 0.969
validation accuracy = 0.477		average validation NDCG = 0.874

epoch 3
average train loss = 0.044642    	average train batch reward = 0.973
validation accuracy = 0.570		average validation NDCG = 0.911

epoch 4
average train loss = 0.042412    	average train batch reward = 0.975
validation accuracy = 0.602		average validation NDCG = 0.919

epoch 5
average train loss = 0.037659    	average train batch reward = 0.977
validation accuracy = 0.660		average validation NDCG = 0.934

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.107		average validation NDCG = 0.677

epoch 1
average train loss = 0.238640    	average train batch reward = 0.960
validation accuracy = 0.395		average validation NDCG = 0.830

epoch 2
average train loss = 0.034944    	average train batch reward = 0.970
validation accuracy = 0.521		average validation NDCG = 0.877

epoch 3
average train loss = 0.038308    	average train batch reward = 0.974
validation accuracy = 0.601		average validation NDCG = 0.918

epoch 4
average train loss = 0.035439    	average train batch reward = 0.977
validation accuracy = 0.623		average validation NDCG = 0.914

epoch 5
average train loss = 0.035848    	average train batch reward = 0.977
validation accuracy = 0.648		average validation NDCG = 0.927

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.093		average validation NDCG = 0.673

epoch 1
average train loss = 0.244966    	average train batch reward = 0.961
validation accuracy = 0.373		average validation NDCG = 0.835

epoch 2
average train loss = 0.028880    	average train batch reward = 0.971
validation accuracy = 0.549		average validation NDCG = 0.901

epoch 3
average train loss = 0.050317    	average train batch reward = 0.974
validation accuracy = 0.552		average validation NDCG = 0.899

epoch 4
average train loss = 0.041328    	average train batch reward = 0.976
validation accuracy = 0.626		average validation NDCG = 0.932

epoch 5
average train loss = 0.028704    	average train batch reward = 0.979
validation accuracy = 0.703		average validation NDCG = 0.953

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.081		average validation NDCG = 0.677

epoch 1
average train loss = 0.250052    	average train batch reward = 0.960
validation accuracy = 0.384		average validation NDCG = 0.826

epoch 2
average train loss = 0.028597    	average train batch reward = 0.972
validation accuracy = 0.565		average validation NDCG = 0.905

epoch 3
average train loss = 0.034788    	average train batch reward = 0.975
validation accuracy = 0.643		average validation NDCG = 0.921

epoch 4
average train loss = 0.037770    	average train batch reward = 0.978
validation accuracy = 0.683		average validation NDCG = 0.943

epoch 5
average train loss = 0.050303    	average train batch reward = 0.980
validation accuracy = 0.697		average validation NDCG = 0.948

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.047		average validation NDCG = 0.633

epoch 1
average train loss = 0.256105    	average train batch reward = 0.957
validation accuracy = 0.257		average validation NDCG = 0.783

epoch 2
average train loss = 0.045017    	average train batch reward = 0.967
validation accuracy = 0.432		average validation NDCG = 0.864

epoch 3
average train loss = 0.031254    	average train batch reward = 0.973
validation accuracy = 0.563		average validation NDCG = 0.912

epoch 4
average train loss = 0.043211    	average train batch reward = 0.977
validation accuracy = 0.657		average validation NDCG = 0.942

epoch 5
average train loss = 0.032925    	average train batch reward = 0.979
validation accuracy = 0.671		average validation NDCG = 0.946

Loading dataset.
Extracting data/train-images-idx3-ubyte.gz
Extracting data/train-labels-idx1-ubyte.gz
Extracting data/t10k-images-idx3-ubyte.gz
Extracting data/t10k-labels-idx1-ubyte.gz

before training
validation accuracy = 0.106		average validation NDCG = 0.670

epoch 1
average train loss = 0.258886    	average train batch reward = 0.961
validation accuracy = 0.413		average validation NDCG = 0.841

epoch 2
average train loss = 0.035037    	average train batch reward = 0.971
validation accuracy = 0.583		average validation NDCG = 0.909

epoch 3
average train loss = 0.038670    	average train batch reward = 0.975
validation accuracy = 0.651		average validation NDCG = 0.940

epoch 4
average train loss = 0.038003    	average train batch reward = 0.979
validation accuracy = 0.677		average validation NDCG = 0.952

epoch 5
average train loss = 0.025688    	average train batch reward = 0.980
validation accuracy = 0.692		average validation NDCG = 0.954

Current setup 0.9 explored, avg = 0.946531, std = 0.008763, min = 0.927199, max = 0.955477
========
Currently the best setups are [0.9, 0.1, 0.5], which got average scores of [0.94653081730452249, 0.89705962934119743, 0.8969023379801081]
========
Done at 2017-07-16 20:10:30
